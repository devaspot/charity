%!PS-Adobe-2.0
%%Creator: dvips 5.490 Copyright 1986, 1992 Radical Eye Software
%%Title: charm.dvi
%%Pages: 63 1
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Bold Times-Italic Courier
%%EndComments
%DVIPSCommandLine: dvips -o charm.ps charm.dvi
%%BeginProcSet: tex.pro
%!
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask restore}B /D{/cc X dup
type /stringtype ne{]}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1
ne{dup dup length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}
B /I{cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul add
.99 lt{/FV}{/RV}ifelse load def pop}N /eop{SI restore showpage userdict
/eop-hook known{eop-hook}if}N /@start{userdict /start-hook known{start-hook}
if /VResolution X /Resolution X 1000 div /DVImag X /IE 256 array N 0 1 255{IE
S 1 string dup 0 3 index put cvn put}for 65781.76 div /vsize X 65781.76 div
/hsize X}N /p{show}N /RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley
0 N /v{/ruley X /rulex X V}B /V{}B /RV statusdict begin /product where{pop
product dup length 7 ge{0 7 getinterval dup(Display)eq exch 0 4 getinterval
(NeXT)eq or}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1 TR 1 1 scale
rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1 -.1 TR rulex
ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /FV{gsave
transform round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail{dup
/delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}B /d{-3 M}
B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{4 M}B /w{0
rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{p 1 w}B /r{p 2 w}
B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p a}B /bos{/SS save N}B
/eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2 index
/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll exec 0 exch 5
-1 roll VResolution Resolution div mul neg 0 0]/Metrics exch def dict begin
Encoding{exch dup type /integertype ne{pop pop 1 sub dup 0 le{pop}{[}ifelse}{
FontMatrix 0 get div Metrics 0 get div def}ifelse}forall Metrics /Metrics
currentdict end def[2 index currentdict end definefont 3 -1 roll makefont
/setfont load]cvx def}def /ObliqueSlant{dup sin S cos div neg}B /SlantFont{4
index mul add}def /ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding
exch def}def end
%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N /vs
792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen false N
/rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B /@scaleunit 100 N
/@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit div /vsc X}B /@hsize{/hs
X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{/CLIP 2 N}B /@hoffset{/ho X}B
/@voffset{/vo X}B /@angle{/ang X}B /@rwi{10 div /rwi X /rwiSeen true N}B /@rhi
{10 div /rhi X /rhiSeen true N}B /@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B
/@ury{/ury X}B /magscale true def end /@MacSetUp{userdict /md known{userdict
/md get type /dicttype eq{userdict begin md length 10 add md maxlength ge{/md
md dup length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{
}N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath clippath
mark{transform{itransform moveto}}{transform{itransform lineto}}{6 -2 roll
transform 6 -2 roll transform 6 -2 roll transform{itransform 6 2 roll
itransform 6 2 roll itransform 6 2 roll curveto}}{{closepath}}pathforall
newpath counttomark array astore /gc xdf pop ct 39 0 put 10 fz 0 fs 2
F/|______Courier fnt invertflag{PaintBlack}if}N /txpose{pxs pys scale ppr
aload pop por{noflips{pop S neg S TR pop 1 -1 scale}if xflip yflip and{pop S
neg S TR 180 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0
get neg sub neg TR}if xflip yflip not and{pop S neg S TR pop 180 rotate ppr 3
get ppr 1 get neg sub neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get
neg TR}if}{noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop
pop 90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get
neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr 0
get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add 2 div 3
1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp{pop pop
showpage pm restore}N end}if}if}N /normalscale{Resolution 72 div VResolution
72 div neg scale magscale{DVImag dup scale}if 0 setgray}N /psfts{S 65781.76
div N}N /startTexFig{/psf$SavedState save N userdict maxlength dict begin
/magscale true def normalscale currentpoint TR /psf$ury psfts /psf$urx psfts
/psf$lly psfts /psf$llx psfts /psf$y psfts /psf$x psfts currentpoint /psf$cy X
/psf$cx X /psf$sx psf$x psf$urx psf$llx sub div N /psf$sy psf$y psf$ury
psf$lly sub div N psf$sx psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy
psf$sy div psf$ury sub TR /showpage{}N /erasepage{}N /copypage{}N /p 3 def
@MacSetUp}N /doclip{psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll
newpath 4 copy 4 2 roll moveto 6 -1 roll S lineto S lineto S lineto closepath
clip newpath moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{
SDict begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial{CLIP
1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto closepath
clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx sub div rhiSeen{
rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR}{rhiSeen{rhi ury lly
sub div dup scale llx neg lly neg TR}if}ifelse CLIP 2 eq{newpath llx lly
moveto urx lly lineto urx ury lineto llx ury lineto closepath clip}if
/showpage{}N /erasepage{}N /copypage{}N newpath}N /@endspecial{count ocount
sub{pop}repeat countdictstack dcount sub{end}repeat grestore SpecialSave
restore end}N /@defspecial{SDict begin}N /@fedspecial{end}B /li{lineto}B /rl{
rlineto}B /rc{rcurveto}B /np{/SaveX currentpoint /SaveY X N 1 setlinecap
newpath}N /st{stroke SaveX SaveY moveto}N /fil{fill SaveX SaveY moveto}N
/ellipse{/endangle X /startangle X /yrad X /xrad X /savematrix matrix
currentmatrix N TR xrad yrad scale 0 0 1 startangle endangle arc savematrix
setmatrix}N end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 @start /Fa 1 111
df<381F004E61804681C04701C08F01C08E01C00E01C00E01C01C03801C03801C03801C070038
0710380710380E10380E2070064030038014127E9119>110 D E /Fb 2
50 df<03C00C301818300C300C700E60066006E007E007E007E007E007E007E007E007E007E007
E007E007E00760066006700E300C300C18180C3007E0101D7E9B15>48 D<030007003F00C70007
000700070007000700070007000700070007000700070007000700070007000700070007000700
070007000F80FFF80D1C7C9B15>I E /Fc 130[25 1[25 1[25 25 25 25
25 25 25 25 1[25 25 25 25 25 25 25 25 25 25 25 25 25 25 25
25 1[25 8[25 25 25 25 25 1[25 25 25 25 25 1[25 25 25 25 25
25 25 25 1[25 2[25 25 25 25 5[25 25 25 25 25 25 1[25 25 25
25 25 25 25 40[{}63 41.666668 /Courier rf /Fd 2 50 df<007E0001C3800700E00E0070
1E00781C00383C003C3C003C38001C78001E78001E78001E78001EF8001FF8001FF8001FF8001F
F8001FF8001FF8001FF8001FF8001FF8001FF8001FF8001FF8001FF8001FF8001F78001E78001E
78001E78001E7C003E3C003C3C003C1C00381E00780E00700700E001C380007E0018297EA71D>
48 D<00200000E00001E0000FE000FFE000F1E00001E00001E00001E00001E00001E00001E000
01E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E000
01E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00003F000
FFFFC0FFFFC012287BA71D>I E /Fe 17 119 df<78FCFCFCFC7806067B8510>58
D<78FCFCFEFE7A02020202040404080810204007127B8510>I<00000006000000000600000000
0E000000001E000000001E000000003E000000003E000000007E00000000BE00000000BF000000
013F000000031F000000021F000000041F000000041F000000081F000000181F000000101F0000
00201F800000201F800000400F800000800F800000800F800001000F800001000F800002000F80
0004000F800007FFFF80000FFFFFC000080007C000100007C000200007C000200007C000400007
C000400007C000800007C001000007C001000007E003000007E00F000007E0FFE0007FFFFFE000
FFFE282A7EA92C>65 D<000003FC008000001FFF008000007E0381800001F00043800007C00027
00000F00001F00001E00001F00003C00000F00007800000E0000F000000E0001E00000060003C0
0000060007C0000004000780000004000F80000004001F00000004001F00000000003E00000000
003E00000000003E00000000007C00000000007C00000000007C00000000007C00000000007C00
00000000F80000000000F80000000000F80000000000F800000040007800000040007800000040
007800000080007C00000080003C00000100003C00000200001E00000200001E00000C00000F00
0018000007800030000003E000C0000001F807800000007FFE000000000FF0000000292B7EA92A
>67 D<003FFFFFC000007FFFFFF8000003F000FC000003E0001E000003E0000F000003E0000780
0003E00003C00007C00003C00007C00001E00007C00001E00007C00001E0000F800001F0000F80
0001F0000F800001F0000F800001F0001F000001F0001F000001F0001F000001F0001F000001F0
003E000003E0003E000003E0003E000003E0003E000003E0007C000007C0007C000007C0007C00
000780007C00000F8000F800000F0000F800001F0000F800001E0000F800003C0001F000003C00
01F00000780001F00000F00001F00001E00003E00003C00003E0000F800003E0003E000007E001
F80000FFFFFFE00000FFFFFF0000002C297DA831>I<003FFFFFC000007FFFFFF0000003F000FC
000003E0003E000003E0001E000003E0000F000003E0000F000007C0000F800007C0000F800007
C0000F800007C0000F80000F80001F00000F80001F00000F80001E00000F80003E00001F00003C
00001F00007800001F0000F000001F0003E000003E001F8000003FFFFC0000003E00000000003E
00000000007C00000000007C00000000007C00000000007C0000000000F80000000000F8000000
0000F80000000000F80000000001F00000000001F00000000001F00000000001F00000000003E0
0000000003E00000000003E00000000007E000000000FFFF00000000FFFF0000000029297DA826
>80 D<003FFFFF00007FFFFFC00003F003F00003E000780003E0003C0003E0003E0003E0001E00
07C0001F0007C0001F0007C0001F0007C0001F000F80003E000F80003E000F80003C000F80007C
001F0000F8001F0000F0001F0003C0001F000780003E003C00003FFFE000003E007800003E001E
00007C000F00007C000F80007C000F80007C000F8000F8000F8000F8000F8000F8000F8000F800
0F8001F0001F0001F0001F0001F0001F0001F0001F0003E0001E0103E0001E0103E0001E0107E0
001E02FFFF000E04FFFF00070800000001F0282A7DA82D>82 D<FFFE0003FF80FFFE0003FF800F
E00000780007C00000700007C00000600007C00000400007C00000800007C00000800007C00001
000007E00002000003E00002000003E00004000003E00008000003E00008000003E00010000003
E00030000003F00020000003F00040000001F00040000001F00080000001F00100000001F00100
000001F00200000001F00400000001F80400000000F80800000000F80800000000F81000000000
F82000000000F82000000000F84000000000FC8000000000FC80000000007D00000000007F0000
0000007E00000000007C00000000007C0000000000780000000000700000000000300000000000
2000000000292A7DA822>86 D<003E0000E1180180BC0300BC0700780E00781C00781C00783C00
F07800F07800F07800F0F001E0F001E0F001E0F001E0E003C0E003C1E003C1E003C1E007826007
82700B823013841861C80F80F0181A7D991F>97 D<001FC000702001C0100380380700780E00F8
1E00F81C00703C0000380000780000780000F00000F00000F00000F00000F00000E00000E00000
E00008F000107000203000C03801000C0E0007F000151A7D9919>99 D<000003C000007FC00000
7FC0000007C00000078000000780000007800000078000000F0000000F0000000F0000000F0000
001E0000001E0000001E0000001E00003E3C0000E13C000180BC000300BC00070078000E007800
1C0078001C0078003C00F0007800F0007800F0007800F000F001E000F001E000F001E000F001E0
00E003C000E003C100E003C100E003C100E007820060078200700B8200301384001861C8000F80
F0001A2A7DA91E>I<000007C000000C2000001870000038F0000079F0000071F0000070E00000
F0000000F0000000F0000001E0000001E0000001E0000001E0000001E0000003C000007FFF8000
7FFF000003C0000003C0000003C0000007800000078000000780000007800000078000000F0000
000F0000000F0000000F0000000F0000001E0000001E0000001E0000001E0000001E0000003C00
00003C0000003C0000003C000000380000007800000078000000780000007000000070000000F0
000030E0000078E00000F8C00000F9C00000F1800000430000003C0000001C367DA91D>102
D<0003E000000E118000180BC000300BC00070078000E0078001C0078001C0078003C00F000780
0F0007800F0007800F000F001E000F001E000F001E000F001E000E003C000E003C000E003C000E
003C000E007800060078000700F800030178000186F00000F8F0000000F0000000F0000001E000
0001E0000001E0000001C0007003C000F8078000F8070000F00E0000E03800003FE000001A267F
991C>I<0F007E001181838021C203C021EC01C041E801C041F001E041E001E041E001E083C003
C003C003C003C003C003C003C007800780078007800780078007800F000F000F000F000F040F00
1E040F001E041E001C081E003C081E001C101E001C203C000C60180007801E1A7E9923>110
D<00F00F00011830C0021C40E0021E8060041F0070041E0070041E0078041E0078083C0078003C
0078003C0078003C0078007800F0007800F0007800F0007800E000F001E000F001E000F001C000
F0038001E0038001F0070001F00E0001E81C0003CC300003C3C00003C0000003C0000007800000
0780000007800000078000000F0000000F0000000F0000001F000000FFF00000FFF000001D2682
991D>112 D<001FC000602001C01001800803003807007807007807003007800007E00007FE00
03FF8001FFC000FFC0000FE00001E00001E03800E07C00E07C00C0F801C0700180400380200700
181C0007F000151A7D991C>115 D<07800608E00F10600F20F00F20F00740F00340F00341E003
81E00201E00203C00203C00203C0040780040780040780080F00080F00080F00100F00100F0020
07004007004003808001C300007C00181A7E991C>118 D E /Ff 2 49 df<4001C0036006300C
18180C30066003C00180018003C006600C301818300C6006C003400110127B901B>2
D<060F0F0E1E1E1C3C383830707060E0C04008117F910A>48 D E /Fg 8
112 df<072018E0306060606060C0C0C0C0C0C841C862D03C600D0B7E8A11>97
D<007800180018003000300030073018E0306060606060C0C0C0C0C0C841C862D03C600D117E90
10>100 D<07801840304060407F80C000C000C000402020C01F000B0B7E8A0F>I<00E001B001A0
0300030003001FE003000600060006000600060006000C000C000C000C0008005800D00060000C
167D900F>I<040C0000000000305898983030606464683006127E910B>105
D<7818183030303060606060C0C0C8C8D06005117E900A>108 D<71F09A189C18981818183030
303030323062606460380F0B7E8A13>110 D<07C01820303060106018C030C030C02040602180
1F000D0B7E8A0F>I E /Fh 14 117 df<07FFFF8000E0038000E0010000E0010000E0010001C0
010001C0010001C0400001C04000038080000381800003FF800003818000070100000701020007
010200070004000E0004000E000C000E0008000E0018001C007000FFFFF00019177F961A>69
D<07FFFF8000E0038000E0010000E0010000E0010001C0010001C0010001C0400001C040000380
80000381800003FF800003818000070100000701000007010000070000000E0000000E0000000E
0000000E0000001C000000FFC0000019177F9616>I<07FF0000E00000E00000E00000E00001C0
0001C00001C00001C0000380000380000380000380000700000700080700080700100E00100E00
300E00200E00601C01E0FFFFC015177F9618>76 D<07FFF00000E01C0000E0060000E0070000E0
070001C0070001C0070001C0070001C00E0003801C000380700003FF80000380E0000700700007
00380007003800070038000E0070000E0070000E0070800E0070801C003100FF801E0019177F96
1B>82 D<071018F0307060706060C060C060C06080C080C480C4C1C446C838700E0E7E8D13>97
D<003E000C000C000C000C0018001800180018073018F0307060706060C060C060C06080C080C4
80C4C1C446C838700F177E9612>100 D<07C01C20301060106020FFC0C000C000C000C000C010
402060C01F000C0E7E8D10>I<000E0013003700360060006000600060006007FC00C000C000C0
00C000C001800180018001800180018003000300030003006600E600CC007800101D7E9611>I<
0300038003000000000000000000000000001C002400460046008C000C00180018001800310031
00320032001C0009177F960C>105 D<3E0C0C0C0C181818183030303060606060C0C8C8C8D070
07177E960B>108 D<383C1E0044C6630047028100460301008E0703000C0603000C0603000C06
0600180C0600180C0620180C0C20180C0C4030180440301807801B0E7F8D1F>I<383C0044C600
4702004602008E06000C06000C06000C0C00180C00180C40181840181880300880300F00120E7F
8D15>I<07C00C20101020186018C018C018C01880308030C060C0C061803E000D0E7E8D11>I<03
0003000600060006000600FFC00C000C000C001800180018001800300030803080310031001E00
0A147F930D>116 D E /Fi 134[21 3[21 12 16 14 1[21 21 21 32 12
2[12 21 1[14 18 21 18 21 18 8[30 3[25 23 2[23 2[37 25 6[25
1[28 1[30 19[14 45[{}28 41.666668 /Times-Roman rf /Fj 1 50
df<0C001C00EC000C000C000C000C000C000C000C000C000C000C000C000C000C000C000C00FF
C00A137D9211>49 D E /Fk 130[30 30 30 30 30 30 2[30 30 30 30
1[30 30 30 30 30 5[30 30 30 30 30 30 12[30 17[30 30 2[30 30
2[30 6[30 30 30 2[30 30 30 1[30 30 30 40[{}36 50.000000 /Courier
rf /Fl 134[22 1[33 1[25 14 19 19 1[25 25 25 36 14 22 1[14 25
25 14 22 25 22 25 25 12[28 25 30 1[30 1[33 41 28 1[22 17 1[36
30 2[33 1[30 19[17 45[{}35 50.000000 /Times-Italic rf /Fm 78[30
55[30 2[30 33 20 23 27 1[33 30 33 50 17 33 1[17 33 30 20 27
33 27 33 30 9[60 1[43 40 33 43 1[37 47 43 56 40 1[30 23 47
47 37 40 43 43 40 43 11[30 30 30 30 30 30 1[15 46[{}49 59.999973
/Times-Bold rf /Fn 3 51 df<07C018303018701C600C600CE00EE00EE00EE00EE00EE00EE0
0EE00EE00E600C600C701C30181C7007C00F157F9412>48 D<03000700FF000700070007000700
07000700070007000700070007000700070007000700070007007FF00C157E9412>I<0F8030E0
40708030C038E0384038003800700070006000C00180030006000C08080810183FF07FF0FFF00D
157E9412>I E /Fo 11 107 df<800002C0000660000C3000181800300C00600600C003018001
830000C600006C00003800003800006C0000C6000183000301800600C00C006018003030001860
000CC000068000021718789727>2 D<03F0000FFC001FFE003FFF007FFF807FFF80FFFFC0FFFF
C0FFFFC0FFFFC0FFFFC0FFFFC0FFFFC0FFFFC07FFF807FFF803FFF001FFE000FFC0003F0001214
7D9519>15 D<C0000000F00000003C0000000F00000003C0000000F00000003C0000000F800000
03E0000000780000001E0000000780000001E0000000780000001C00000078000001E000000780
00001E00000078000003E000000F8000003C000000F0000003C000000F0000003C000000700000
00C000000000000000000000000000000000000000000000000000000000000000000000007FFF
FFF8FFFFFFFC1E277C9F27>21 D<00000000600000000000300000000000300000000000180000
0000001800000000000C00000000000600000000000380FFFFFFFFFFE0FFFFFFFFFFC000000000
0380000000000600000000000C0000000000180000000000180000000000300000000000300000
00000060002B127D9432>33 D<0000006000000000006000000000003000000000001800000000
001800000000000C0000000000060000000000030000FFFFFFFF8000FFFFFFFFC0000000000070
00000000001C00000000000F800000000003E0000000000780000000001E000000000038000000
00006000FFFFFFFFC000FFFFFFFF80000000000700000000000600000000000C00000000001800
000000003000000000003000000000006000000000006000002B1C7D9932>41
D<001FFF007FFF01E0000380000600000C0000180000300000300000600000600000600000C000
00C00000FFFFFFFFFFFFC00000C000006000006000006000003000003000001800000C00000600
0003800001E000007FFF001FFF181E7C9A21>50 D<000F0038007000E001C001C001C001C001C0
01C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F0001E000700038001
C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C000E000700038
000F10317CA419>102 D<F0001E000700038001C001C001C001C001C001C001C001C001C001C0
01C001C001C001C001C001C001C000E000700038000F0038007000E001C001C001C001C001C001
C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F00010317CA419>I<00
4000C000C0018001800180030003000300060006000C000C000C00180018001800300030003000
600060006000C000C000C000C0006000600060003000300030001800180018000C000C000C0006
00060003000300030001800180018000C000C000400A327BA413>I<C000C000C0006000600060
00300030003000180018000C000C000C0006000600060003000300030001800180018000C000C0
00C000C00180018001800300030003000600060006000C000C000C001800180030003000300060
0060006000C000C000C0000A327DA413>I<C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C002317AA40E>I
E /Fp 19 94 df<70F8F8F8F8F8F8F87070707070707070707070702020202020200000000000
70F8F8F87005247CA30E>33 D<00200040008001000300060004000C000C001800180030003000
30007000600060006000E000E000E000E000E000E000E000E000E000E000E000E000E000E00060
00600060007000300030003000180018000C000C0004000600030001000080004000200B327CA4
13>40 D<800040002000100018000C000400060006000300030001800180018001C000C000C000
C000E000E000E000E000E000E000E000E000E000E000E000E000E000E000C000C000C001C00180
01800180030003000600060004000C00180010002000400080000B327DA413>I<000180000001
800000018000000180000001800000018000000180000001800000018000000180000001800000
01800000018000000180000001800000018000FFFFFFFEFFFFFFFE000180000001800000018000
000180000001800000018000000180000001800000018000000180000001800000018000000180
000001800000018000000180001F227D9C26>43 D<01F000071C000C0600180300380380380380
7001C07001C07001C07001C0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0
F001E0F001E0F001E0F001E0F001E07001C07001C07001C07803C03803803803801C07000C0600
071C0001F00013227EA018>48 D<008003800F80F3800380038003800380038003800380038003
8003800380038003800380038003800380038003800380038003800380038003800380038007C0
FFFE0F217CA018>I<03F0000C1C001007002007804003C04003C08003E0F003E0F801E0F801E0
F801E02003E00003E00003C00003C0000780000700000E00001C0000180000300000600000C000
0180000100000200200400200800201800603000403FFFC07FFFC0FFFFC013217EA018>I<03F8
000C1E001007002007804007C07807C07803C07807C03807C0000780000780000700000F00000E
0000380003F000001C00000F000007800007800003C00003C00003E02003E07003E0F803E0F803
E0F003C04003C0400780200780100F000C1C0003F00013227EA018>I<000200000600000E0000
0E00001E00001E00002E00004E00004E00008E00008E00010E00020E00020E00040E00040E0008
0E00100E00100E00200E00200E00400E00800E00FFFFF8000E00000E00000E00000E00000E0000
0E00000E00001F0001FFF015217FA018>I<1000801E07001FFF001FFE001FF80013E000100000
10000010000010000010000010000010F800130E001407001803801003800001C00001C00001E0
0001E00001E00001E07001E0F001E0F001E0E001C08001C04003C04003802007001006000C1C00
03F00013227EA018>I<007E0001C1000300800601C00E03C01C03C01801803800003800007800
00700000700000F0F800F30C00F40600F40300F80380F801C0F001C0F001E0F001E0F001E0F001
E0F001E07001E07001E07001E03801C03801C01803801C03000C0600070C0001F00013227EA018
>I<4000006000007FFFE07FFFC07FFFC0400080C0010080010080020080020000040000080000
080000100000300000200000600000600000600000E00000C00000C00001C00001C00001C00001
C00003C00003C00003C00003C00003C00003C00003C00003C00001800013237DA118>I<01F800
060E000803001001802001802000C06000C06000C06000C07000C07801803E01003F02001FC400
0FF80003F80003FC00067F00083F80100F803007C06001C06000E0C000E0C00060C00060C00060
C000606000406000C03000801803000E0E0003F00013227EA018>I<01F000060C000C06001807
00380380700380700380F001C0F001C0F001C0F001E0F001E0F001E0F001E0F001E07001E07003
E03803E01805E00C05E00619E003E1E00001C00001C00001C00003800003803003007807007806
00700C002018001030000FC00013227EA018>I<70F8F8F870000000000000000000000070F8F8
F87005157C940E>I<70F8F8F870000000000000000000000070F8F8F878080808081010102040
40051F7C940E>I<FFFFFFFEFFFFFFFE0000000000000000000000000000000000000000000000
000000000000000000FFFFFFFEFFFFFFFE1F0C7D9126>61 D<FEFEC0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0FEFE07317BA4
0E>91 D<FEFE060606060606060606060606060606060606060606060606060606060606060606
060606060606060606060606FEFE07317FA40E>93 D E /Fq 32 123 df<70F8F8F87005057C84
0E>58 D<70F8FCFC7404040404080810102040060F7C840E>I<00000080000000018000000001
C000000003C000000003C000000007C00000000BC00000000BC000000013C000000033C0000000
23C000000043C000000043E000000081E000000181E000000101E000000201E000000201E00000
0401E000000C01E000000801E000001001E000001FFFF000002000F000006000F000004000F000
008000F000008000F000010000F000030000F000020000F000040000F8000C0000F8001E0000F8
00FF800FFF8021237EA225>65 D<007FFFF8000007800F00000780078000078003C0000F0001C0
000F0001C0000F0001E0000F0001E0001E0001C0001E0003C0001E0003C0001E000780003C000F
00003C001E00003C003C00003C01F000007FFFE00000780078000078003C000078001E0000F000
1E0000F0000E0000F0000F0000F0000F0001E0001E0001E0001E0001E0001E0001E0003C0003C0
003C0003C000780003C000F00003C001C00007C00F8000FFFFFC000023227EA125>I<00007F00
800003808100000E00630000380027000070001F0000E0000E0001C0000E000380000E00070000
0E000F000004000E000004001E000004003C000004003C00000800780000000078000000007800
000000F000000000F000000000F000000000F000000000F000000000E000000000E000002000E0
00002000E000004000E000004000F0000080007000008000700001000038000200001800040000
1C0008000006003000000381C0000000FE00000021247DA223>I<007FFFF8000007801E000007
8007000007800380000F0001C0000F0001C0000F0000E0000F0000E0001E0000E0001E0000F000
1E0000F0001E0000F0003C0000F0003C0000F0003C0000F0003C0000F000780001E000780001E0
00780001E000780001E000F00003C000F00003C000F000038000F000078001E000070001E0000E
0001E0001E0001E0001C0003C000380003C000700003C000E00003C003800007C00E0000FFFFF8
000024227EA128>I<007FFFFFC000078003C000078000C000078000C0000F0000C0000F0000C0
000F000080000F000080001E000080001E000080001E008080001E008000003C010000003C0100
00003C030000003C070000007FFE000000780600000078060000007806000000F004000000F004
000000F004010000F000020001E000020001E000020001E000040001E0000C0003C000080003C0
00180003C000300003C000700007C003F000FFFFFFE00022227EA124>I<00007F00400003C0C0
80000E002180001C0013800070000F8000E000070001C0000700038000070007000007000F0000
02000E000002001E000002003C000002003C00000400780000000078000000007800000000F000
000000F000000000F000000000F000000000F0003FFF00E00000F000E00000F000E00000F000E0
0001E000F00001E000F00001E000700001E000700003C000380003C000180007C0000C0009C000
06001180000380E08000007F00000022247DA226>71 D<007FFC1FFF00078001E000078001E000
078001E0000F0003C0000F0003C0000F0003C0000F0003C0001E000780001E000780001E000780
001E000780003C000F00003C000F00003C000F00003C000F00007FFFFE000078001E000078001E
000078001E0000F0003C0000F0003C0000F0003C0000F0003C0001E000780001E000780001E000
780001E000780003C000F00003C000F00003C000F00003C000F00007C001F000FFFC3FFF002822
7EA128>I<007FFE000007C0000007800000078000000F0000000F0000000F0000000F0000001E
0000001E0000001E0000001E0000003C0000003C0000003C0000003C0000007800000078000000
7800000078000000F0000000F0000000F0001000F0001001E0002001E0002001E0004001E00040
03C000C003C0008003C0018003C0078007C01F00FFFFFF001C227EA121>76
D<007FFFF0000007801C000007800F000007800700000F000380000F000380000F000380000F00
0380001E000780001E000780001E000780001E000F00003C000F00003C001E00003C003C00003C
007000007801E000007FFF00000078000000007800000000F000000000F000000000F000000000
F000000001E000000001E000000001E000000001E000000003C000000003C000000003C0000000
03C000000007C0000000FFFC00000021227EA11F>80 D<007FFFE0000007803C000007800E0000
07800700000F000780000F000380000F0003C0000F0003C0001E000780001E000780001E000780
001E000F00003C001E00003C003C00003C007000003C01C000007FFE00000078078000007801C0
00007801E00000F000F00000F000F00000F000F00000F000F00001E001E00001E001E00001E001
E00001E001E00003C003C00003C003C04003C003C04003C001C08007C001C080FFFC00E3000000
003C0022237EA125>82 D<0003F010000E0C2000180260002001E0004000E000C000C0008000C0
018000C0018000C00380008003800080038000000380000003C0000001F0000001FE000000FFE0
00007FF000001FF8000001FC0000003C0000001C0000000E0000000E0000000E0020000C002000
0C0020000C002000080060001800600010007000200070004000C8008000C603000081FC00001C
247DA21E>I<1FFFFFFE1E01E00E1801E0063001E0062003C0062003C0064003C0044003C00440
078004800780048007800400078000000F0000000F0000000F0000000F0000001E0000001E0000
001E0000001E0000003C0000003C0000003C0000003C0000007800000078000000780000007800
0000F0000000F0000000F0000000F0000001F00000FFFFC0001F227EA11D>I<FFF8007FC00F80
000F000F00000C000F000008000F000010000F8000100007800020000780006000078000400007
8000800007800080000780010000078002000007C002000003C004000003C00C000003C0080000
03C010000003C010000003C020000003E040000003E040000001E080000001E180000001E10000
0001E200000001E200000001E400000001F800000000F800000000F000000000E000000000E000
000000C000000000C000000022237DA11C>86 D<00786001C4E00302E00601C00E01C01C01C03C
01C0380380780380780380780380F00700F00700F00700F00708F00E10700E10701E1030262018
C6200F01C015157E941A>97 D<03C0003F80000380000380000380000700000700000700000700
000E00000E00000E00000E00001C00001C78001D8E001E07003C07003803803803803807807007
80700780700780700780E00F00E00F00E00F00E01E00E01C00601C0060380030700030C0000F00
0011237DA215>I<003F0000E0800380C00701C00E03C01C03C03C00003C000078000078000078
0000F00000F00000F00000F000007000407000403001803802001C1C0007E00012157E9415>I<
00001E0001FC00001C00001C00001C000038000038000038000038000070000070000070000070
0000E00078E001C4E00302E00601C00E01C01C01C03C01C0380380780380780380780380F00700
F00700F00700F00708F00E10700E10701E1030262018C6200F01C017237EA219>I<00001E0000
0063800000C7800001C7800001C300000180000003800000038000000380000003800000070000
00070000000700000007000000FFF800000E0000000E0000000E0000000E0000000E0000000E00
00001C0000001C0000001C0000001C0000001C0000003800000038000000380000003800000038
0000007000000070000000700000007000000060000000E0000000E0000000E0000000C0000070
C00000F1800000F1000000620000003C000000192D7EA218>102 D<000F0C00389C00605C00C0
3801C0380380380780380700700F00700F00700F00701E00E01E00E01E00E01E00E01E01C00E01
C00E03C00605C0031B8001E380000380000380000700000700000700700E00F00C00F018006070
003FC000161F809417>I<00F0000FE00000E00000E00000E00001C00001C00001C00001C00003
8000038000038000038000070000071F0007218007C0C00F00E00F00E00E00E00E00E01C01C01C
01C01C01C01C01C0380380380380380700380704700708700E08700E08700610E006206003C016
237DA21C>I<00E000E001E000C00000000000000000000000000000000000001E002300438043
8083808380870007000E000E000E001C001C0038003820384070407040308031001E000B227EA1
11>I<3C07C04618604720308740388780388700388700380E00700E00700E00700E00701C00E0
1C00E01C01C01C01C13801C23803823803823801847001883000F018157E941D>110
D<03C0F004631C04740E08780E08700708700708700F00E00F00E00F00E00F00E00F01C01E01C0
1E01C01E01C03C03803803803803C07003C0E0072180071E000700000700000E00000E00000E00
000E00001C00001C00001C0000FFC000181F819418>112 D<007E000081000300800201800603
8006030006000007000007F80003FE0001FF00003F00000780000380700380F00300F00300E002
004004003018000FE00011157E9417>115 D<1E00182300384380384380708380708380708700
700700E00E00E00E00E00E00E01C01C01C01C01C01C01C01C21C03841C03841C07840C09880E11
8803E07017157E941C>117 D<1E00C02301E04381F04380F08380708380308700300700200E00
200E00200E00201C00401C00401C00801C00801C01001C01001C02000C040006080003F0001415
7E9418>I<1E0018182300383C4380383E4380701E8380700E83807006870070060700E0040E00
E0040E00E0040E00E0041C01C0081C01C0081C01C0081C01C0101C01C0101C01C0201C03C0400C
04C0C00708E10001F03E001F157E9423>I<01E0F006310C081A1C101A3C201C3C201C18201C00
00380000380000380000380000700000700000700000700860E010F0E010F0E020E17040423080
3C1F0016157E941C>I<1E00302300704380704380E08380E08380E08700E00701C00E01C00E01
C00E01C01C03801C03801C03801C03801C07001C07001C07001C0F000C3E0003CE00000E00000E
00001C00601C00F03800F03000E0600080C0004180003E0000141F7E9418>I<00E01003F02007
F860060FC008008008010000020000040000080000100000200000C00001000002000004004008
00801001803F830061FE0040FC0080780014157E9417>I E /Fr 69[25
8[25 6[25 48[25 25 36 1[28 17 19 22 1[28 25 28 41 14 28 1[14
28 25 17 22 28 22 28 25 10[36 1[33 1[36 4[47 6[30 33 36 36
33 36 7[25 1[25 25 25 25 25 25 25 25 1[12 46[{}45 50.000000
/Times-Bold rf /Fs 78[36 55[36 1[52 1[40 24 28 32 2[36 40 60
20 40 1[20 40 36 24 32 40 32 40 36 12[48 1[52 4[68 48 5[44
48 1[52 48 52 10[36 36 36 36 36 36 49[{}36 72.000000 /Times-Bold
rf /Ft 69[22 8[25 1[28 28 3[22 45[10 1[22 25 25 36 25 25 14
19 17 25 25 25 25 39 14 25 14 14 25 25 17 22 25 22 25 22 3[17
1[17 3[47 36 36 30 28 33 1[28 36 36 44 30 36 19 17 36 36 28
30 36 33 33 36 5[14 14 25 25 25 25 25 25 25 25 25 25 14 12
17 12 28 1[17 17 17 39 4[17 33[{}78 50.000000 /Times-Roman
rf /Fu 78[23 2[25 52[23 1[33 23 23 13 18 15 1[23 23 23 35 13
23 13 13 23 23 15 20 23 20 23 20 12[28 1[30 4[40 3[15 33 4[30
1[33 18[11 1[11 44[{}34 45.624989 /Times-Roman rf /Fv 139[15
18 20 14[20 25 23 31[33 65[{}7 45.624989 /Times-Bold rf /Fw
3 104 df<000003FE00000000001FFFC000000000FFFFF800000003FC01FE00000007E0003F00
00001F000007C000003E000003E0000078000000F00000F0000000780001E00000003C0003C000
00001E0003800000000E00070000000007000F0000000007800E0000000003801C0000000001C0
1C0000000001C0380000000000E0380000000000E0700000000000707000000000007070000000
00007070000000000070E0000000000038E0000000000038E0000000000038E0000000000038E0
000000000038E0000000000038E0000000000038E0000000000038E0000000000038E000000000
003870000000000070700000000000707000000000007070000000000070380000000000E03800
00000000E01C0000000001C01C0000000001C00E0000000003800F000000000780070000000007
0003800000000E0003C00000001E0001E00000003C0000F000000078000078000000F000003E00
0003E000001F000007C0000007E0003F00000003FC01FE00000000FFFFF8000000001FFFC00000
000003FE00000035387DAA3C>13 D<0000F80003C0000F00001E00003C00007800007800007800
007800007800007800007800007800007800007800007800007800007800007800007800007800
00780000780000780000780000F00000F00001E000078000FE0000FE000007800001E00000F000
00F000007800007800007800007800007800007800007800007800007800007800007800007800
007800007800007800007800007800007800007800007800003C00001E00000F000003C00000F8
153C7CAC1E>102 D<F800000F000003C00001E00000F000007800007800007800007800007800
007800007800007800007800007800007800007800007800007800007800007800007800007800
007800007800003C00003C00001E000007000001F80001F8000700001E00003C00003C00007800
007800007800007800007800007800007800007800007800007800007800007800007800007800
00780000780000780000780000780000780000F00001E00003C0000F0000F80000153C7CAC1E>
I E /Fx 134[30 2[30 30 17 23 20 1[30 30 30 47 17 30 17 17 30
2[27 30 27 30 27 7[43 1[56 1[43 37 33 40 43 33 43 43 53 37
2[20 43 43 33 37 43 40 40 43 6[17 30 3[30 1[30 30 30 30 1[15
1[15 44[{}50 59.999973 /Times-Roman rf /Fy 166[62 2[62 62 53
48 57 2[62 62 1[53 2[29 62 62 48 53 1[57 1[62 65[{}16 86.416687
/Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 0 1
0 bop 340 459 a Fy(THE)21 b(UNIVERSITY)g(OF)h(CALGAR)-5 b(Y)764
645 y Fx(The)14 b(CHARM)h(Project:)576 758 y(A)g(Back)f(End)h(to)f(the)g
(Charity)f(Interpreter)998 982 y(by)907 1206 y(Barry)h(Y)-6
b(ee)898 1430 y(A)15 b(THESIS)193 1542 y(SUBMITTED)f(T)o(O)g(THE)h(DEP)-5
b(AR)l(TMENT)13 b(OF)j(COMPUTER)e(SCIENCE)175 1654 y(IN)h(P)-5
b(AR)l(TIAL)14 b(FULFILLMENT)g(OF)h(THE)f(REQUIREMENTS)g(FOR)h(THE)731
1766 y(COURSE)g(OF)h(CPSC)f(502)754 1990 y(Instructor)f(M.)h(W)n(illiams)763
2103 y(Supervisor)f(R.)h(Cockett)740 2327 y(CALGAR)m(Y)-8 b(,)15
b(ALBER)l(T)-5 b(A)702 2453 y(c)686 2455 y Fw(\015)15 b Fx(Dale)e(Barry)h(Y)
-6 b(ee)15 b(1993)p eop
%%Page: 1 2
1 bop 890 203 a Fv(Abstract)218 325 y Fu(The)14 b(CHARM)g(project)f(is)g(an)h
(attempt)f(to)g(build)f(an)i(ef)o(\256cient)g(and)f(portable)g(abstract)g
(machine)150 415 y(for)c(the)g(Charity)g(language.)15 b(The)9
b(abstract)g(machine)g(is)g(implemented)g(in)f(C)i(programming)f(language)150
506 y(to)14 b(make)g(the)g(system)f(more)i(portable)e(across)h(dif)o(ferent)g
(computer)g(platforms.)24 b(In)14 b(this)f(paper)n(,)i(the)150
596 y(Charity)e(system)f(is)h(composed)f(of)h(a)h(set)e(of)h(rewrite)g(rules)
g(that)f(are)i(converted)e(to)h(state)g(transitions)150 686
y(that)i(de\256nes)h(an)g(abstract)f(machine.)31 b(The)15 b(implementation)g
(of)h(the)f(system)g(is)h(divided)e(into)h(two)150 776 y(levels,)f(the)g
(macro\261level)f(and)h(micro\261level.)24 b(Macro\261instructions)12
b(are)i(instructions)d(that)j(specify)150 867 y(the)f(state)f(transitions)f
(while)h(the)h(micro\261instructions)d(perform)j(the)g(actions)f(that)g
(change)h(the)g(state)150 957 y(of)e(the)g(machine.)963 2700
y Ft(1)p eop
%%Page: 1 3
2 bop 150 204 a Fs(Contents)150 346 y Fr(1)50 b(Backgr)o(ound)1287
b(1)225 436 y Ft(1.1)52 b(Charity)12 b(Basics)32 b Fq(:)25
b(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)h(:)f(:)99 b Ft(1)225 526 y(1.2)52 b(Previous)12
b(W)l(ork)26 b Fq(:)f(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)99 b Ft(3)225
617 y(1.3)52 b(Goal)13 b(and)f(Achievements)37 b Fq(:)24 b(:)h(:)f(:)g(:)h(:)
f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)99
b Ft(3)150 757 y Fr(2)50 b(The)12 b(Rewriting)g(Rules)g(of)g(Charity)877
b(6)150 897 y(3)50 b(The)12 b(Eager)h(Abstract)f(Machine)906
b(10)225 987 y Ft(3.1)52 b(State)12 b(transitions)g(of)g(the)h(Charity)f
(system)25 b Fq(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)76
b Ft(1)n(1)150 1127 y Fr(4)50 b(The)12 b(Macr)o(o\261coded)g(Machine)942
b(17)225 1217 y Ft(4.1)52 b(The)13 b(Macro\261instructions)f(set)48
b Fq(:)24 b(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)h(:)f(:)74 b Ft(17)225 1308 y(4.2)52 b(Compiling)12 b(categorical)g
(combinators)g(to)g(Macro\261instructions)i Fq(:)25 b(:)f(:)h(:)f(:)74
b Ft(22)339 1398 y(4.2.1)61 b(The)13 b(Compilation)e(schemes)29
b Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(22)339 1488 y(4.2.2)61 b(Compiling)11 b(\252Maps\272)k
Fq(:)25 b(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)h(:)f(:)74 b Ft(26)150 1628 y Fr(5)50 b(The)12 b(Micr)o(o\261coded)g
(Machine)953 b(29)225 1719 y Ft(5.1)52 b(Micro\261coded)12
b(architecture)40 b Fq(:)25 b(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74 b Ft(30)225 1809 y(5.2)52
b(The)13 b(Heap)g Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(31)225 1899 y(5.3)52 b(Sharing)12 b(Heap)g(Items)43 b
Fq(:)24 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)h(:)f(:)74 b Ft(33)225 1990 y(5.4)52 b(The)13
b(Micro\261coding)f(of)g(Macro\261instructions)35 b Fq(:)24
b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74 b Ft(36)225
2080 y(5.5)52 b(Abstractions)33 b Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(49)150 2220 y Fr(6)50 b(Futur)o(e)12 b(work)1256 b(51)150
2360 y(A)39 b(Models)12 b(of)g(Abstract)g(Machines)901 b(52)225
2450 y Ft(A.1)41 b(CHARM)13 b(abstract)g(machine)22 b Fq(:)j(:)f(:)g(:)h(:)f
(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(52)225 2541 y(A.2)41 b(G\261Machine)50 b Fq(:)24 b(:)h(:)f(:)h(:)f(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)h(:)f(:)74 b Ft(53)968 2700 y(i)p eop
%%Page: 2 4
3 bop 225 203 a Ft(A.3)41 b(TIM)13 b(machine)50 b Fq(:)25 b(:)f(:)h(:)f(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)h(:)f(:)74 b Ft(54)961 2700 y(ii)p eop
%%Page: 3 5
4 bop 150 204 a Fs(List)18 b(of)f(Figur)o(es)225 346 y Ft(1)89
b(CHIRP)12 b(and)h(CHARM)g(interface)k Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)99 b Ft(1)225 436
y(2)89 b(Overview)12 b(of)g(the)g(CHARM)i(abstract)e(machine)32
b Fq(:)25 b(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)99 b
Ft(4)225 526 y(3)89 b(Sample)12 b(code)h(layout)45 b Fq(:)24
b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)h(:)f(:)74 b Ft(20)225 617 y(4)89 b(Macro\261code)13
b(representation)e(of)h Fq(w)q Fp(;)c Fo(h)p Fq(x;)g Fo(h)p
Fq(y)r(;)g(z)r Fo(ii)p Fp(;)g Fq(P)1259 624 y Fn(1)1280 617
y Fp(;)g Fq(P)1333 624 y Fn(0)1393 617 y Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)
74 b Ft(21)225 707 y(5)89 b(Machine)13 b(layout)f(of)g(a)h(sample)f(compile)
19 b Fq(:)25 b(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(27)225 797 y(6)89 b(Or)o(ganization)12 b(of)g(the)g(Heap)50
b Fq(:)25 b(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)h(:)f(:)74 b Ft(32)225 887 y(7)89 b(Copying)12 b(a)h(Shared)f(Heap)g
(Item)i Fq(:)24 b(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)h(:)f(:)74 b Ft(35)225 978 y(8)89 b(Sample)12 b(representation)g(of)g
(Abstractions)22 b Fq(:)i(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f
(:)74 b Ft(50)954 2700 y(iii)p eop
%%Page: 4 6
5 bop 150 204 a Fs(List)18 b(of)f(T)-7 b(ables)225 346 y Ft(1)89
b(Rewrite)12 b(rules)h(for)e(the)i(basic)f(combinators)38 b
Fq(:)25 b(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)99
b Ft(7)225 436 y(2)89 b(Rewrite)12 b(rules)h(for)e(the)i(\256nite)e
(datatypes)20 b Fq(:)25 b(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h
(:)f(:)99 b Ft(8)225 526 y(3)89 b(Rewrite)12 b(rules)h(for)e(the)i
(in\256nite)e(datatypes)20 b Fq(:)k(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)h(:)f(:)99 b Ft(8)225 617 y(4)89 b(Rewrite)12 b(rules)h(for)e(the)i
(\256nite)e(products)36 b Fq(:)25 b(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)h(:)f(:)99 b Ft(9)225 707 y(5)89 b(State)12 b(transition)g(rules)g
(for)g(the)g(basic)h(instructions)25 b Fq(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h
(:)f(:)74 b Ft(13)225 797 y(6)89 b(State)12 b(transition)g(rules)g(for)g(the)
g(datatypes)31 b Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)
f(:)74 b Ft(14)225 887 y(7)89 b(State)12 b(transition)g(rules)g(for)g
(\256nite)g(datatypes)27 b Fq(:)e(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h
(:)f(:)74 b Ft(15)225 978 y(8)89 b(Reducing)13 b(a)f(Combinator)g(Expression)
h(with)f(an)g(Abstract)g(Machine)47 b Fq(:)24 b(:)74 b Ft(16)225
1068 y(9)89 b(Macro)13 b(instructions)f(for)f(the)i(basic)f(combinators)46
b Fq(:)24 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74 b Ft(18)225
1158 y(10)64 b(Macro)13 b(instructions)f(for)f(the)i(\256nite)e(datatypes)28
b Fq(:)c(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74 b
Ft(18)225 1249 y(1)n(1)66 b(Macro)13 b(instructions)f(for)f(the)i(in\256nite)
e(datatypes)27 b Fq(:)e(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(18)225 1339 y(12)64 b(Macro)13 b(instructions)f(for)f(the)i(\256nite)e
(products)44 b Fq(:)24 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(19)225 1429 y(13)64 b(Macro)13 b(instructions)f(for)f(administration)38
b Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(19)225 1519 y(14)64 b(The)13 b(compileSC)f(compilation)g(scheme)22
b Fq(:)j(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(23)225 1610 y(15)64 b(The)13 b(compileC)f(compilation)g(scheme)50
b Fq(:)25 b(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(24)225 1700 y(16)64 b(Compiling)12 b(Distributive)f(combinators)23
b Fq(:)i(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(24)225 1790 y(17)64 b(Compiling)12 b(Inactive)g(combinators)23
b Fq(:)i(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f(:)74
b Ft(24)225 1881 y(18)64 b(Compiling)12 b(Active)g(combinators)h
Fq(:)24 b(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)h(:)f
(:)74 b Ft(25)956 2700 y(iv)p eop
%%Page: 5 7
6 bop 150 203 a Fs(Acknowledgements)150 345 y Ft(I)21 b(would)g(like)g(to)g
(thank)g(a)g(few)g(individuals)g(who)g(have)h(contributed)e(to)h(the)g(CHARM)
150 435 y(project.)39 b(T)m(o)20 b(members)f(of)g(the)h(Charity)f(research)g
(group)g(Dr)m(.)40 b(Robin)20 b(Cockett)f(for)g(his)150 526
y(support)h(and)h(guidance)g(throughout)f(this)h(project)f(and)h(T)m(om)g
(Fukushima)f(for)g(the)h(help)150 616 y(in)e(understanding)f(Charity)m(.)38
b(In)19 b(addition)g(to)f(Dr)m(.)39 b(Mike)19 b(W)n(illiams)g(for)g(his)g
(instruction)150 706 y(in)e(research)g(methodologies)f(and)h(\256nally)f(to)h
(Marc)g(Schroeder)f(for)g(his)h(suggestions)g(and)150 796 y(related)12
b(work)g(on)g(the)g(Charity)g(interpreter)f(\(CHIRP\).)963
2700 y(v)p eop
%%Page: 1 8
7 bop 150 204 a Fs(1)72 b(Backgr)o(ound)150 368 y Fm(1.1)59
b(Charity)15 b(Basics)150 491 y Ft(The)9 b(Charity)g(project)f(is)i(an)f
(attempt)f(at)h(developing)f(a)h(complete)g(interpreter)f(for)g(the)h
(Charity)150 582 y(language[CF92)o(].)32 b(The)17 b(Charity)g(project)f(is)i
(composed)f(of)f(two)h(components,)h(the)f(front)150 672 y(end)j(\261)g(user)
g(interface)f(\(CHIRP\))g(and)h(the)g(back)g(end)g(\261)g(abstract)g(machine)
g(\(CHARM\).)150 762 y(The)f(task)h(of)e(CHIRP)h(is)g(to)g(take)g(programs)f
(speci\256ed)h(in)g(the)g(Charity)f(language)h(\(term)150 852
y(logic\))13 b(and)h(translate)f(it)h(into)f Fl(categorical)h(combinators)p
Ft(.)22 b(Charity)13 b(programs)g(represented)150 943 y(as)18
b(categorical)f(combinators)g(are)h(then)f(evaluated)h(by)f(the)h(CHARM)g
(abstract)g(machine.)150 1033 y(Figure)11 b(1)g(gives)h(a)f(breakdown)g(of)g
(the)h(Charity)f(project)g(and)g(the)g(interface)g(between)h(its)f(two)150
1123 y(parts.)18 b(The)13 b(focus)g(of)e(this)i(paper)f(is)h(on)f(the)g
(CHARM)h(aspect)g(of)f(the)h(Charity)e(project.)662 1192 y
 9867264 17563730 14603550 25523322 24470814 43087052 startTexFig

662 1192 a
%%BeginDocument: fig_interface.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Times-Roman
%%Pages: 1
%%BoundingBox: 222 388 372 655
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 51 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Times-Roman reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 8 8 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
1 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -156 82 ] concat
%I
458 718 459 718 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 317 806 ] concat
%I
[
(Charity Interpreter)
(       \(CHIRP\))
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 318 524 ] concat
%I
[
(Abstract machine)
(      \(CHARM\))
] Text
End

Begin %I Rect
%I b 65535
1 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -149 81 ] concat
%I
451 687 576 738 Rect
End

Begin %I Rect
%I b 65535
1 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -149 -63 ] concat
%I
451 687 576 738 Rect
End

Begin %I Rect
%I b 65535
1 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -149 -199 ] concat
%I
451 687 576 738 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 336 662 ] concat
%I
[
( categorical)
(combinators)
] Text
End

Begin %I Line
%I b 65535
1 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -157 82 ] concat
%I
492 685 492 599 Line
%I 1
End

Begin %I Line
%I b 65535
1 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -157 82 ] concat
%I
492 601 492 595 Line
%I 1
End

Begin %I Line
%I b 65535
1 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -157 82 ] concat
%I
493 541 493 461 Line
%I 1
End

Begin %I Line
%I b 65535
1 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -157 82 ] concat
%I
556 597 556 687 Line
%I 1
End

Begin %I Line
%I b 65535
1 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -157 82 ] concat
%I
558 460 558 544 Line
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 280 587 ] concat
%I
[
(compile)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 280 731 ] concat
%I
[
(translate)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 416 731 ] concat
%I
[
(result)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 416 587 ] concat
%I
[
(decompile)
] Text
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 569 2406 a Ft(Figure)g(1:)18 b(CHIRP)12 b(and)h(CHARM)g(interface)963
2700 y(1)p eop
%%Page: 2 9
8 bop 223 203 a Ft(Charity)13 b(programs)g(are)h(not)f(directly)g(executed,)h
(they)g(are)f(translated)g(into)g(categorical)150 294 y(combinators)d(to)h
(provide)g(an)g(intermediate)f(interface)g(between)i(the)f(front)f(end)h
(\(term)f(logic\))150 384 y(and)j(the)h(back)f(end)g(\(abstract)g(machine\).)
21 b(A)13 b(sequence)h(of)f(categorical)g(combinators)g(com-)150
474 y(posed)i(together)g(make)g(up)g(a)g(categorical)g(combinator)f
(expression)h(and)g(de\256ne)g(a)h(Charity)150 565 y(function.)223
655 y(While)9 b(it)g(is)h(possible)f(to)h(program)e(at)h(the)g(combinator)f
(level)i(this)f(level)g(of)g(programming)150 745 y(is)k(analogous)f(to)g
(assembly)h(language)f(programming.)223 835 y(For)g(example)g(the)g
(following)g(combinator)f(expression)h(de\256nes)h(multiplication:)150
1011 y Fo(h)p Fq(P)200 1018 y Fn(1)221 1011 y Fp(;)8 b Ft(id)o
Fq(;)g Ft(id)p Fo(i)p Fp(;)g Ft(fold)p 467 1011 15 2 v 17 w(nat)p
Fp(\()p Fo(h)p Fq(P)611 1018 y Fn(1)632 1011 y Fp(;)g Fq(P)685
1018 y Fn(0)705 1011 y Fp(;)g Ft(id)o Fq(;)g Fp(!;)g Ft(zero)o
Fo(i)p Fq(;)g Fo(h)p Fq(P)999 1018 y Fn(0)1020 1011 y Fp(;)g
Fq(P)1073 1018 y Fn(0)1093 1011 y Fp(;)g Ft(id)o Fq(;)g Fo(h)p
Fq(P)1225 1018 y Fn(0)1246 1011 y Fp(;)g Fq(P)1299 1018 y Fn(0)1319
1011 y Fp(;)g Ft(id)o Fq(;)g(P)1432 1018 y Fn(0)1452 1011 y
Fp(;)g Fq(P)1505 1018 y Fn(1)1525 1011 y Fp(;)g Ft(id)p Fo(i)p
Fp(;)g Ft(add)p Fo(i)p Fp(\);)g Fq(P)1790 1018 y Fn(1)223 1176
y Ft(It)h(is)h(not)f(immediately)f(obvious)h(that)h(the)f(above)g(combinator)
f(expression)i(is)g(the)f(de\256nes)150 1266 y(the)18 b(multiplication)f
(function)g(over)g(the)h(natural)f(numbers.)35 b(In)18 b(Charity)f(term)h
(logic,)h(the)150 1357 y(multiplication)11 b(function)g(de\256ned)i(below)f
(is)g(considerably)g(more)g(readable)1510 1339 y Fn(1)1530
1357 y Ft(:)568 1591 y Fk(def)30 b(mul)g(\(x,)f(y\))h(=)688
1682 y(p1)748 1772 y(\({|)f(zero:\(\))149 b(=>)30 b(\(x,zero\))808
1862 y(|)f(succ:\(x,)g(y\))h(=>)g(\(x,add\(x,)f(y\)\))808 1952
y(|})g(\(y\))748 2043 y(\).)223 2277 y Ft(A)15 b(rewriting)f(system)i(then)f
(speci\256es)h(how)f(the)g(categorical)g(combinator)g(expressions)150
2368 y(are)j(evaluated.)34 b(Implementing)17 b(a)g(rewriting)g(system)h(is)g
(done)g(by)g(an)f(abstract)h(machine)p 150 2451 660 2 v 206
2481 a Fj(1)225 2496 y Fi(This)10 b(multiplication)d(function)i(can)i(be)f
(found)f(in)h(the)g(EXAMPLES)h(directory)f(of)f(the)h(SML)h(implemen-)150
2546 y(tation)e(of)h(the)g(Charity)f(system)963 2700 y Ft(2)p
eop
%%Page: 3 10
9 bop 150 203 a Ft(that)16 b(can)h(be)g(thought)f(of)g(as)h(a)g(state)g
(transition)f(machine)g(with)g(behavior)g(governed)g(by)h(a)150
294 y(set)e(of)g(rewrite)f(rules.)25 b(State)15 b(transitions)f(in)h(the)g
(abstract)g(machine)f(are)h(derived)f(from)g(the)150 384 y(the)i(rewrite)f
(rules.)29 b(The)17 b(objective)e(in)h(designing)g(an)g(ef)o(\256cient)f
(abstract)h(machine)g(lies)g(in)150 474 y(selecting)11 b(state)h(transition)e
(rules)h(that)g(are)g(as)g(mechanical)g(and)h(simple)f(as)g(possible)h
(thereby)150 565 y(minimizing)c(the)g(complexity)g(of)g(the)g(machine.)14
b(At)8 b(the)g(same)g(time)g(the)g(state)g(transition)g(rules)150
655 y(should)j(translate)g(easily)h(from)e(the)h(source)g(language)g(to)g
(the)h(abstract)f(machine)g(level[Pey)o(].)150 839 y Fm(1.2)59
b(Pr)o(evious)14 b(W)m(ork)150 963 y Ft(The)19 b(Charity)e(system)i
(described)f(in)g([CF92])g(uses)h(an)f(\252eager)r(\272)g(or)g
(\252by\261value\272)g(abstract)150 1053 y(machine)11 b(to)g(evaluate)h
(programs.)17 b(The)12 b(eager)f(abstract)g(machine)h(is)f(a)h(high)f(level)g
(\261)g(evalua-)150 1144 y(tion)h(model)g(implemented)g(in)h(the)f(SML)h
(programming)e(language)h(and)h(modeled)f(after)g(the)150 1234
y Fl(Categorical)g(Abstract)i(Machine)e Ft(\(CAM\))h([CCM85].)223
1324 y(The)g(CAM)g(machine)g(is)g(said)g(to)f(be)h(\252eager)r(\272)g
(because)g(all)f(ar)o(guments)h(to)f(functions)g(are)150 1415
y(evaluated)h(fully)f(before)g(the)h(function)f(is)h(evaluated.)21
b(The)13 b(choice)g(of)g(an)g(eager)f(evaluation)150 1505 y(strategy)g(has)g
(potentially)f(serious)h(ef)o(\256ciency)g(problems)f(since)i(unnecessary)f
(computation)150 1595 y(is)19 b(performed.)38 b(In)18 b([Her92)o(])h(some)h
(of)e(the)h(ef)o(\256ciency)g(problems)g(of)f(the)i(eager)f(Charity)150
1685 y(machine)e(are)g(addressed)g(using)g(a)g(\252lazy\272)h(evaluation)e
(model.)32 b(Hermann')m(s)17 b(model,)h(also)150 1776 y(called)g(CHARM)h
(suspends)g(evaluation)f(of)g(all)g(ar)o(guments)g(to)g(functions)g(until)f
(they)h(are)150 1866 y(required)h(by)g(the)h(function.)39 b(In)20
b(addition,)h(Hermann')m(s)e(CHARM)i(machine)e(introduces)150
1956 y(several)10 b(graph)f(reduction)g(techniques)h(to)f(improve)g(the)g(ef)
o(\256ciency)h(of)f(the)h(abstract)f(machine)150 2047 y(\(see)k(Appendix)f
(A\).)150 2231 y Fm(1.3)59 b(Goal)14 b(and)i(Achievements)150
2355 y Ft(The)h(motivation)f(behind)g(this)h(project)f(is)h(to)f(build)h(a)f
(portable)g(and)h(reasonably)g(ef)o(\256cient)150 2445 y(abstract)12
b(machine)f(that)h(will)f(execute)h(Charity)g(programs)f(quickly)m(.)17
b(The)12 b(abstract)g(machine)150 2536 y(described)c(in)g(this)g(paper)g(is)g
(implemented)g(in)f(the)h(C)g(pr)o(ogrammi)o(ng)g(language)f(so)h(as)g
(facilitate)963 2700 y(3)p eop
%%Page: 4 11
10 bop 150 203 a Ft(the)12 b(portability)f(of)h(the)h(system.)223
294 y(The)i(\256rst)f(step)h(in)f(this)g(project)g(was)h(to)f
(re\261implement)f(the)i(by\261value)f(machine)g(in)g(the)150
384 y(C)20 b(programming)f(language.)42 b(The)20 b(C)h(implementation)e
(removes)h(most)g(of)g(the)g(pattern)150 474 y(matching)13
b(associated)i(with)e(the)h(SML)g(implementation.)22 b(In)13
b(addition,)h(functions)f(de\256ned)150 565 y(as)k(categorical)e(combinator)g
(expressions)i(are)f(compiled)f(into)h(\252machine)g(code\272.)29
b(In)16 b(this)150 655 y(paper)c(the)g(term)f(machine)h(code)g(refers)f(to)h
(two)g(levels,)h(the)f(macro\261code)f(and)h(micro\261code.)150
745 y(The)19 b(macro\261code)f(is)g(a)h(lower)f(level)g(speci\256cation)g(of)
g(categorical)g(combinators)f(where)150 835 y(each)12 b(macro\261instruction)
e(is)i(comprised)f(of)h(micro\261instructions.)k(At)c(a)g(micro\261code)f
(level,)150 926 y(micro\261instructions)i(change)i(the)f(state)h(of)g(the)f
(machine.)25 b(Figure)14 b(2)g(illustrates)h(the)f(layers)150
1016 y(of)e(the)g(CHARM)h(abstract)g(machine.)708 1065 y
 8420066 17037476 15392931 20063436 23812997 37100912 startTexFig
 708
1065 a
%%BeginDocument: fig_compileoverview.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica
%%Pages: 1
%%BoundingBox: 234 305 362 564
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 51 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 8 8 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t u

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t u

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 311 698 ] concat
%I
[
(Categorical combinator)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 343 677 ] concat
%I
[
(Expressions)
] Text
End

End %I eop

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 171.5 228 ] concat
%I
130 428 279 475 Rect
End

End %I eop

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 1 0 0 1 -2.5 -94 ] concat

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 326 514 ] concat
%I
[
(Micro instructions)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 52 ] concat
%I
130 428 279 475 Rect
End

End %I eop

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 1 0 0 1 -2.5 -38 ] concat

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 324 593 ] concat
%I
[
(Macro instructions)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 132 ] concat
%I
130 428 279 475 Rect
End

End %I eop

Begin %I Line
%I b 65535
3 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 219 230 ] concat
%I
165 426 165 342 Line
%I 1
End

Begin %I Line
%I b 65535
3 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 219 94 ] concat
%I
165 426 165 342 Line
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 297 625 ] concat
%I
[
(Machine)
(compile)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 300 481 ] concat
%I
[
(Interpret)
] Text
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 442 2246 a Ft(Figure)e(2:)18 b(Overview)12 b(of)g(the)g(CHARM)h(abstract)g
(machine)223 2395 y(The)f(layout)e(of)h(this)g(paper)g(is)g(as)g(follows.)18
b(Section)10 b(2)h(introduces)g(the)g(rewriting)f(system)150
2485 y(of)17 b(Charity)h(that)g(serves)g(as)g(a)h(foundation)d(for)h(the)h
(remainder)f(of)h(the)f(paper)m(.)35 b(From)17 b(the)150 2575
y(rewriting)i(rules,)24 b(an)d(abstract)f(machine)h(is)g(derived)f(and)h
(presented)g(in)g(Section)f(3.)44 b(In)963 2700 y(4)p eop
%%Page: 5 12
11 bop 150 203 a Ft(Section)17 b(4)h(\(The)f(Macro\261code\))g(and)h(Section)
f(5)h(\(The)f(Micro\261code\))g(a)h(description)f(of)g(a)150
294 y(C)f(implementation)f(of)h(the)g(eager)g(abstract)g(machine)g(is)h
(given.)29 b(Finally)16 b(in)g(Section)f(6,)j(a)150 384 y(suggestion)13
b(of)f(future)f(work)h(is)g(discussed.)963 2700 y(5)p eop
%%Page: 6 13
12 bop 150 204 a Fs(2)72 b(The)17 b(Rewriting)g(Rules)g(of)h(Charity)150
346 y Ft(Charity)13 b(programs)g(are)g(accepted)h(by)f(the)g(CHIRP)g(user)h
(interface)e(and)i(translated)f(to)g(cate-)150 436 y(gorical)g(combinator)f
(expressions)i(by)f(the)g(translation)g(rules)g(described)g(in)g([CF92)o(].)
21 b(Cate-)150 526 y(gorical)10 b(combinator)g(expressions)h(satisfy)g(the)g
(basic)g(rules)g(of)g(category)f(theory)g(that)h(makes)150
617 y(provision)g(for)f(an)h(identity)g(combinator)f(and)i(allows)f(them)g
(to)g(be)g(composed)h(together)e(with)150 707 y(an)i(associative)h
(composition.)18 b(In)12 b(addition,)g(basic)g(category)g(theory)f(contains)i
(objects)f(and)150 797 y(maps)f(\(arrows\))e(between)h(objects.)18
b(In)10 b(categorical)g(combinator)g(terms,)h(the)f(objects)h(are)f(the)150
887 y(datatypes)f(and)h(a)f(map)g(from)g(one)g(datatype)g(to)g(another)g(is)g
(de\256ned)g(by)h(giving)e(a)i(composition)150 978 y(of)i(combinators.)223
1068 y(Evaluating)21 b(categorical)f(combinator)g(expressions)h(are)f(done)h
(through)f(a)g(rewriting)150 1158 y(system.)28 b(In)15 b(a)h(rewriting)e
(system,)k(expressions)e(are)f(replaced)h(by)f(a)h(\252reduction\272)f(with)g
(an)150 1249 y(equivalent)10 b(expression.)18 b(For)9 b(the)h(discussion)h
(in)f(this)h(paper)n(,)g(the)f(terminology)f(\252reduction\272)150
1339 y(will)17 b(mean)g(a)g(single)h(step)f(in)g(the)h(evaluation)e(of)h(a)h
(Charity)e(program.)32 b(Combinator)16 b(ex-)150 1429 y(pressions)f(are)f
(executed)g(through)f(a)h(series)h(of)f(reductions)f(to)h(transform)f(one)h
(combinator)150 1519 y(expression)h(to)g(another)n(,)h(until)e(no)h(more)f
(reductions)h(can)g(be)g(performed.)25 b(An)15 b(expression)150
1610 y(where)10 b(no)g(more)g(reductions)g(can)h(be)g(performed)d(is)j(said)g
(to)f(be)h(in)f(reduced)g(or)g(normal)g(form.)223 1700 y(A)15
b(reduction)f(in)g(a)h(rewriting)f(system)h(is)g(determined)f(by)g(a)h(set)g
(of)f(rewrite)g(rules.)26 b(The)150 1790 y(rewrite)12 b(rules)g(described)g
(in)g(this)h(section)f(use)h(the)g(following)e(notation:)248
1868 y Fo(h)p Fq(a;)d(b)p Fo(i)50 b Ft(\261)12 b(represents)h(a)f(pair)248
1959 y Fp(;)143 b Ft(\261)12 b(is)h(the)f(symbol)g(for)g(composition)248
2049 y Fo(\))107 b Ft(\261)12 b(is)h(a)f(rewrite)248 2139 y
Fo(j)143 b Ft(\261)12 b(is)h(a)f(choice)h(operator)223 2204
y(Categorical)h(combinator)f(expressions)i(are)e(represented)h(in)g(a)g
(graph)g(structure)f(where)150 2294 y(a)i(program)e(composed)i(of)f
(combinators)g(is)h(evaluated)f(by)h(reducing)f(this)h(graph)f(structure)150
2385 y(using)f(a)f(set)h(of)f(rewrite)g(rules.)19 b(Each)13
b(individual)f(categorical)g(combinator)f(can)i(be)g(thought)150
2475 y(of)h(as)i(a)e(function)g(with)h(parameters.)25 b(For)14
b(example,)h(the)g(pair)f(combinator)g(is)h(denoted)f(by)150
2565 y Fo(h)p Fq(a;)8 b(b)p Fo(i)j Ft(and)f(has)h(an)g(alternative)f(in\256x)
g(notation)f(P)-5 b(AIR\(a,)11 b(b\);)g(when)f Fo(h)p Fq(a;)e(b)p
Fo(i)j Ft(is)g(composed)f(with)963 2700 y(6)p eop
%%Page: 7 14
13 bop 150 203 a Ft(the)11 b(\256rst)f(projection)h Fq(P)555
210 y Fn(0)586 203 y Ft(it)f(is)i(written)e(as)h Fo(h)p Fq(a;)d(b)p
Fo(i)p Fp(;)g Fq(P)1033 210 y Fn(0)1053 203 y Ft(.)18 b(A)11
b(reduction)g(of)f(this)h(composition)g(\(the)150 294 y(\256rst)h(projection)
f(of)h(a)h(pair\))e(is)i(given)f(by)h(the)f(rule)g Fo(h)p Fq(a;)c(b)p
Fo(i)p Fp(;)g Fq(P)1204 301 y Fn(0)1238 294 y Fo(\))13 b Fq(a)p
Ft(.)223 384 y(T)m(able)g(1)h(de\256nes)f(the)g(basic)h(set)g(of)f
(rewritings)f(underlying)g(the)i(Charity)e(system.)22 b(Rule)150
474 y(\(1\))13 b(is)h(the)g(rewrite)f(rule)g(for)g(\252!\272)22
b(\(the)13 b(terminal)g(map\).)22 b(This)14 b(operation)f(eliminates)h(all)f
(the)150 565 y(reductions)f(that)h(has)g(performed)e(in)h(the)h(composition)f
(sequence)h(to)g(the)f(left)g(of)h(!.)18 b(Rewrite)150 655
y(rules)e(\(2\))g(and)h(\(3\))e(are)i(the)f(\256rst)g(and)h(second)g
(projections)f(on)g(a)h(pair)n(,)g(respectively)m(.)31 b(The)150
745 y(projections)11 b(on)h(a)h(pair)e(a)i(analogous)f(to)g(taking)f(the)h
(\256rst)g(\()p Fq(P)1216 752 y Fn(0)1236 745 y Ft(\))f(or)h(second)g(\()p
Fq(P)1516 752 y Fn(1)1536 745 y Ft(\))g(co\261ordinate)150
835 y(of)g(a)g(cartesian)g(product.)18 b(Finally)m(,)12 b(Rules)g(\(4\))g
(and)g(\(5\))f(are)h(the)h(coproducts)e(while)h(\(6\))g(is)g(the)150
926 y(distribution)f(rule)h(for)g(products.)p 684 1104 687
2 v 601 1145 a Fp(\(1\))p 683 1163 2 61 v 286 w Fq(z)r Fp(;)c(!)41
b Fo(\))g Fp(!)p 1369 1163 V 601 1205 a(\(2\))p 683 1223 V
159 w Fo(h)p Fq(x;)8 b(y)r Fo(i)p Fp(;)g Fq(P)989 1212 y Fn(0)1051
1205 y Fo(\))41 b Fq(x)p 1369 1223 V 601 1265 a Fp(\(3\))p
683 1283 V 159 w Fo(h)p Fq(x;)8 b(y)r Fo(i)p Fp(;)g Fq(P)989
1272 y Fn(1)1051 1265 y Fo(\))41 b Fq(y)p 1369 1283 V 601 1325
a Fp(\(4\))p 683 1343 V 42 w Fo(h)p Fq(z)r Fp(;)8 b Fq(b)792
1332 y Fn(0)811 1325 y Fq(;)g(x)p Fo(i)p Fp(;)g Fo(h)p Fq(f)d
Fo(j)p Fq(g)r Fo(i)43 b(\))e(h)p Fq(z)r(;)8 b(x)p Fo(i)p Fp(;)g
Fq(f)p 1369 1343 V 601 1385 a Fp(\(5\))p 683 1403 V 42 w Fo(h)p
Fq(z)r Fp(;)g Fq(b)792 1392 y Fn(1)811 1385 y Fq(;)g(x)p Fo(i)p
Fp(;)g Fo(h)p Fq(f)d Fo(j)p Fq(g)r Fo(i)43 b(\))e(h)p Fq(z)r(;)8
b(x)p Fo(i)p Fp(;)g Fq(g)p 1369 1403 V 601 1446 a Fp(\(6\))p
683 1464 V 185 w Fq(z)r Fp(;)g Fo(h)p Fq(x;)g(y)r Fo(i)42 b(\))f(h)p
Fq(z)r Fp(;)8 b Fq(x;)g(z)r Fp(;)g Fq(y)r Fo(i)p 1369 1464
V 684 1465 687 2 v 493 1593 a Ft(T)m(able)13 b(1:)k(Rewrite)c(rules)f(for)f
(the)i(basic)f(combinators)223 1731 y(In)g(addition,)g(operations)g(on)g(the)
h(datatypes)f(are)h(handled)f(by)g(a)h(separate)f(set)h(of)f(rewrite)150
1821 y(rules.)25 b(The)15 b(datatypes)f(in)h(the)f(Charity)g(system)h(are)g
(divided)f(into)g(two)g(classes,)j(\256nite)d(and)150 1912
y(in\256nite.)28 b(Finite)15 b(datatypes)i(refer)e(to)g(structures)h(that)g
(guarantee)f(an)h(end)g(to)g(the)g(structure)150 2002 y(of)c(the)h(data)g
(when)g(operations)f(are)h(performed)e(on)i(them.)20 b(On)12
b(the)h(other)f(hand,)i(the)f(data)g(of)150 2092 y(an)f(in\256nite)g
(datatypes)h(may)f(never)g(end.)18 b(In\256nite)12 b(datatypes)g(are)h
(similar)e(to)i(the)f Fl(str)n(eams)i Ft(of)150 2183 y(standard)e(functional)
g(languages.)18 b(For)12 b(example,)g(one)h(can)f(de\256ne)h(the)f(natural)g
(numbers)g(as)150 2273 y(a)h(stream)f(of)g(numbers:)223 2363
y Fp(0)p Fq(;)c Fp(1)p Fq(;)g Fp(2)p Fq(;)g Fp(3)p Fq(;)g Fp(4)p
Fq(;)g(:)g(:)g(:)223 2453 y Ft(For)14 b(the)h(\256nite)f(datatypes)h(there)f
(are)h(three)f(standard)h(operations)f(that)h(manipulate)f(the)150
2544 y(datatype)19 b(\(case)440 2526 y Fh(L)485 2544 y Ft(\(7\),)h(fold)657
2526 y Fh(L)701 2544 y Ft(\(8\))e(and)g(map)954 2526 y Fh(L)999
2544 y Ft(\(9\)\))f(are)i(de\256ned)f(by)h(the)g(rewrite)f(rules)g(in)963
2700 y(7)p eop
%%Page: 8 15
14 bop 150 203 a Ft(T)m(able)21 b(2.)45 b(The)22 b(case)g(operator)e(views)h
(the)g(head)h(element)f(of)f(a)i(datatype)f(structure)f(to)150
294 y(determine)15 b(an)h(action.)28 b(The)17 b(fold)e(operator)g(can)g(be)h
(viewed)g(as)g(head)g(recursion)g(call)f(that)150 384 y(rewrites)8
b(the)g(datatype)g(structure)g(to)g(another)f(datatype)h(structur)o(e.)14
b(Lastly)m(,)c(the)e(map)g(operator)150 474 y(performs)j(some)i(action)f(on)g
(each)h(node)f(of)g(a)h(the)f(structure.)p 254 653 1588 2 v
171 693 a Fp(\(7\))p 253 711 2 61 v 60 w Fo(h)p Fq(v)336 700
y Fn(0)355 693 y Fp(;)c Fq(c)398 700 y Fh(i)412 693 y Fq(;)g(v)458
700 y Fn(1)477 693 y Fo(i)p Fp(;)g Ft(case)604 675 y Fh(L)630
693 y Fo(f)p Fq(f)679 700 y Fn(1)699 693 y Fq(;)g(:)g(:)g(:)f(;)h(f)832
700 y Fh(n)856 693 y Fo(g)41 b(\))g(h)p Fq(v)1056 700 y Fn(0)1076
693 y Fq(;)8 b(v)1122 700 y Fn(1)1141 693 y Fo(i)p Fp(;)g Fq(f)1206
700 y Fh(i)p 1840 711 V 171 754 a Fp(\(8\))p 253 773 2 62 v
66 w Fo(h)p Fq(v)342 761 y Fn(0)362 754 y Fp(;)g Fq(c)405 761
y Fh(i)419 754 y Fq(;)g(v)465 761 y Fn(1)484 754 y Fo(i)p Fp(;)g
Ft(fold)606 734 y Fh(L)632 754 y Fo(f)p Fq(g)680 761 y Fn(1)700
754 y Fq(;)g(:)g(:)g(:)f(;)h(g)832 761 y Fh(n)856 754 y Fo(g)41
b(\))g(h)p Fq(v)1056 761 y Fn(0)1076 754 y Fp(;)8 b Fq(v)1122
761 y Fn(1)1141 754 y Fo(i)p Fp(;)g Fo(h)p Ft(map)1288 736
y Fh(E)1314 741 y Fg(i)1329 754 y Fo(f)p Fq(P)1385 761 y Fn(0)1405
754 y Fq(;)g Ft(fold)1507 734 y Fh(L)1533 754 y Fo(f)p Fq(g)1581
761 y Fn(1)1601 754 y Fq(;)g(:)g(:)g(:)f(;)h(g)1733 761 y Fh(n)1757
754 y Fo(gg)p Fq(;)p 1840 773 V 253 833 2 61 v 1013 815 a(P)1044
822 y Fn(1)1065 815 y Fo(i)p Fp(;)g Fq(g)1129 822 y Fh(i)p
1840 833 V 171 875 a Fp(\(9\))p 253 893 V 42 w Fo(h)p Fq(v)318
882 y Fn(0)337 875 y Fp(;)g Fq(c)380 882 y Fh(i)394 875 y Fq(;)g(v)440
882 y Fn(1)459 875 y Fo(i)p Fp(;)g Ft(map)586 857 y Fh(L)612
875 y Fo(f)p Fq(h)665 882 y Fn(1)685 875 y Fq(;)g(:)g(:)g(:)g(;)g(h)823
882 y Fh(m)856 875 y Fo(g)41 b(\))g(h)p Fq(v)1056 882 y Fn(0)1076
875 y Fp(;)8 b Fq(v)1122 882 y Fn(1)1141 875 y Fo(i)p Fp(;)g
Ft(map)1268 857 y Fh(E)1294 862 y Fg(i)1309 875 y Fo(f)p Fq(h)1362
882 y Fn(1)1382 875 y Fq(;)g(:)g(:)g(:)g(;)g(h)1520 882 y Fh(m)1553
875 y Fq(;)p 1840 893 V 253 953 V 1013 935 a Ft(map)1099 917
y Fh(L)1125 935 y Fo(f)p Fq(h)1178 942 y Fn(1)1198 935 y Fq(;)g(:)g(:)g(:)f
(;)h(h)1335 942 y Fh(m)1369 935 y Fo(gg)p Fp(;)g Fq(c)1462
942 y Fh(i)p 1840 953 V 254 955 1588 2 v 522 1082 a Ft(T)m(able)13
b(2:)k(Rewrite)c(rules)f(for)f(the)i(\256nite)f(datatypes)223
1231 y(The)17 b(rules)e(for)h(the)f(in\256nite)h(datatypes)g(record)1070
1213 y Fh(R)1114 1231 y Ft(\(10\),)g(unfold)1357 1213 y Fh(R)1401
1231 y Ft(\(1)n(1\))f(and)h(map)1672 1213 y Fh(R)1717 1231
y Ft(\(12\))150 1321 y(are)11 b(de\256ned)g(by)h(T)m(able)f(3.)18
b(These)12 b(rules)g(allow)f(operations)g(on)g(in\256nite)g(datatypes)g
(similar)g(to)150 1411 y(those)i(of)f(the)g(\256nite)g(datatypes.)p
287 1590 1505 2 v 179 1631 a Fp(\(10\))p 286 1649 2 62 v 44
w Ft(record)436 1611 y Fh(R)465 1631 y Fo(f)p Fq(f)514 1638
y Fn(1)534 1631 y Fq(;)c(:)g(:)g(:)f(;)h(f)667 1638 y Fh(n)691
1631 y Fo(g)p Fp(;)g Fq(d)763 1638 y Fh(i)818 1631 y Fo(\))42
b Fq(g)933 1638 y Fh(i)p 1791 1649 V 179 1692 a Fp(\(11\))p
286 1710 V 43 w Ft(unfold)438 1672 y Fh(R)466 1692 y Fo(f)p
Fq(g)514 1699 y Fn(1)534 1692 y Fq(;)8 b(:)g(:)g(:)g(;)g(g)667
1699 y Fh(n)691 1692 y Fo(g)p Fp(;)g Fq(d)763 1699 y Fh(i)818
1692 y Fo(\))42 b(h)p Fq(f)953 1699 y Fh(i)967 1692 y Fq(;)8
b(P)1020 1699 y Fn(1)1040 1692 y Fo(i)p Fp(;)g Ft(map)1167
1674 y Fh(E)1193 1679 y Fg(i)1208 1692 y Fo(f)p Fq(P)1264 1699
y Fn(0)1284 1692 y Fq(;)g Ft(unfold)1436 1672 y Fh(R)1465 1692
y Fo(f)p Fq(f)1514 1699 y Fn(1)1534 1692 y Fq(;)g(:)g(:)g(:)f(;)h(f)1667
1699 y Fh(n)1690 1692 y Fo(gg)p 1791 1710 V 179 1753 a Fp(\(12\))p
286 1771 2 61 v 68 w Ft(map)418 1735 y Fh(R)447 1753 y Fo(f)p
Fq(h)500 1760 y Fn(1)520 1753 y Fq(;)g(:)g(:)g(:)f(;)h(h)657
1760 y Fh(m)691 1753 y Fo(g)p Fp(;)g Fq(d)763 1760 y Fh(i)818
1753 y Fo(\))42 b Ft(map)995 1735 y Fh(E)1021 1740 y Fg(i)1036
1753 y Fo(f)p Fq(h)1089 1760 y Fn(1)1109 1753 y Fq(;)8 b(:)g(:)g(:)g(;)g(h)
1247 1760 y Fh(m)1280 1753 y Fq(;)g Ft(map)1387 1735 y Fh(R)1416
1753 y Fo(f)p Fq(h)1469 1760 y Fn(1)1489 1753 y Fq(;)g(:)g(:)g(:)f(;)h(h)1626
1760 y Fh(m)1660 1753 y Fo(gg)p Fp(;)g Fq(d)1757 1760 y Fh(i)p
1791 1771 V 287 1772 1505 2 v 503 1900 a Ft(T)m(able)k(3:)18
b(Rewrite)12 b(rules)g(for)g(the)g(in\256nite)g(datatypes)223
2048 y(The)k(remaining)e(rewrite)g(rules)i(for)e(the)h(\256nite)g(products)f
(are)i(given)e(in)h(T)m(able)h(4.)26 b(Each)150 2138 y(map)236
2120 y Fh(E)262 2125 y Fg(i)296 2138 y Ft(in)18 b(the)h(rewrite)f(rules)g
(for)g(the)h(datatypes)g(are)f(substituted)h(with)f(the)h(appropriate)150
2229 y(map)f(in)g(T)m(able)f(4.)35 b(The)19 b(association)f(between)g(the)g
(two)g(will)f(be)h(discussed)h(fully)e(in)h(the)150 2319 y
Fr(Compiling)12 b(Categorical)f(Combinators)h Ft(section.)223
2409 y(In)f(a)g(rewriting)f(system,)j(the)e(order)f(in)i(which)f(rewrite)f
(rules)h(are)g(applied)g(in)g(a)h(reduction)150 2500 y(does)f(not)g(af)o
(fect)f(the)h(answer)m(.)18 b(At)11 b(each)g(step)g(in)f(the)h(reduction)f
(of)g(a)h(combinator)f(expression)963 2700 y(8)p eop
%%Page: 9 16
15 bop 450 263 1179 2 v 343 304 a Fp(\(13\))p 449 322 2 61
v 279 w Fo(h)p Fq(v)751 311 y Fn(0)771 304 y Fq(;)8 b(v)817
311 y Fn(1)836 304 y Fo(i)p Fp(;)g Ft(map)963 286 y Fn(1)1024
304 y Fo(\))41 b Fq(v)1139 311 y Fn(0)p 1627 322 V 343 364
a Fp(\(14\))p 449 382 V 187 w Fo(h)p Fq(v)659 371 y Fn(0)679
364 y Fq(;)8 b(v)725 371 y Fn(1)744 364 y Fo(i)p Fp(;)g Ft(map)871
346 y Fh(id)903 364 y Fo(f)p Fq(f)d Fo(g)42 b(\))f(h)p Fq(v)1158
371 y Fn(0)1178 364 y Fq(;)8 b(v)1224 371 y Fn(1)1243 364 y
Fo(i)p Fp(;)g Fq(f)p 1627 382 V 343 424 a Fp(\(15\))p 449 442
V 42 w Fo(hh)p Fq(v)533 431 y Fn(0)553 424 y Fq(;)g(v)599 431
y Fn(1)618 424 y Fo(i)p Fq(;)g(v)683 431 y Fn(2)702 424 y Fo(i)p
Fp(;)g Ft(map)829 406 y Ff(\002)859 424 y Fo(f)p Fq(f)s(;)g(g)r
Fo(g)41 b(\))g(hh)p Fq(v)1177 431 y Fn(0)1197 424 y Fq(;)8
b(v)1243 431 y Fn(2)1262 424 y Fo(i)p Fq(;)g Fo(h)p Fq(v)1346
431 y Fn(1)1366 424 y Fq(;)g(v)1412 431 y Fn(2)1431 424 y Fo(ii)p
Fp(;)g Fq(f)18 b Fo(\002)10 b Fq(g)p 1627 442 V 450 444 1179
2 v 531 571 a Ft(T)m(able)i(4:)18 b(Rewrite)12 b(rules)g(for)g(the)g
(\256nite)g(products)150 715 y(selecting)d(one)g(rewrite)f(action)h(is)g
(equivalent)g(to)g(another)f(rewrite)g(action,)i(so)g(long)e(as)i(rewrite)150
805 y(rules)i(are)h(obeyed.)18 b(For)12 b(example,)g(the)h(reduction)409
958 y Fq(w)q Fp(;)8 b Fo(h)p Fq(x;)g Fo(h)p Fq(y)r(;)g(z)r
Fo(ii)p Fp(;)g Fq(P)719 965 y Fn(1)739 958 y Fp(;)g Fq(P)792
965 y Fn(0)1479 958 y Fp(\(6\))854 1048 y Fo(\))14 b(h)p Fq(w)q
Fp(;)8 b Fq(x;)g(w)q Fp(;)g Fo(h)p Fq(y)r(;)g(z)r Fo(ii)p Fp(;)g
Fq(P)1286 1055 y Fn(1)1306 1048 y Fp(;)g Fq(P)1359 1055 y Fn(0)1479
1048 y Fp(\(6\))854 1139 y Fo(\))14 b(h)p Fq(w)q Fp(;)8 b Fq(x;)g
Fo(h)p Fq(w)q Fp(;)g Fq(y)r(;)g(w)q Fp(;)g Fq(z)r Fo(ii)p Fp(;)g
Fq(P)1344 1146 y Fn(1)1364 1139 y Fp(;)g Fq(P)1417 1146 y Fn(0)1479
1139 y Fp(\(3\))854 1229 y Fo(\))14 b(h)p Fq(w)q Fp(;)8 b Fq(y)r(;)g(w)q
Fp(;)g Fq(z)r Fo(i)p Fp(;)g Fq(P)1198 1236 y Fn(0)1479 1229
y Fp(\(2\))854 1319 y Fo(\))14 b Fq(w)q Fp(;)8 b Fq(y)223 1459
y Ft(where)14 b(the)g(numbers)f(to)h(the)g(right)f(of)h(each)g(expression)g
(refer)f(to)h(a)g(rewrite)f(rule)g(in)h(the)150 1549 y(Charity)e(system)h
(can)f(be)h(reduced)f(equivalently)g(by)548 1702 y Fq(w)q Fp(;)c
Fo(h)p Fq(x;)g Fo(h)p Fq(y)r(;)g(z)r Fo(ii)p Fp(;)g Fq(P)858
1709 y Fn(1)878 1702 y Fp(;)g Fq(P)931 1709 y Fn(0)1340 1702
y Fp(\(3\))993 1792 y Fo(\))13 b Fq(w)q Fp(;)8 b Fo(h)p Fq(y)r(;)g(z)r
Fo(i)p Fp(;)g Fq(P)1278 1799 y Fn(0)1340 1792 y Fp(\(2\))993
1882 y Fo(\))13 b Fq(w)q Fp(;)8 b Fq(y)223 2022 y Ft(Clearly)15
b(the)g(\256rst)g(reduction)f(requires)h(fewer)f(steps)i(than)f(the)g
(second.)27 b(However)n(,)16 b(the)150 2112 y(point)d(is)h(that)g(both)g
(reductions)f(obtain)g(the)h(same)g(result)g(no)g(matter)f(what)h(reduction)f
(route)150 2203 y(the)g(system)g(takes.)20 b(A)13 b(rewriting)f(system)h
(simply)g(speci\256es)g(what)g(is)g(to)g(be)g(done,)g(not)g(how)m(.)150
2293 y(The)i(abstract)f(machine)g(presented)g(in)g(the)h(next)f(section)g
(uses)h(rewrite)f(rules)g(to)g(de\256ne)g(the)150 2383 y(order)e(that)g
(Charity)g(expressions)h(are)f(reduced.)963 2700 y(9)p eop
%%Page: 10 17
16 bop 150 203 a Fs(3)72 b(The)17 b(Eager)g(Abstract)g(Machine)150
345 y Ft(The)h(Categorical)f(Abstract)h(Machine)g(\(CAM\)[CCM85)o(])g(is)g
(\252a)f(simple)h(machine)f(where)150 435 y(categorical)f(terms)h(can)g(be)g
(considered)g(as)g(code)g(acting)g(on)g(a)g(graph)f(of)h(values\272.)32
b(Cate-)150 526 y(gorical)16 b(combinators)f(have)h(their)g(foundation)f(in)h
(category)g(theory)f(where)h(composition,)150 616 y(associativity)k(and)h
(identity)e(are)i(the)f(basic)h(tools.)42 b(Composition)19
b(is)i(denoted)f(with)g(the)150 706 y(semicolon)c(\(;\))h(and)f(identity)g
(by)g(\(id\).)28 b(The)17 b(addition)e(of)h(products)g(\(labelled)f
Fo(h)p Fq(x;)8 b(y)r Fo(i)p Ft(\))16 b(and)150 796 y(projections)10
b(\()p Fq(P)430 803 y Fn(0)449 796 y Ft(,)i Fq(P)504 803 y
Fn(1)524 796 y Ft(\))e(yields)g(a)h(Cartesian)f(category)m(.)17
b(The)11 b(idea)f(behind)g(the)g(CAM)h(machine)150 887 y(is)e(that)g
(categorical)g(combinators)g(can)g(be)g(interpreted)f(as)i(the)f(instruction)
f(set)i(in)f(the)g(abstract)150 977 y(machine.)21 b(The)13
b(basic)h(set)g(of)e(state)i(transitions)f(for)f(the)h(Charity)g(system)g
(are)h(derived)e(from)150 1067 y(the)g(CAM)h(machine)f(with)g(the)h(addition)
f(of)g(transitions)g(for)f(the)h(datatypes.)223 1158 y(Evaluating)d
(combinators)e(held)i(in)f(a)g(graph)g(is)h(known)f(as)h(graph)f(reduction)g
(and)g(involves)150 1248 y(three)k(basic)h(steps:[Pey])196
1371 y(1.)24 b(Unwind)12 b(phase)h(\261)f(\256nding)g(the)g(next)h
(reduction.)196 1482 y(2.)24 b(Reduction)13 b(phase)f(\261)h(Reducing)f(a)h
(portion)e(of)h(a)h(graph)e(with)i(an)f(equivalent)g(portion.)196
1593 y(3.)24 b(Update)13 b(phase)f(\261)h(Updating)f(the)g(node)g(with)g(the)
h(reduced)f(portion.)223 1717 y(The)j(primary)e(components)g(of)h(graph)g
(reduction)f(are)h(sharing)g(and)g(updating.)23 b(A)14 b(term)150
1807 y(is)h(said)g(to)g(be)g(shared)f(if)h(it)f(is)h(referenced)f(more)g
(than)h(once)g(on)f(the)h(right)f(hand)h(side)g(of)f(an)150
1898 y(expression.)k(As)13 b(an)g(example,)f(consider)h(the)f(expression)223
1988 y Fq(f)5 b Fp(\()p Fq(x)p Fp(\))14 b(=)g Fq(x)d Fp(+)g
Fq(x)p Ft(,)h(where)g Fq(x)h Ft(is)f(some)h(complicated)f(expression.)223
2078 y(In)18 b(the)g(above)g(expression,)i Fq(x)e Ft(is)g(considered)g(to)g
(be)g(shared)h(since)f(its)g(value)g(will)g(be)150 2168 y(reference)13
b(more)h(than)g(once.)23 b(T)m(o)14 b(enable)g(sharing)g(and)g(avoid)g
(re\261evaluation)f(of)h(a)g(term,)g(it)150 2259 y(is)f(necessary)h(to)e
(overwrite)g(the)h(original)f(term)g(with)g(the)h(evaluated)g(value.)19
b(The)14 b(ar)o(gument)150 2349 y Fq(x)19 b Ft(will)f(be)h(evaluated)g(once)g
(and)f(further)g(references)g(to)h(this)g(ar)o(gument)f(will)g(return)g(the)
150 2439 y(computed)12 b(value)g(of)g Fq(x)p Ft(.)223 2530
y(In)c(addition,)g(terms)g(can)g(be)g(evaluated)g(in)g(a)g(\252lazy\272)g
(fashion)g(where)g(placeholders)g(\(called)950 2700 y(10)p
eop
%%Page: 11 18
17 bop 150 203 a Ft(closures\))14 b(are)h(constructed)f(to)g(suspend)i
(evaluation)e(of)g(terms.)24 b(This)15 b(feature)f(is)h(useful)g(as)150
294 y(it)d(reduces)g(the)h(unnecessary)f(work)g(performed)f(by)h(the)g
(evaluator)m(.)18 b(Consider)12 b(the)g(example)150 384 y(below:)223
474 y Fq(g)r Fp(\()p Fq(x;)c(y)r Fp(\))13 b(=)h Fq(x)p Ft(,)f(where)f
Fq(y)i Ft(is)e(some)h(complex)f(expression.)223 565 y(The)e(purpose)f(of)g
(function)f Fq(g)j Ft(is)f(to)f(return)f(the)h(\256rst)g(ar)o(gument,)h
Fq(x)p Ft(.)17 b(In)9 b(a)g(simple)g(evaluator)n(,)150 655
y(both)f(ar)o(guments)g(are)g(evaluated)g(before)g(the)g(right)g(hand)g(side)
g(of)g(the)g(expression)g(is)g(executed.)150 745 y(As)13 b(a)f(result,)g(the)
g(evaluator)g(performs)f(unnecessary)i(work)e(by)h(evaluating)g(the)g(ar)o
(gument)f Fq(y)150 835 y Ft(which)h(is)g(never)g(used.)19 b(Lazy)13
b(evaluation)f(attempts)g(to)g(avoid)g(these)g(sorts)h(of)e(inef)o
(\256ciencies)150 926 y(by)h(suspending)h(evaluation)f(until)g(necessary)m(.)
223 1016 y(Fundamental)17 b(to)g(the)g(abstract)g(machine)g(are)g(the)h
(state)f(transitions)g(that)g(de\256ne)g(how)150 1106 y(combinators)f(are)h
(reduced.)31 b(When)17 b(reducing)f(a)h(combinator)f(expression,)i(rewrite)e
(rules)150 1197 y(dictates)f(how)h(to)f(reduce)g(the)g(expression)g(but)g
(they)g(do)g(not)g(specify)g(the)g(sequence)h(of)f(the)150
1287 y(reduction.)40 b(Abstract)19 b(machines)h(are)g(more)f(implementation)g
(oriented)g(since)h(the)g(state)150 1377 y(transitions)g(de\256ne)g(the)g
(precise)g(order)f(reductions)h(that)g(need)g(to)g(be)g(performed.)40
b(This)150 1467 y(section)13 b(gives)f(a)h(overview)f(of)g(the)g(state)h
(transitions)f(found)f(in)h([CF92].)150 1652 y Fm(3.1)59 b(State)15
b(transitions)f(of)h(the)g(Charity)f(system)150 1776 y Ft(The)f(eager)f
(abstract)h(machine)f(is)g(a)h(three)f(stack)h(machine)f(consisting)h(of:)208
1899 y Fo(\017)24 b Fr(V)13 b Ft(\261)f(The)h(value)f(stack)h(to)f(hold)g
(computations.)208 2010 y Fo(\017)24 b Fr(C)13 b Ft(\261)f(The)h(code)f
(stack)h(containing)f(the)g(machine)h(code.)208 2121 y Fo(\017)24
b Fr(D)13 b Ft(\261)f(The)h(dump)f(stack)h(to)f(retain)g(partial)g
(computations)223 2245 y(The)f(eager)f(abstract)g(machine)f(performs)g
(reductions)h(on)g(a)g(set)g(of)g(combinators)f(through)150
2335 y(head)18 b(rewriting,)g(that)f(is)h(examining)f(the)h(top)f(of)h(each)g
(stack)g(with)f(pattern)g(matching)g(to)150 2425 y(determine)h(the)h
(appropriate)f(action)h(to)g(select.)39 b(The)20 b(state)f(of)g(the)g
(abstract)g(machine)g(is)150 2516 y(de\256ned)13 b(by)h(the)g(values)g
(contained)f(in)h(each)g(of)f(the)h(three)f(stacks)i(\()p Fq(V)c
Ft(,)j Fq(C)t Ft(,)h Fq(D)q Ft(\))f(at)g(any)f(given)951 2700
y(1)n(1)p eop
%%Page: 12 19
18 bop 150 203 a Ft(time)17 b(\(between)g(reductions\).)32
b(A)18 b(reduction)e(or)h(state)h(transition)f(occurs)g(when)g(the)h(state)
150 294 y(of)f(the)g(machine)g(changes)h(\(ie:)27 b(at)17 b(least)g(one)h(of)
e(the)i(stacks)g(has)f(been)h(modi\256ed\))e(and)h(is)150 384
y(designated)c(by:)688 566 y Fq(V)53 b(C)45 b(D)f Fo(!)d Fq(V)1063
547 y Ff(0)1116 566 y Fq(C)1155 547 y Ff(0)1208 566 y Fq(D)1249
547 y Ff(0)223 725 y Ft(where)17 b(the)g(tuple)g(\()p Fq(V)11
b Ft(,)19 b Fq(C)t Ft(,)f Fq(D)q Ft(\))g(represents)f(the)g(\252before\272)g
(state)g(and)g(\()p Fq(V)1528 707 y Ff(0)1540 725 y Ft(,)i
Fq(C)1610 707 y Ff(0)1621 725 y Ft(,)g Fq(D)1693 707 y Ff(0)1705
725 y Ft(\))e(the)150 815 y(\252after)r(\272)12 b(state.)19
b(For)11 b(example,)i(the)f(transition)g(for)f(the)i(\256rst)f(projection)f
(is)611 968 y Fq(V)161 b(C)92 b(D)135 b(V)1141 950 y Ff(0)1194
968 y Fq(C)1233 950 y Ff(0)1286 968 y Fq(D)1327 950 y Ff(0)p
590 997 770 2 v 611 1060 a Fo(h)p Fq(v)654 1067 y Fn(1)674
1060 y Fq(;)8 b(v)720 1067 y Fn(0)739 1060 y Fo(i)42 b Fq(P)831
1067 y Fn(1)851 1060 y Fq(:c)f(d)58 b Fo(!)42 b Fq(v)1126 1067
y Fn(1)1194 1060 y Fq(c)71 b(d)223 1200 y Ft(In)12 b(the)f(\252before\272)h
(state,)h(the)f(value)f(stack)i Fq(V)23 b Ft(holds)12 b(a)g(pair)f(and)h(the)
g(head)g(code)g(stack)h(has)150 1290 y(the)i(instruction)f
Fq(P)485 1297 y Fn(1)505 1290 y Ft(.)26 b(The)15 b(above)g(transition)f
(modi\256es)g(the)h(value)g(stack)g(and)g(discards)g(the)150
1380 y(instruction)d(on)h(the)g(code)g(stack)h(to)f(bring)f(the)h(machine)g
(to)g(the)g(\252after)r(\272)f(state.)21 b(In)13 b(this)g(case,)150
1471 y(the)j(dump)f(remains)h(unchanged)g(and)g(the)g(machine)f(carries)h(on)
g(execution)g(with)f(the)h(new)150 1561 y(\252after)r(\272)h(state.)35
b(Evaluation)17 b(is)h(considered)g(complete)f(when)g(the)h(code)g(stack)g
(and)g(dump)150 1651 y(stack)13 b(are)f(empty)g(and)g(the)h(result)f(has)h
(been)f(left)g(on)g(the)h(value)f(stack.)223 1742 y(The)g(state)f
(transitions)g(are)g(derived)f(from)g(the)h(rewrite)f(rules)h(presented)g(in)
g(the)f(previous)150 1832 y(section.)33 b(A)17 b(few)g(extra)g(transitions)g
(are)g(included)g(to)g(deal)g(with)g(administration)f(details.)150
1922 y(T)n(ransition)f(1)h(is)f(the)h(terminal)e(transition)g(that)i(resets)f
(the)h Fq(V)26 b Ft(stack.)i(T)n(ransitions)16 b(2)f(and)g(3)150
2012 y(are)d(the)g(projections)f(of)g(a)h(pair)g(while)f(transitions)h(4)g
(and)g(5)f(are)h(the)g(co\261projections.)18 b(A)12 b(pair)150
2103 y(structure)f(is)h(built)g(by)f(transitions)h(6)g(to)f(8.)18
b(T)n(ransition)12 b(9)g(handles)g(the)g(combinators)f(such)i(as)150
2193 y(constructors)f(and)g(in\256nite)g(datatype)g(operators)g(where)g(no)g
(action)h(is)f(performed.)223 2283 y(Several)g(of)g(the)h(transitions)f(have)
g(been)h(modi\256ed)e(to)i(better)f(represent)g(the)g(state)h(of)f(the)150
2374 y(machine.)27 b(Note)15 b(in)g(the)h(transition)e(tables)i(how)f(all)g
(items)h(placed)f(on)g(the)h Fq(V)26 b Ft(stack)16 b(are)f(in)150
2464 y(reverse)c(order)m(.)17 b(The)12 b(reason)f(for)f(reversing)h(the)g
(order)f(is)i(make)f(the)g(last)g(item)g(placed)g(on)g(the)150
2554 y(stack)i(immediately)e(accessible)j(to)e(the)g(next)g(transition.)950
2700 y(12)p eop
%%Page: 13 20
19 bop 181 263 1588 2 v 180 323 2 61 v 271 323 V 292 305 a
Ft(value)135 b(code)124 b(dump)196 b Fo(!)42 b Ft(value)81
b(code)41 b(dump)p 1768 323 V 181 325 1588 2 v 180 385 2 61
v 214 367 a Fp(1)p 271 385 V 54 w Fq(v)219 b Fp(!)p Fq(:c)169
b(d)285 b Fo(!)42 b Fp(!)175 b Fq(c)114 b(d)p 1768 385 V 180
445 V 214 427 a Fp(2)p 271 445 V 54 w Fo(h)p Fq(v)335 434 y
Fn(1)355 427 y Fq(;)8 b(v)401 434 y Fn(0)420 427 y Fo(i)96
b Fq(P)566 434 y Fn(0)586 427 y Fq(:c)132 b(d)285 b Fo(!)42
b Fq(v)1179 434 y Fn(0)1344 427 y Fq(c)114 b(d)p 1768 445 V
180 506 V 214 488 a Fp(3)p 271 506 V 54 w Fo(h)p Fq(v)335 495
y Fn(1)355 488 y Fq(;)8 b(v)401 495 y Fn(0)420 488 y Fo(i)96
b Fq(P)566 495 y Fn(1)586 488 y Fq(:c)132 b(d)285 b Fo(!)42
b Fq(v)1179 495 y Fn(1)1344 488 y Fq(c)114 b(d)p 1768 506 V
180 566 V 214 548 a Fp(4)p 271 566 V 54 w Fo(h)p Fq(v)335 555
y Fn(1)355 548 y Fq(;)8 b(v)401 555 y Fn(0)420 548 y Fq(:b)455
555 y Fn(0)474 548 y Fo(i)42 b(h)p Fq(c)575 555 y Fn(0)595
548 y Fo(j)p Fq(c)630 555 y Fn(1)650 548 y Fo(i)p Fq(:c)49
b(d)285 b Fo(!)42 b(h)p Fq(v)1198 555 y Fn(1)1217 548 y Fq(;)8
b(v)1263 555 y Fn(0)1283 548 y Fo(i)42 b Fq(c)1365 555 y Fn(0)1479
548 y Fq(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p 1768 566 V 180
626 V 214 608 a Fp(5)p 271 626 V 54 w Fo(h)p Fq(v)335 615 y
Fn(1)355 608 y Fq(;)8 b(v)401 615 y Fn(0)420 608 y Fq(:b)455
615 y Fn(1)474 608 y Fo(i)42 b(h)p Fq(c)575 615 y Fn(0)595
608 y Fo(j)p Fq(c)630 615 y Fn(1)650 608 y Fo(i)p Fq(:c)49
b(d)285 b Fo(!)42 b(h)p Fq(v)1198 615 y Fn(1)1217 608 y Fq(;)8
b(v)1263 615 y Fn(0)1283 608 y Fo(i)42 b Fq(c)1365 615 y Fn(1)1479
608 y Fq(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p 1768 626 V 180
686 V 214 668 a Fp(6)p 271 686 V 54 w Fq(v)219 b Fo(h)p Fq(c)575
675 y Fn(0)595 668 y Fq(;)8 b(c)638 675 y Fn(1)658 668 y Fo(i)p
Fq(:c)41 b(d)285 b Fo(!)42 b Fq(v)165 b(c)1365 675 y Fn(1)1479
668 y Ft(pr)1521 681 y Fn(0)1540 668 y Fp(\()p Fq(v)r(;)8 b(c)1628
675 y Fn(0)1647 668 y Fq(;)g(c)p Fp(\))p Fq(:d)p 1768 686 V
180 746 V 214 728 a Fp(7)p 271 746 V 54 w Fq(v)316 735 y Fn(1)535
728 y Fp([)g(])182 b Ft(pr)795 741 y Fn(0)814 728 y Fp(\()p
Fq(v)r(;)8 b(c)902 735 y Fn(0)921 728 y Fq(;)g(c)p Fp(\))p
Fq(:d)41 b Fo(!)h Fq(v)165 b(c)1365 735 y Fn(0)1479 728 y Ft(pr)1521
741 y Fn(1)1540 728 y Fp(\()p Fq(v)1583 735 y Fn(1)1603 728
y Fq(;)8 b(c)p Fp(\))p Fq(:d)p 1768 746 V 180 807 V 214 789
a Fp(8)p 271 807 V 54 w Fq(v)316 796 y Fn(0)535 789 y Fp([)g(])182
b Ft(pr)795 801 y Fn(1)814 789 y Fp(\()p Fq(v)857 796 y Fn(1)877
789 y Fq(;)8 b(c)p Fp(\))p Fq(:d)85 b Fo(!)42 b(h)p Fq(v)1198
796 y Fn(1)1217 789 y Fq(;)8 b(v)1263 796 y Fn(0)1283 789 y
Fo(i)42 b Fq(c)114 b(d)p 1768 807 V 180 867 V 214 849 a Fp(9)p
271 867 V 54 w Fq(v)219 b(u:c)155 b(d)285 b Fo(!)42 b Fq(u:v)123
b(c)114 b(d)p 1768 867 V 180 927 V 202 909 a Fp(10)p 271 927
V 42 w Fq(v)219 b Fp([)8 b(])182 b Fq(c)p Fp(\()p Fq(c)p Fp(\))p
Fq(:d)191 b Fo(!)42 b Fq(v)165 b(c)114 b(d)p 1768 927 V 180
987 V 202 969 a Fp(11)p 271 987 V 42 w Fq(v)219 b Fp([)8 b(])182
b([)8 b(])274 b Fo(!)42 b Ft(HAL)-5 b(T)p 1768 987 V 181 989
1588 2 v 429 1118 a(T)m(able)12 b(5:)18 b(State)12 b(transition)g(rules)g
(for)g(the)g(basic)h(instructions)223 1251 y(The)g(datatype)f(transitions)g
(associated)h(with)f(the)g(rewrite)f(rules)h(are)h(handled)f(by)g(transi-)150
1342 y(tions)e(12)f(\261)h(14)f(for)g(the)g(\256nite)g(datatypes)h(and)g
(transitions)f(15)g(\261)h(17)f(for)g(the)h(in\256nite)e(datatypes.)150
1432 y(Finally)k(map)g(transitions)g(are)g(presented)g(in)h(T)m(able)f(7)g
(with)g(transitions)g(18)h(\261)f(20.)950 2700 y(13)p eop
%%Page: 14 21
20 bop 150 2575 a
gsave currentpoint currentpoint translate 270 rotate neg exch neg exch
translate
 150 3050 2581 2 v 149 3111 2 61 v 239 3111
V 261 3093 a Ft(value)382 b(code)352 b(dump)41 b Fo(!)g Ft(value)81
b(code)399 b(dump)p 2730 3111 V 150 3112 2581 2 v 149 3173
2 61 v 171 3154 a Fp(12)p 239 3173 V 42 w Fo(h)p Fq(v)304 3161
y Fn(1)324 3154 y Fq(;)8 b(v)370 3161 y Fn(0)389 3154 y Fq(:c)424
3161 y Fh(i)437 3154 y Fo(i)295 b Ft(case)836 3136 y Fh(L)863
3154 y Fo(f)p Fq(f)912 3161 y Fn(1)931 3154 y Fq(;)8 b(:)g(:)g(:)g(;)g(f)1065
3161 y Fh(n)1088 3154 y Fo(g)p Fq(:c)49 b(d)130 b Fo(!)41 b(h)p
Fq(v)1486 3161 y Fn(1)1506 3154 y Fq(;)8 b(v)1552 3161 y Fn(0)1571
3154 y Fo(i)42 b Fq(f)1656 3161 y Fh(i)2125 3154 y Fq(c)p Fp(\()p
Fq(c)p Fp(\))p Fq(:d)p 2730 3173 V 149 3234 2 62 v 171 3216
a Fp(13)p 239 3234 V 42 w Fo(h)p Fq(v)304 3223 y Fn(1)324 3216
y Fq(;)8 b(v)370 3223 y Fn(0)389 3216 y Fq(:c)424 3223 y Fh(i)437
3216 y Fo(i)295 b Ft(fold)831 3195 y Fh(L)857 3216 y Fo(f)p
Fq(g)905 3223 y Fn(1)925 3216 y Fq(;)8 b(:)g(:)g(:)f(;)h(g)1057
3223 y Fh(n)1081 3216 y Fo(g)p Fq(:c)56 b(d)130 b Fo(!)41 b(h)p
Fq(v)1486 3223 y Fn(1)1506 3216 y Fq(;)8 b(v)1552 3223 y Fn(0)1571
3216 y Fo(i)42 b Ft(map)1718 3198 y Fh(E)1744 3203 y Fg(i)1759
3216 y Fo(f)p Fq(P)1815 3223 y Fn(0)1835 3216 y Fq(;)276 b
Ft(pr)2166 3229 y Fn(1)2186 3216 y Fp(\()p Fq(v)r Fp(1)p Fq(;)8
b(g)2300 3223 y Fh(i)2314 3216 y Fp(\))p Fq(:c)p Fp(\()p Fq(c)p
Fp(\))p Fq(:d)p 2730 3234 V 149 3295 V 239 3295 V 1632 3277
a Ft(fold)1712 3256 y Fh(L)1738 3277 y Fo(f)p Fq(g)1786 3284
y Fn(1)1806 3277 y Fq(;)g(:)g(:)g(:)g(;)g(g)1939 3284 y Fh(n)1962
3277 y Fo(gg)p 2730 3295 V 149 3355 2 61 v 171 3337 a Fp(14)p
239 3355 V 42 w Fo(h)p Fq(v)304 3344 y Fn(1)324 3337 y Fq(;)g(v)370
3344 y Fn(0)389 3337 y Fq(:c)424 3344 y Fh(i)437 3337 y Fo(i)295
b Ft(map)837 3319 y Fh(L)863 3337 y Fo(f)p Fq(h)916 3344 y
Fn(1)935 3337 y Fq(;)8 b(:)g(:)g(:)g(;)g(h)1073 3344 y Fh(n)1096
3337 y Fo(g)p Fq(:c)41 b(d)130 b Fo(!)41 b(h)p Fq(v)1486 3344
y Fn(1)1506 3337 y Fq(;)8 b(v)1552 3344 y Fn(0)1571 3337 y
Fo(i)42 b Ft(map)1718 3319 y Fh(E)1744 3324 y Fg(i)1759 3337
y Fo(f)p Fq(h)1812 3344 y Fn(1)1832 3337 y Fq(;)8 b(:)g(:)g(:)f(;)h(h)1969
3344 y Fh(n)1992 3337 y Fq(;)119 b(c)p Fp(\()p Fq(c)p Fp(\))p
Fq(:d)p 2730 3355 V 149 3415 V 239 3415 V 1632 3397 a Ft(map)1718
3379 y Fh(L)1744 3397 y Fo(f)p Fq(h)1797 3404 y Fn(1)1817 3397
y Fq(;)8 b(:)g(:)g(:)f(;)h(h)1954 3404 y Fh(n)1977 3397 y Fo(gg)p
Fq(:c)2062 3404 y Fh(i)p 2730 3415 V 149 3477 2 62 v 171 3459
a Fp(15)p 239 3477 V 42 w Fq(v)r(:)p Ft(unfold)430 3438 y Fh(R)459
3459 y Fo(f)p Fq(f)508 3466 y Fn(1)528 3459 y Fq(;)g(:)g(:)g(:)f(;)h(f)661
3466 y Fh(n)684 3459 y Fo(g)42 b Fq(d)776 3466 y Fh(i)790 3459
y Fq(:c)372 b(d)130 b Fo(!)41 b Fq(v)165 b(f)1656 3466 y Fh(i)2125
3459 y Ft(pr)2166 3471 y Fn(1)2186 3459 y Fp(\()p Fq(v)r(;)8
b Ft(map)2338 3441 y Fh(F)2360 3446 y Fg(i)2375 3459 y Fo(f)p
Fq(P)2431 3466 y Fn(0)2451 3459 y Fq(;)p 2730 3477 V 149 3538
V 239 3538 V 2125 3520 a Ft(unfold)2255 3499 y Fh(R)2283 3520
y Fo(f)p Fq(f)2332 3527 y Fn(1)2352 3520 y Fq(;)g(:)g(:)g(:)g(;)g(f)2486
3527 y Fh(n)2509 3520 y Fo(gg)p Fp(\))p Fq(:c)p Fp(\()p Fq(c)p
Fp(\))p Fq(:d)p 2730 3538 V 149 3598 2 61 v 171 3580 a Fp(16)p
239 3598 V 42 w Fq(v)r(:)p Ft(case)386 3562 y Fh(R)415 3580
y Fo(f)p Fq(g)463 3587 y Fn(1)483 3580 y Fq(;)g(:)g(:)g(:)f(;)h(g)615
3587 y Fh(n)639 3580 y Fo(g)87 b Fq(d)776 3587 y Fh(i)790 3580
y Fq(:c)372 b(d)130 b Fo(!)41 b Fq(v)165 b(g)1655 3587 y Fh(i)2125
3580 y Fq(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p 2730 3598 V 149
3658 V 171 3640 a Fp(17)p 239 3658 V 42 w Fq(v)r(:)p Ft(map)386
3622 y Fh(R)415 3640 y Fo(f)p Fq(h)468 3647 y Fn(1)487 3640
y Fq(;)8 b(:)g(:)g(:)g(;)g(h)625 3647 y Fh(n)648 3640 y Fo(g)78
b Fq(d)776 3647 y Fh(i)790 3640 y Fq(:c)372 b(d)130 b Fo(!)41
b Fq(v)165 b Ft(map)1718 3622 y Fh(E)1744 3627 y Fg(i)1759
3640 y Fo(f)p Fq(h)1812 3647 y Fn(1)1832 3640 y Fq(;)8 b(:)g(:)g(:)f(;)h(h)
1969 3647 y Fh(m)2002 3640 y Fq(;)109 b(c)p Fp(\()p Fq(c)p
Fp(\))p Fq(:d)p 2730 3658 V 149 3718 V 239 3718 V 1632 3700
a Ft(map)1718 3682 y Fh(R)1747 3700 y Fo(f)p Fq(h)1800 3707
y Fn(1)1819 3700 y Fq(;)8 b(:)g(:)g(:)g(;)g(h)1957 3707 y Fh(n)1980
3700 y Fo(gg)p Fq(:d)2069 3707 y Fh(i)p 2730 3718 V 150 3720
2581 2 v 894 3849 a Ft(T)m(able)13 b(6:)k(State)c(transition)e(rules)i(for)e
(the)h(datatypes)150 2575 y
currentpoint grestore moveto
 950 2700 a Ft(14)p eop
%%Page: 15 22
21 bop 150 2575 a
gsave currentpoint currentpoint translate 270 rotate neg exch neg exch
translate
 518 3263 1687 2 v 517 3323 2 61 v 607 3323
V 629 3305 a Ft(value)184 b(code)221 b(dump)41 b Fo(!)h Ft(value)80
b(code)42 b(dump)p 2203 3323 V 518 3325 1687 2 v 517 3385 2
61 v 539 3367 a Fp(18)p 607 3385 V 42 w Fo(h)p Fq(v)672 3374
y Fn(1)691 3367 y Fq(;)8 b(v)737 3374 y Fn(0)757 3367 y Fo(i)145
b Ft(map)1007 3349 y Fn(1)1027 3367 y Fq(:c)174 b(d)222 b(v)1507
3374 y Fn(0)1671 3367 y Fq(c)115 b(d)p 2203 3385 V 517 3446
V 539 3427 a Fp(19)p 607 3446 V 42 w Fq(v)268 b Ft(map)1007
3409 y Fh(id)1039 3427 y Fo(f)p Fq(f)5 b Fo(g)p Fq(:c)83 b(d)130
b Fo(!)42 b Fq(v)164 b(f)112 b(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p
2203 3446 V 517 3506 V 539 3488 a Fp(20)p 607 3506 V 42 w Fo(hh)p
Fq(v)691 3495 y Fn(1)711 3488 y Fq(;)8 b(v)757 3495 y Fn(0)776
3488 y Fo(i)p Fq(;)g(v)841 3495 y Fn(2)861 3488 y Fo(i)41 b
Ft(map)1007 3470 y Ff(\002)1037 3488 y Fo(f)p Fq(f)s(;)8 b(g)r
Fo(g)p Fq(:c)40 b(d)222 b Fo(h)p Fq(v)1526 3495 y Fn(2)1545
3488 y Fq(;)8 b(v)1591 3495 y Fn(1)1610 3488 y Fo(i)42 b Fq(g)113
b Ft(pr)1848 3500 y Fn(0)1868 3488 y Fp(\()p Fo(h)p Fq(v)1930
3495 y Fn(2)1950 3488 y Fq(;)8 b(v)1996 3495 y Fn(0)2015 3488
y Fo(i)p Fq(;)g(f)s(;)g(c)p Fp(\))p Fq(:d)p 2203 3506 V 518
3507 1687 2 v 874 3636 a Ft(T)m(able)k(7:)18 b(State)12 b(transition)f(rules)
i(for)e(\256nite)h(datatypes)150 2575 y
currentpoint grestore moveto
 950 2700 a Ft(15)p
eop
%%Page: 16 23
22 bop 223 203 a Ft(Recall)13 b(the)f(combinator)g(expression)223
294 y Fq(w)q Fp(;)c Fo(h)p Fq(x;)g Fo(h)p Fq(y)r(;)g(z)r Fo(ii)p
Fp(;)g Fq(P)533 301 y Fn(1)554 294 y Fp(;)g Fq(P)607 301 y
Fn(0)223 384 y Ft(from)19 b(Section)h(2.)41 b(In)20 b(a)g(rewrite)f(system,)k
(there)c(may)h(be)g(more)g(than)g(one)g(route)f(in)150 474
y(reducing)14 b(a)h(categorical)f(combinator)f(expression.)25
b(In)14 b(this)g(section,)i(the)f(state)f(transitions)150 565
y(of)h(the)g(abstract)g(machine)f(specify)h(exactly)g(one)g(route)g(when)g
(reducing)f(an)h(expression)g(to)150 655 y(normal)10 b(form.)17
b(T)m(able)10 b(8)h(illustrates)f(a)h(how)g(the)f(above)h(categorical)f
(combinator)g(expression)150 745 y(is)g(reduced)f(by)g(the)h(eager)f
(abstract)g(machine.)18 b(The)10 b(numbers)f(to)g(the)g(right)g(of)g(each)h
(reduction)150 835 y(correspond)15 b(to)g(the)h(state)g(transitions)f(of)g
(the)h(abstract)f(machine)h(found)e(in)i(T)m(ables)g(5)f(to)h(7.)150
926 y(Note)h(that)g(the)g(answer)g(is)g(in)g(reverse)g(order)m(.)32
b(When)17 b(the)g(result)g(is)g(converted)f(back)h(into)150
1016 y(categorical)12 b(combinators,)g(the)g(correct)g(order)g(is)g
(restored.)p 150 1194 1664 2 v 262 1237 a(V)354 b(C)412 b(D)p
150 1256 V 652 1298 a Fq(w)q Fp(;)8 b Fo(h)p Fq(x;)g Fo(h)p
Fq(y)r(;)g(z)r Fo(ii)p Fp(;)g Fq(P)962 1305 y Fn(1)983 1298
y Fp(;)g Fq(P)1036 1305 y Fn(0)1706 1298 y Fp(\(20\))171 1359
y Fo(\))41 b Fq(w)355 b Fo(h)p Fq(x;)8 b Fo(h)p Fq(y)r(;)g(z)r
Fo(ii)p Fp(;)g Fq(P)904 1366 y Fn(1)925 1359 y Fp(;)g Fq(P)978
1366 y Fn(0)1706 1359 y Fp(\(6\))171 1419 y Fo(\))41 b Fq(w)355
b Fo(h)p Fq(y)r(;)8 b(z)r Fo(i)334 b Ft(pr)1139 1432 y Fn(0)1158
1419 y Fp(\()p Fq(w)q(;)8 b(x;)g(P)1316 1426 y Fn(1)1336 1419
y Fp(;)g Fq(P)1389 1426 y Fn(0)1409 1419 y Fp(\))278 b(\(6\))171
1479 y Fo(\))41 b Fq(w)355 b(z)422 b Ft(pr)1139 1492 y Fn(0)1158
1479 y Fp(\()p Fq(w)q(;)8 b(y)r(;)p 1286 1479 15 2 v 26 w Fp(\))p
Fq(:)p Ft(pr)1375 1492 y Fn(0)1394 1479 y Fp(\()p Fq(w)q(;)g(x;)g(P)1552
1486 y Fn(1)1572 1479 y Fp(;)g Fq(P)1625 1486 y Fn(0)1645 1479
y Fp(\))42 b(\(9\))171 1539 y Fo(\))f Fq(z)r(:w)761 b Ft(pr)1139
1552 y Fn(0)1158 1539 y Fp(\()p Fq(w)q(;)8 b(y)r(;)p 1286 1539
V 26 w Fp(\))p Fq(:)p Ft(pr)1375 1552 y Fn(0)1394 1539 y Fp(\()p
Fq(w)q(;)g(x;)g(P)1552 1546 y Fn(1)1572 1539 y Fp(;)g Fq(P)1625
1546 y Fn(0)1645 1539 y Fp(\))42 b(\(7\))171 1599 y Fo(\))f
Fq(w)355 b(y)421 b Ft(pr)1139 1612 y Fn(1)1158 1599 y Fp(\()p
Fq(z)r(:w)q(;)p 1277 1599 V 26 w Fp(\))p Fq(:)p Ft(pr)1366
1612 y Fn(0)1385 1599 y Fp(\()p Fq(w)q(;)8 b(x;)g(P)1543 1606
y Fn(1)1563 1599 y Fp(;)g Fq(P)1616 1606 y Fn(0)1636 1599 y
Fp(\))51 b(\(9\))171 1660 y Fo(\))41 b Fq(y)r(:w)760 b Ft(pr)1139
1672 y Fn(1)1158 1660 y Fp(\()p Fq(z)r(:w)q(;)p 1277 1660 V
26 w Fp(\))p Fq(:)p Ft(pr)1366 1672 y Fn(0)1385 1660 y Fp(\()p
Fq(w)q(;)8 b(x;)g(P)1543 1667 y Fn(1)1563 1660 y Fp(;)g Fq(P)1616
1667 y Fn(0)1636 1660 y Fp(\))51 b(\(8\))171 1720 y Fo(\))41
b(h)p Fq(z)r(:w)q(;)8 b(y)r(:w)q Fo(i)624 b Ft(pr)1139 1733
y Fn(0)1158 1720 y Fp(\()p Fq(w)q(;)8 b(x;)g(P)1316 1727 y
Fn(1)1336 1720 y Fp(;)g Fq(P)1389 1727 y Fn(0)1409 1720 y Fp(\))278
b(\(7\))171 1780 y Fo(\))41 b Fq(w)355 b(x)417 b Ft(pr)1139
1793 y Fn(1)1158 1780 y Fp(\()p Fo(h)p Fq(z)r(:w)q(;)8 b(y)r(:w)q
Fo(i)p Fq(;)g(P)1441 1787 y Fn(1)1461 1780 y Fp(;)g Fq(P)1514
1787 y Fn(0)1534 1780 y Fp(\))153 b(\(9\))171 1840 y Fo(\))41
b Fq(x:w)758 b Ft(pr)1139 1853 y Fn(1)1158 1840 y Fp(\()p Fo(h)p
Fq(z)r(:w)q(;)8 b(y)r(:w)q Fo(i)p Fq(;)g(P)1441 1847 y Fn(1)1461
1840 y Fp(;)g Fq(P)1514 1847 y Fn(0)1534 1840 y Fp(\))153 b(\(8\))171
1900 y Fo(\))41 b(hh)p Fq(z)r(:w)q(;)8 b(y)r(:w)q Fo(i)p Fq(;)g(x:w)q
Fo(i)41 b Fq(P)683 1907 y Fn(1)703 1900 y Fp(;)8 b Fq(P)756
1907 y Fn(0)1706 1900 y Fp(\(3\))171 1961 y Fo(\))41 b(h)p
Fq(z)r(:w)q(;)8 b(y)r(:w)q Fo(i)179 b Fq(P)683 1968 y Fn(0)1706
1961 y Fp(\(2\))171 2021 y Fo(\))41 b Fq(y)r(:w)266 2168 y
Ft(T)m(able)13 b(8:)k(Reducing)c(a)f(Combinator)g(Expression)h(with)f(an)g
(Abstract)g(Machine)950 2700 y(16)p eop
%%Page: 17 24
23 bop 150 203 a Fs(4)72 b(The)17 b(Macr)o(o\261coded)f(Machine)150
345 y Ft(Having)8 b(speci\256ed)g(the)g(Charity)g(system)g(in)g(the)g
(previous)g(section,)i(this)e(paper)g(now)g(describes)150 435
y(the)k(implementation.)223 526 y(The)19 b(implementation)f(of)g(the)h
(Charity)f(system)h(is)g(divided)g(into)f(two)g(levels,)k(macro)150
616 y(and)e(micro.)39 b(At)20 b(the)f(macro)h(level,)i(macro\261instructions)
c(replace)i(the)f(state)h(transitions)150 706 y(of)c(the)g(eager)h(abstract)f
(machine)h(while)f(micro\261instructions)f(perform)g(stack)i(operations.)150
796 y(According)e(the)h(Hannan)h([Han91)o(],)g(abstract)f(machines)h(are)f
(\252abstract\272)g(because)h(pattern)150 887 y(matching)k(is)h(used)f
(extensively)h(in)f(the)g(construction)g(and)g(destruction)g(of)g(data.)46
b(The)150 977 y(construction)17 b(and)g(destruction)g(of)h(data)f(refers)g
(to)g(how)h(data)f(structures)h(are)f(build)g(from)150 1067
y(atomic)f(components)h(and)f(divided)g(into)g(atomic)h(components,)g
(respectively)m(.)31 b(Hannan')m(s)150 1158 y(approach)21 b(is)g(to)g(use)h
(macro\261instructions)e(as)i(identi\256ers)e(that)h(specify)g(the)g(action)g
(and)150 1248 y(micro\261instructions)11 b(to)h(perform)f(the)h(action.)223
1338 y(The)19 b(bene\256t)f(of)g(this)g(using)h(Hannan')m(s)f(technique)g(is)
h(the)f(natural)g(separation)g(of)g(the)150 1428 y(implementation)f(into)g
(distinct)h(and)g(modular)f(segments)i(making)e(system)i(development)150
1519 y(a)d(cleaner)g(process.)30 b(In)16 b(addition,)h(debugging)f(is)g
(considerably)g(easier)g(with)g(a)g(two)g(level)150 1609 y(approach.)150
1794 y Fm(4.1)59 b(The)15 b(Macr)o(o\261instructions)e(set)223
1917 y Ft(T)m(able)c(9)f(de\256nes)h(the)g(basic)g(macro\261instructions,)f
(T)m(able)h(10)f(and)h(T)m(able)g(1)n(1)f(the)h(datatypes)150
2008 y(and)k(T)m(able)h(12)f(the)g(administration)g(instructions.)21
b(The)14 b(\256rst)f(column)g(in)g(the)g(tables)h(are)f(the)150
2098 y(macro\261instruction)j(identi\256ers)h(followed)g(by)g(an)h(optional)f
(ar)o(gument)g(list.)34 b(The)18 b(second)150 2188 y(column)f(is)i(a)f(brief)
f(description)h(of)f(the)h(macro\261instruction)f(and)h(column)f(three)h
(gives)g(a)150 2279 y(reference)10 b(to)g(the)h(stat)g(transition)f(number)g
(from)f(the)i(tables)g(\(T)m(able)f(1)g(to)h(T)m(able)g(4\))f(in)g(the)h
(last)150 2369 y(section.)19 b(For)11 b(example,)i(in)f(T)m(able)g(9)h(the)f
(macro)g(code)h(for:)248 2465 y(map)p 337 2465 15 2 v 18 w(prod)p
Fo(f)p Fq(f)s(;)8 b(g)r Fo(g)48 b Ft(Map)13 b(Product)49 b(\(20\))223
2549 y(means)14 b(that)g(the)g(map)p 617 2549 V 17 w(prod)f(macro)h
(instruction)f(takes)h(two)f(ar)o(guments)h(\()p Fq(f)19 b
Ft(and)13 b Fq(g)r Ft(\))h(and)950 2700 y(17)p eop
%%Page: 18 25
24 bop 376 155 1199 2 v 375 215 2 61 v 401 197 a Ft(TERMINAL)55
b(The)13 b(terminal)f(combinator)270 b(\(1\))p 1573 215 V 375
276 V 401 258 a(ID)254 b(Identity)11 b(combinator)p 1573 276
V 375 336 V 401 318 a(P0)254 b(First)12 b(projection)464 b(\(2\))p
1573 336 V 375 396 V 401 378 a(P1)254 b(Second)12 b(projection)409
b(\(3\))p 1573 396 V 375 456 V 401 438 a(P)-5 b(AIR)198 b(Evaluation)12
b(of)g(the)h(\256rst)f(projection)122 b(\(6\))p 1573 456 V
375 516 V 401 498 a(PR0)221 b(Evaluation)12 b(of)g(the)h(second)f(projection)
62 b(\(7\))p 1573 516 V 375 577 V 401 559 a(PR1)221 b(Recreate)13
b(the)f(pair)g(structure)246 b(\(8\))p 1573 577 V 375 637 V
401 619 a(CONS)174 b(Constructors)516 b(\(9\))p 1573 637 V
375 697 V 401 679 a(CONT)172 b(Resume)13 b(execution)391 b(\(10\))p
1573 697 V 376 699 1199 2 v 439 832 a(T)m(able)13 b(9:)k(Macro)c
(instructions)f(for)f(the)i(basic)f(combinators)p 352 947 1246
2 v 351 1007 2 61 v 377 989 a(CASE)h Fo(f)p Fq(f)566 996 y
Fn(1)586 989 y Fq(;)8 b(:)g(:)g(:)f(;)h(f)719 996 y Fh(n)742
989 y Fo(g)299 b Ft(Function)12 b(selection)57 b(\(12\))p 1597
1007 V 351 1067 V 377 1049 a(FOLD)13 b Fo(f)p Fq(f)569 1056
y Fn(1)588 1049 y Fq(;)8 b(:)g(:)g(:)g(;)g(f)722 1056 y Fh(n)745
1049 y Fq(;)g(s)790 1056 y Fn(1)810 1049 y Fq(;)g(:)g(:)g(:)f(;)h(s)942
1056 y Fh(n)965 1049 y Fo(g)76 b Ft(Fold)12 b(over)g(datatype)50
b(\(13\))p 1597 1067 V 351 1127 V 377 1109 a(MAP)p 488 1109
15 2 v 18 w(L)13 b Fo(f)p Fq(f)595 1116 y Fn(1)615 1109 y Fq(;)8
b(:)g(:)g(:)f(;)h(f)748 1116 y Fh(n)771 1109 y Fq(;)g(s)816
1116 y Fn(1)836 1109 y Fq(;)g(:)g(:)g(:)f(;)h(s)968 1116 y
Fh(n)992 1109 y Fo(g)49 b Ft(Map)13 b(over)f(datatype)50 b(\(14\))p
1597 1127 2 61 v 352 1129 1246 2 v 456 1262 a(T)m(able)12 b(10:)18
b(Macro)12 b(instructions)g(for)g(the)g(\256nite)g(datatypes)150
1406 y(is)j(based)g(on)f(state)h(transition)e(rule)h(\(20\))g(in)g(T)m(able)g
(4.)25 b(Much)14 b(of)g(the)h(detail)f(about)g(how)g(the)150
1496 y(macro\261code)c(operates)h(has)g(been)g(omitted.)17
b(At)11 b(this)g(level,)g(the)g(focus)g(is)g(on)f(de\256ning)g(all)h(the)150
1586 y(macro\261instructions)i(that)h(make)g(up)f(the)h(abstract)g(machine.)
23 b(The)15 b(micro\261code)e(described)150 1677 y(in)e(the)g(next)g(section)
h(will)e(de\256ne)h(the)h(speci\256c)f(actions)g(each)h(macro\261instruction)
e(performs.)p 228 2249 1495 2 v 227 2309 2 61 v 253 2291 a(UNFOLD)i
Fo(f)p Fq(f)516 2298 y Fn(1)536 2291 y Fq(;)c(:)g(:)g(:)f(;)h(f)669
2298 y Fh(n)693 2291 y Fq(;)g(s)738 2298 y Fn(1)757 2291 y
Fq(;)g(:)g(:)g(:)g(;)g(s)890 2298 y Fh(n)913 2291 y Fo(g)50
b Ft(Unfold)11 b(over)h(in\256nite)g(datatype)49 b(\(15\))p
1721 2309 V 227 2370 V 253 2351 a(RECORD)13 b Fo(f)p Fq(f)516
2358 y Fn(1)536 2351 y Fq(;)8 b(:)g(:)g(:)f(;)h(f)669 2358
y Fh(n)693 2351 y Fo(g)270 b Ft(In\256nite)11 b(datatype)h(record)161
b(\(16\))p 1721 2370 V 227 2430 V 253 2412 a(MAP)p 364 2412
15 2 v 18 w(R)12 b Fo(f)p Fq(f)473 2419 y Fn(1)493 2412 y Fq(;)c(:)g(:)g(:)f
(;)h(f)626 2419 y Fh(n)650 2412 y Fq(;)g(s)695 2419 y Fn(1)714
2412 y Fq(;)g(:)g(:)g(:)g(;)g(s)847 2419 y Fh(n)870 2412 y
Fo(g)93 b Ft(In\256nite)11 b(datatype)h(map)203 b(\(17\))p
1721 2430 2 61 v 228 2431 1495 2 v 437 2565 a(T)m(able)13 b(1)n(1:)18
b(Macro)12 b(instructions)g(for)g(the)g(in\256nite)f(datatypes)950
2700 y(18)p eop
%%Page: 19 26
25 bop 537 601 877 2 v 536 661 2 61 v 562 643 a Ft(MAP)p 673
643 15 2 v 18 w(1)286 b(Map)13 b(value)94 b(\(18\))p 1412 661
2 61 v 536 721 V 562 703 a(MAP)p 673 703 15 2 v 18 w(ID)12
b Fo(f)p Fq(f)5 b Fo(g)167 b Ft(Map)13 b(identity)49 b(\(19\))p
1412 721 2 61 v 536 781 V 562 763 a(MAP)p 673 763 15 2 v 18
w(PROD)12 b Fo(f)p Fq(f)5 b Ft(,)p Fq(g)r Fo(g)50 b Ft(Map)13
b(product)49 b(\(20\))p 1412 781 2 61 v 537 783 877 2 v 464
916 a(T)m(able)13 b(12:)k(Macro)c(instructions)f(for)f(the)h(\256nite)g
(products)p 416 1807 1118 2 v 415 1868 2 61 v 441 1850 a(JUMP)h
Fq(c)p Ft(,)g Fq(a)49 b Ft(Resume)13 b(execution)f(at)h Fq(c)f
Ft(with)g(ar)o(guments)g Fq(a)p 1533 1868 V 415 1928 V 441
1910 a Ft(P)-5 b(ARM)13 b Fq(p)88 b Ft(Setup)12 b(a)h(pointer)e(to)i(the)f
(parameter)f(list)p 1533 1928 V 415 1988 V 441 1970 a(DEST)i
Fq(d)99 b Ft(A)13 b(destructor)p 1533 1988 V 415 2048 V 441
2030 a(RET)168 b(Return)12 b(from)g(an)g(evaluation)p 1533
2048 V 416 2050 1118 2 v 500 2183 a(T)m(able)g(13:)18 b(Macro)13
b(instructions)f(for)f(administration)950 2700 y(19)p eop
%%Page: 20 27
26 bop 223 203 a Ft(Macro\261instructions)9 b(are)g(executed)h(by)f
(interpreting)f(the)h(macro\261instruction)f(identi\256er)150
294 y(\(eg:)21 b(fold\))13 b(and)h(associating)g(it)g(with)g(the)g
(appropriate)f(micro\261code.)23 b(Macro\261instructions)150
384 y(are)15 b(compiled)g(down)g(to)h(a)f(\252linear)r(\272)g(piece)h(of)f
(code)g(through)g(the)g(compiling)g(process)g(de-)150 474 y(scribed)i
(shortly)m(.)30 b(Figure)16 b(3)h(provides)g(a)g(sample)f(of)h(how)f(memory)g
(is)h(or)o(ganized)g(after)f(a)150 565 y(combinator)c(FOLD)h(is)g(compiled)g
(to)f(macro\261code.)20 b(Note)13 b(that)g(the)f(code)i(store)e(that)h
(repre-)150 655 y(sents)c(other)g(expressions)g(are)g(typically)f(or)o
(ganized)g(as)i(a)f(pointer)f(to)g(another)g(structure/code.)150
745 y(The)15 b(parameters)e(to)h(FOLD)g(\()p Fo(f)p Fq(f)737
752 y Fn(1)757 745 y Fq(;)8 b(:)g(:)g(:)f(;)h(f)890 752 y Fh(n)913
745 y Fq(;)g(s)958 752 y Fn(1)978 745 y Fq(;)g(:)g(:)g(:)f(;)h(s)1110
752 y Fh(n)1134 745 y Fo(g)p Ft(,)14 b(the)g(ar)o(guments)g(and)g(map)g
(substi-)150 835 y(tutions\))e(are)g(stored)g(in)g(the)g(memory)f(address)i
(following)e(each)h(the)h(instruction.)k(A)12 b(RET)i(is)150
926 y(stored)g(at)g(the)g(end)g(of)g(a)g(sequence)h(of)e
(macro\261instructions)g(signals)i(the)f(end)g(of)f(execution)150
1016 y(for)f(a)g(particular)f(piece)i(of)f(code.)529 1085 y
 14077296 17892639 11774935 25062850 25852231 42955489 startTexFig

529 1085 a
%%BeginDocument: fig_machine.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica-Bold Times-Roman
%%Pages: 1
%%BoundingBox: 179 381 393 653
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 52 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica-Bold reencodeISO def
/Times-Roman reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 8 8 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 272 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 250 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 228 ] concat
%I
78 429 154 451 Rect
End

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 1 0 0 1 0.999985 40 ] concat

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 147 124 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 147 102 ] concat
%I
78 429 154 451 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 262 613 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 262 528 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

End %I eop

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 263 787 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 246 737 ] concat
%I
[
(FOLD)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 252 672 ] concat
%I
[
(RET)
] Text
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I 3
220 501
220 439
164 439
3 MLine
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I 4
114 417
283 417
283 223
171 187
4 MLine
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I 4
111 394
226 394
226 249
169 228
4 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 439 626 ] concat
%I
[
(arguments)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 378 634 ] concat
%I
[
(maps)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 333 813 ] concat
%I
[
(Entry Point)
] Text
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 679 2320 a Ft(Figure)f(3:)18 b(Sample)12 b(code)h(layout)223
2468 y(Categorical)e(combinator)e(expressions)i(are)g(simply)f(compiled)h(to)
f(a)h(linear)f(sequence)i(of)150 2559 y(macro\261instructions.)17
b(Consider)c(the)f(combinator)f(expression:)950 2700 y(20)p
eop
%%Page: 21 28
27 bop 223 203 a Fq(w)q Fp(;)8 b Fo(h)p Fq(x;)g Fo(h)p Fq(y)r(;)g(z)r
Fo(ii)p Fp(;)g Fq(P)533 210 y Fn(1)554 203 y Fp(;)g Fq(P)607
210 y Fn(0)223 294 y Ft(when)17 b(compiled,)h(this)f(combinator)f(expression)
h(is)h(stored)f(in)f(memory)h(as)g(shown)g(in)150 384 y(Figure)12
b(4.)546 453 y
 13551042 14406206 11774935 28549283 25325977 42955489 startTexFig
 546 453 a
%%BeginDocument: fig_combexp2macro.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica-Bold Times-Roman Times-Italic
%%Pages: 1
%%BoundingBox: 179 434 385 653
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 53 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica-Bold reencodeISO def
/Times-Roman reencodeISO def
/Times-Italic reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 8 8 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 272 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 250 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 228 ] concat
%I
78 429 154 451 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 263 787 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 253 606 ] concat
%I
[
(RET)
] Text
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I 3
220 501
220 439
164 439
3 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 333 813 ] concat
%I
[
(Entry Point)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 206 ] concat
%I
78 429 154 451 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-i-*-140-*
Times-Italic 14 SetF
%I t
[ 1 0 0 1 259 741 ] concat
%I
[
(w)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-i-*-140-*
Times-Italic 14 SetF
%I t
[ 1 0 0 1 260 695 ] concat
%I
[
(x)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 184 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 162 ] concat
%I
78 429 154 451 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 250 716 ] concat
%I
[
(PAIR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 258 650 ] concat
%I
[
(P0)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 258 628 ] concat
%I
[
(P1)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 264 587 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 327 228 ] concat
%I
78 429 154 451 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 327 206 ] concat
%I
78 429 154 451 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 442 717 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 443 586 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-i-*-140-*
Times-Italic 14 SetF
%I t
[ 1 0 0 1 441 652 ] concat
%I
[
(y)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-i-*-140-*
Times-Italic 14 SetF
%I t
[ 1 0 0 1 441 630 ] concat
%I
[
(z)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 327 184 ] concat
%I
78 429 154 451 Rect
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -158 81 ] concat
%I
420 587 556 587 Line
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 430 673 ] concat
%I
[
(PAIR)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 327 162 ] concat
%I
78 429 154 451 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 434 606 ] concat
%I
[
(RET)
] Text
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 369 1467 a Ft(Figure)f(4:)18 b(Macro\261code)12 b(representation)g(of)g
Fq(w)q Fp(;)c Fo(h)p Fq(x;)g Fo(h)p Fq(y)r(;)g(z)r Fo(ii)p
Fp(;)g Fq(P)1488 1474 y Fn(1)1508 1467 y Fp(;)g Fq(P)1561 1474
y Fn(0)223 1617 y Ft(A)k(sequence)h(of)f(macro\261instructions)f(de\256nes)h
(a)g(function,)g(where)g(calls)g(to)g(other)g(func-)150 1707
y(tions)g(are)h(encoded)f(into)g(the)g(code)h(stream.)950 2700
y(21)p eop
%%Page: 22 29
28 bop 223 203 a Ft(Categorical)16 b(combinators)g(are)h(compiled)f(down)g
(to)g(one)h(of)f(the)g(macro\261instructions)150 294 y(described)j(above.)39
b(Following)18 b(some)i(of)f(the)g(macro\261instructions)f(are)h(pointers)g
(to)g(the)150 384 y(parameters)d(that)h(the)g(machine)f(code)h(combination)f
(takes.)32 b(Pattern)16 b(matching)g(has)h(been)150 474 y(limited)c(to)h(a)g
(tag)g(that)f(is)i(needed)f(to)f(identify)g(the)h(instructions.)23
b(The)14 b(following)f(words)h(of)150 565 y(memory)d(are)i(understood)f(to)g
(be)g(ar)o(guments)g(of)g(the)h(instruction.)150 749 y Fm(4.2)59
b(Compiling)14 b(categorical)e(combinators)i(to)h(Macr)o(o\261instructions)
150 873 y Fr(4.2.1)50 b(The)13 b(Compilation)e(schemes)150
997 y Ft(Compiling)g(categorical)g(combinator)g(expressions)h(is)g(done)f
(through)g(a)h(set)g(of)f(compilation)150 1087 y(schemes.)47
b(At)22 b(the)f(top)h(level,)i(a)e(categorical)f(combinator)g(is)h(either)f
(a)g(combinator)n(,)j(a)150 1177 y(composition)8 b(of)g(combinators)g(or)f
(an)g(ar)o(gument)g(\(abstr)o(action\))g(to)g(a)h(combinat)o(or)f
(expression.)150 1268 y(T)m(able)13 b(14)h(de\256nes)f(how)g(each)h
(categorical)f(combinator)f(is)i(compiled.)20 b(The)14 b(concatenation)150
1358 y(of)e(a)h(string)g(of)f(combinators)g(is)h(represented)g(by)g(the)f
(\252+\272)i(in)e(the)h(compilation)f(scheme)h(and)150 1448
y(the)i(RET)h(machine)f(code)g(identi\256er)e(designates)j(an)f(end)g(of)f(a)
h(sequence)h(of)e(combinators.)150 1538 y(The)19 b(composition)e(of)h(two)f
(combinators)h(generates)g(macro)f(code)i(for)e(each)h(combinator)150
1629 y(and)k(concatenates)g(the)g(two)f(together)g(to)h(build)f(a)h(linear)f
(sequence)h(of)f(machine)h(code)150 1719 y(instructions.)42
b(Each)21 b(combinator)e(can)i(further)e(be)h(compiled)g(down)g(to)g(a)h
(sequence)g(of)150 1809 y(instructions)e(described)h(in)f(the)h(compiling)e
(schemes)j(\(T)m(able)e(15\).)39 b(Lastly)m(,)22 b(categorical)150
1900 y(combinators)10 b(can)h(be)g(an)g(abstraction)g(that)f(must)h(be)g
(substituted)g(for)f(the)h(actual)g(code)g(at)g(run)150 1990
y(time.)29 b(The)16 b(P)-5 b(ARM)17 b(machine)f(code)g(instruction)f(and)h
(the)g(of)o(fset)f(into)h(a)g(table)g(of)f(abstract)150 2080
y(code)e(that)f(makes)g(up)h(the)f(machine)g(code)h(for)e(this)i(case.)223
2170 y(A)g(combinator)e(is)i(divided)f(into)f(\256ve)i(classes:)208
2281 y Fo(\017)24 b Ft(Distributive)208 2392 y Fo(\017)g Ft(Inactive)208
2504 y Fo(\017)g Ft(Active)950 2700 y(22)p eop
%%Page: 23 30
29 bop 196 209 1559 2 v 195 269 2 61 v 221 251 a Ft(compileSC\()p
Fq(c)p Ft(\)is)11 b(the)h(machine)h(code)f(for)g(the)g(categorical)g
(combinator)f(function)h Fq(c)p Ft(.)p 1753 269 V 195 330 V
1753 330 V 196 331 1559 2 v 195 391 2 61 v 1753 391 V 195 452
V 221 434 a(compileSC\()p Fq(c)p Ft(\))p 1753 452 V 195 512
V 284 494 a(case)i(\()p Fq(c)p Ft(\))d(of)p 1753 512 V 195
572 V 1753 572 V 195 632 V 284 614 a Fq(f)5 b Fp(;)j Fq(g)260
b Fo(\))50 b Ft(compileSC\()p Fq(f)5 b Ft(\))11 b(+)i(compileSC\()p
Fq(g)r Ft(\))p 1753 632 V 195 692 V 718 674 a(where)f Fq(f)18
b Ft(and)12 b Fq(g)j Ft(are)d(categorical)g(combinators.)p
1753 692 V 195 753 V 221 735 a Fo(j)49 b Fq(c)13 b Fo(f)p Fq(f)367
742 y Fn(1)387 735 y Fq(;)8 b(:)g(:)g(:)f(;)h(f)520 742 y Fh(n)543
735 y Fo(g)50 b(\))g Ft(compileC\()p Fq(c)11 b Fo(f)p Fq(f)1010
742 y Fn(1)1030 735 y Fq(;)d(:)g(:)g(:)f(;)h(f)1163 742 y Fh(n)1187
735 y Fo(g)p 1753 753 V 195 813 V 718 795 a Ft(where)k Fq(c)g
Ft(is)h(the)f(combinator)g(identi\256er)f(and)h Fq(f)1544 802
y Fn(1)1564 795 y Fq(;)c(:)g(:)g(:)f(;)h(f)1697 802 y Fh(n)p
1753 813 V 195 873 V 718 855 a Ft(the)k(ar)o(guments)g(for)g(the)g
(combinator)m(.)p 1753 873 V 195 933 V 221 915 a Fo(j)49 b
Fq(n)305 b Fo(\))50 b Ft(P)-5 b(ARM)13 b(+)f Fq(n)h Ft(+)f(RET)p
1753 933 V 195 993 V 718 975 a(where)g Fq(n)g Ft(is)h(the)f(positional)g
(value)h(of)f(the)g(abstraction.)p 1753 993 V 196 995 1559
2 v 511 1074 a(T)m(able)h(14:)k(The)c(compileSC)f(compilation)f(scheme)208
1218 y Fo(\017)24 b Ft(Ractive)208 1329 y Fo(\017)g Ft(Cdef)223
1440 y(A)18 b(combinator)f(is)i(distributive)e(if)h(it)g(is)g(a)h(terminal)e
(\(!\),)i(identity)e(\(id\))g(or)h(a)g(pair)g(and)150 1530
y(handled)e(by)g(the)g(compilation)f(rules)h(in)g(T)m(able)h(16.)29
b(Inactive)16 b(combinators)f(refer)g(to)h(con-)150 1621 y(structors)f(and)h
(right)f(datatype)h(\(in\256nite\))e(operators)h(that)h(do)f(not)h(act)g(on)f
(the)h(value)g(graph)150 1711 y(in)h(the)f(machine.)32 b(In)16
b(T)m(able)h(17)f(constructors)h(are)f(compiled)g(with)h(the)f(identi\256er)g
(CONS)150 1801 y(and)f(the)g(constructors)g(positional)g(value.)26
b(Active)15 b(combinators)f(such)i(as)g(the)f(projections)150
1891 y(maps)j(\()p Fq(P)321 1898 y Fn(0)341 1891 y Fq(;)8 b(P)394
1898 y Fn(1)414 1891 y Ft(\),)20 b(map)e(combinators)f(\(map)934
1873 y Fn(1)953 1891 y Ft(,)k(map)1072 1873 y Fh(id)1104 1891
y Ft(,)f(map)1222 1873 y Ff(\002)1251 1891 y Ft(\),)g(and)e(destructors)g(do)
g(some)150 1982 y(manipulation)e(on)g(the)h(value)g(graph)f(at)h(run)f(time)g
(\(see)h(T)m(able)g(18\).)31 b(Cdefs)17 b(are)g(functions)150
2072 y(expressed)11 b(as)g(categorical)f(combinator)g(expressions)h(that)f
(compile)h(down)f(to)g(a)h(JUMP)g(plus)150 2162 y(the)h(jump)g(location)g
(and)h(its)f(ar)o(guments.)950 2700 y(23)p eop
%%Page: 24 31
30 bop 150 228 1829 2 v 149 288 2 61 v 175 270 a Ft(compileC)12
b([)p Fq(c)g(x)459 277 y Fn(1)479 270 y Fq(;)c(:)g(:)g(:)f(;)h(x)616
277 y Fh(n)639 270 y Ft(])k(is)h(the)f(compilation)g(of)f(a)i(combinator)m(.)
p 1978 288 V 149 348 V 1978 348 V 150 350 1829 2 v 149 410
2 61 v 1978 410 V 149 470 V 175 452 a(compileC\()p Fq(c)f Fo(f)p
Fq(x)472 459 y Fn(1)491 452 y Fq(;)c(:)g(:)g(:)f(;)h(x)628
459 y Fh(n)651 452 y Fo(g)p Ft(\))56 b Fp(=)p 1978 470 V 149
530 V 239 512 a Ft(case)13 b(\()p Fq(c)p Ft(\))e(of)p 1978
530 V 149 590 V 1978 590 V 149 651 V 239 633 a(Distributive)265
b Fo(\))49 b Ft(compileDist)12 b(\()p Fq(c)g Fo(f)p Fq(x)1201
640 y Fn(1)1221 633 y Fq(;)c(:)g(:)g(:)f(;)h(x)1358 640 y Fh(n)1381
633 y Fo(g)p Ft(\))p 1978 651 V 149 711 V 842 693 a(where)13
b Fq(c)g Fo(2)h(f)p Fp(!)p Fq(;)8 b Ft(id)o Fq(;)g Ft(pair)p
Fo(g)k Ft(and)h Fq(x)1407 700 y Fn(1)1426 693 y Fq(;)8 b(:)g(:)g(:)f(;)h(x)
1563 700 y Fh(n)p 1978 711 V 149 771 V 842 753 a Ft(are)13
b(the)f(ar)o(guments)g(for)g(pair)m(.)p 1978 771 V 149 831
V 175 813 a Fo(j)50 b Ft(Inactive)343 b Fo(\))49 b Ft(compileInactive)12
b(\()p Fq(c)g Fo(f)p Fq(x)1279 820 y Fn(1)1298 813 y Fq(;)c(:)g(:)g(:)g(;)g
(x)1436 820 y Fh(n)1459 813 y Fo(g)p Ft(\))p 1978 831 V 149
891 V 842 873 a(where)13 b Fq(c)f Ft(is)h(a)f(constructor)g(or)g(a)g(right)g
(datatype)g(operator)g(and)p 1978 891 V 149 952 V 842 933 a
Fq(x)870 940 y Fn(1)890 933 y Fq(;)c(:)g(:)g(:)f(;)h(x)1027
940 y Fh(n)1063 933 y Ft(are)k(the)g(ar)o(guments)g(for)g(the)g(right)g
(datatype.)p 1978 952 V 149 1012 V 175 994 a Fo(j)50 b Ft(Active)371
b Fo(\))49 b Ft(compileActive)12 b(\()p Fq(c)g Fo(f)p Fq(x)1251
1001 y Fn(1)1271 994 y Fq(;)c(:)g(:)g(:)f(;)h(x)1408 1001 y
Fh(n)1431 994 y Fo(g)p Ft(\))p 1978 1012 V 149 1072 V 842 1054
a(where)13 b Fq(c)g Fo(2)h(f)p Ft(map)p 1172 1054 15 2 v 18
w(1)p Fq(;)8 b Ft(map)p 1323 1054 V 18 w(id)o Fq(;)g Ft(map)p
1487 1054 V 18 w(prod)o Fq(;)p 1978 1072 2 61 v 149 1132 V
842 1114 a(p)866 1121 y Fn(0)887 1114 y Fq(;)g(p)933 1121 y
Fn(1)953 1114 y Fq(;)g Ft(id)o Fq(;)g Fo(g)k Ft(and)h Fq(x)1185
1121 y Fn(1)1204 1114 y Fq(;)8 b(:)g(:)g(:)g(;)g(x)1342 1121
y Fh(n)1377 1114 y Ft(are)k(the)h(ar)o(guments.)p 1978 1132
V 149 1192 V 175 1174 a Fo(j)50 b Ft(Cdef)407 b Fo(\))49 b
Ft(JUMP)13 b(+)g Fq(c)f Ft(+)h Fo(f)p Fq(x)1150 1181 y Fn(1)1169
1174 y Fq(;)8 b(:)g(:)g(:)f(;)h(x)1306 1181 y Fh(n)1330 1174
y Fo(g)p 1978 1192 V 149 1252 V 842 1234 a Ft(where)13 b Fq(c)f
Ft(is)h(the)f(location)g(and)g Fq(x)1414 1241 y Fn(1)1434 1234
y Fq(;)c(:)g(:)g(:)f(;)h(x)1571 1241 y Fh(n)1607 1234 y Ft(the)k(ar)o
(guments.)p 1978 1252 V 150 1254 1829 2 v 525 1333 a(T)m(able)g(15:)18
b(The)13 b(compileC)f(compilation)g(scheme)p 264 1470 1423
2 v 263 1530 2 61 v 289 1512 a(compileDist\()p Fq(c)p Ft(\))54
b Fp(=)p 1685 1530 V 263 1590 V 352 1572 a Ft(case)13 b(\()p
Fq(c)p Ft(\))f(of)p 1685 1590 V 263 1650 V 1685 1650 V 263
1711 V 352 1692 a(id)245 b Fo(\))50 b Ft(RET)p 1685 1711 V
263 1771 V 289 1753 a Fo(j)f Ft(P)-5 b(AIR\()p Fq(f)5 b Ft(,)13
b Fq(g)r Ft(\))62 b Fo(\))50 b Ft(P)-5 b(AIR)12 b(+)h(compileSC\()p
Fq(f)5 b Ft(\))11 b(+)i(compileSC\()p Fq(g)r Ft(\))e(+)h(RET)p
1685 1771 V 263 1831 V 289 1813 a Fo(j)49 b Ft(!)267 b Fo(\))50
b Ft(TERMINAL)p 1685 1831 V 264 1833 1423 2 v 512 1912 a(T)m(able)12
b(16:)18 b(Compiling)11 b(Distributive)h(combinators)p 201
2048 1549 2 v 200 2108 2 61 v 226 2090 a(compileInactive\()p
Fq(c)e Fo(f)p Fq(x)649 2097 y Fn(1)669 2090 y Fq(;)e(:)g(:)g(:)f(;)h(x)806
2097 y Fh(n)829 2090 y Fo(g)p Ft(\))p 1749 2108 V 200 2169
V 1749 2169 V 200 2229 V 285 2211 a(case)13 b(\()p Fq(c)p Ft(\))f(of)p
1749 2229 V 200 2289 V 285 2271 a(constructor\()p Fq(n)p Ft(\))348
b Fo(\))49 b Ft(CONS)13 b(+)f Fq(n)h Ft(+)f(RET)p 1749 2289
V 200 2349 V 1020 2331 a(where)g Fq(n)h Ft(is)g(the)f(constructor)f
(position.)p 1749 2349 V 200 2409 V 226 2391 a(|)49 b(right)p
383 2391 15 2 v 17 w(op\()p Fq(c)p Ft(\))419 b Fo(\))49 b Ft(RIGHT)p
1175 2391 V 18 w(OP)12 b(+)h(c)p 1749 2409 2 61 v 200 2470
V 1020 2451 a(where)f Fq(c)h Ft(is)f(the)h(code.)p 1749 2470
V 201 2471 1549 2 v 551 2550 a(T)m(able)f(17:)18 b(Compiling)11
b(Inactive)h(combinators)950 2700 y(24)p eop
%%Page: 25 32
31 bop 150 1078 1756 2 v 149 1138 2 61 v 175 1120 a Ft(compileActive\()p
Fq(c)p Ft(\))384 b Fp(=)p 1904 1138 V 149 1198 V 235 1180 a
Ft(case)13 b(\()p Fq(c)p Ft(\))e(of)p 1904 1198 V 149 1258
V 1904 1258 V 149 1318 V 235 1300 a Fq(P)266 1307 y Fn(0)902
1300 y Fo(\))49 b Ft(p0)p 1904 1318 V 149 1379 V 175 1361 a(|)h
Fq(P)266 1368 y Fn(1)902 1361 y Fo(\))f Ft(p1)p 1904 1379 V
149 1439 V 175 1421 a(|)h(map)321 1403 y Fh(id)902 1421 y Fo(\))f
Ft(map)p 1090 1421 15 2 v 18 w(id)p 1904 1439 2 61 v 149 1499
V 175 1481 a(|)h(map)321 1463 y Fn(1)902 1481 y Fo(\))f Ft(map)p
1090 1481 15 2 v 18 w(1)p 1904 1499 2 61 v 149 1559 V 175 1541
a(|)h(map)321 1523 y Ff(\002)902 1541 y Fo(\))f Ft(map)p 1090
1541 15 2 v 18 w(prod)p 1904 1559 2 61 v 149 1619 V 175 1601
a(|)h(Other\()p Fo(f)p Fq(s)414 1608 y Fn(1)432 1601 y Fq(;)8
b(:)g(:)g(:)g(;)g(s)565 1608 y Fh(n)588 1601 y Fq(;)g(f)634
1608 y Fn(1)654 1601 y Fq(;)g(:)g(:)g(:)f(;)h(f)787 1608 y
Fh(n)810 1601 y Fo(g)p Ft(\))50 b Fo(\))f Ft(JUMP)13 b(+)g
Fo(f)p Fq(s)1230 1608 y Fn(1)1249 1601 y Fq(;)8 b(:)g(:)g(:)g(;)g(s)1382
1608 y Fh(n)1405 1601 y Fo(g)k Ft(+)h Fo(f)p Fq(f)1532 1608
y Fn(1)1552 1601 y Fq(;)8 b(:)g(:)g(:)f(;)h(f)1685 1608 y Fh(n)1708
1601 y Fo(g)13 b Ft(+)f(RET)p 1904 1619 V 150 1621 1756 2 v
564 1700 a(T)m(able)h(18:)k(Compiling)12 b(Active)g(combinators)950
2700 y(25)p eop
%%Page: 26 33
32 bop 150 203 a Fr(4.2.2)50 b(Compiling)12 b(\252Maps\272)150
327 y Ft(Recall)17 b(the)f(state)h(transitions)f(for)f(the)h(datatype)h
(operators)e(FOLD,)i(UNFOLD,)g(MAP)p 1742 327 15 2 v 18 w(L,)150
417 y(and)11 b(MAP)p 344 417 V 18 w(R)h(where)f(a)g(map)656
399 y Fh(E)682 404 y Fg(i)708 417 y Ft(appeared)g(on)h(the)f(right)f(hand)h
(side)h(of)f(the)g(transition.)17 b(These)150 508 y(maps)c(are)f(the)g(basic)
h(components)f(in)g(evaluating)g(datatype)h(operators.)565
720 y(data)42 b Fq(L)p Fp(\()p Fq(A)779 727 y Fn(1)798 720
y Fq(;)8 b(:)g(:)g(:)f(;)h(A)944 727 y Fh(m)977 720 y Fp(\))185
b Fo(!)42 b Fq(S)i Fp(=)690 780 y Fq(c)711 787 y Fn(1)730 780
y Fp(:)8 b Fq(E)788 787 y Fn(1)808 780 y Fp(\()p Fq(A)864 787
y Fn(1)883 780 y Fq(;)g(:)g(:)g(:)g(;)g(A)1030 787 y Fh(m)1062
780 y Fq(;)g(S)s Fp(\))45 b Fo(!)d Fq(S)690 828 y Ft(.)690
844 y(.)690 861 y(.)690 922 y Fq(c)711 929 y Fh(n)734 922 y
Fp(:)8 b Fq(E)792 929 y Fn(1)812 922 y Fp(\()p Fq(A)868 929
y Fn(1)887 922 y Fq(;)g(:)g(:)g(:)f(;)h(A)1033 929 y Fh(m)1066
922 y Fq(;)g(S)s Fp(\))41 b Fo(!)h Fq(S)223 1120 y Ft(Given)12
b(a)h(constructor)e(and)h(the)h(FOLD)f(map,)h(this)f(can)g(be)h
(re\261written)e(as)i(above,)f(where)150 1210 y(map)236 1192
y Fh(E)262 1197 y Fg(i)293 1210 y Ft(is)k(determined)f(by)h(the)g(type)g
Fq(E)863 1217 y Fh(i)893 1210 y Ft(in)g(the)g(datatype)g Fq(L)p
Fp(\()p Fq(A)1299 1217 y Fn(1)1318 1210 y Fq(;)8 b(:)g(:)g(:)g(;)g(A)1465
1217 y Fh(m)1497 1210 y Fp(\))p Ft(.)30 b(In)15 b(the)h(eager)150
1301 y(abstract)11 b(machine,)h(the)g(replacement)f(for)f(the)i(map)1065
1283 y Fh(E)1091 1288 y Fg(i)1117 1301 y Ft(with)f(the)h(appropriate)e
(combinator)h(is)150 1391 y(performed)j(at)h(run\261time)f(because)i(the)f
(constructor)g Fq(c)1129 1398 y Fh(i)1158 1391 y Ft(determines)g(the)g(map)
1554 1373 y Fh(E)1580 1378 y Fg(i)1610 1391 y Ft(selection.)150
1481 y(The)20 b(eager)g(machine)f(queries)h(the)f(symbol)h(table)f(for)g(the)
h(proper)e(\252map)i(substitutions\272)150 1572 y(and)14 b(generates)f(the)h
(code)f(accordingly)m(.)21 b(Such)14 b(an)f(expensive)h(replacement)f
(operation)g(can)150 1662 y(be)k(eliminated)f(from)g(the)h(run)f(time)g
(system)i(by)e(compiling)g(the)h(map)1426 1644 y Fh(E)1452
1649 y Fg(i)1484 1662 y Ft(code)g(before)f(the)150 1752 y(abstract)c(machine)
h(executes)g(the)f(program.)223 1842 y(One)h(solution)f(is)h(to)f(compile)h
(each)g(constructor)e(template)i(with)f(substitutions)g(already)150
1933 y(resolved.)22 b(For)13 b(instance,)h(given)g(the)f(combinator)g(FOLD)
1195 1940 y Fh(nat)1250 1933 y Fo(f)p Fq(f)1299 1940 y Fn(1)1319
1933 y Fq(;)8 b(:)g(:)g(:)f(;)h(f)1452 1940 y Fh(n)1475 1933
y Fo(g)p Ft(,)15 b(the)e(map)1687 1915 y Fh(E)1713 1920 y Fg(i)1742
1933 y Ft(for)150 2023 y(each)19 b(constructor)f(in)g(the)g(fold)g(\(ie:)30
b(zero)18 b(and)h(succ\))g(are)f(compiled)g(down)g(to)h(the)f(form)150
2113 y(shown)13 b(in)f(Figure)f(5.)223 2204 y(The)18 b(FOLD)f(is)h(the)f
(machine)g(code)g(identi\256er)f(\(tag\))g(and)h(the)g(following)f(2)i(words)
f(of)150 2294 y(memory)e(are)i(pointers)e(to)i(the)f(ar)o(guments)g(\()p
Fq(f)983 2301 y Fn(1)1002 2294 y Fq(;)8 b(:)g(:)g(:)g(;)g(f)1136
2301 y Fh(n)1159 2294 y Ft(\))16 b(and)g(map)1366 2276 y Fh(E)1392
2281 y Fg(i)1423 2294 y Ft(\()p Fq(s)1463 2301 y Fn(1)1483
2294 y Fq(;)8 b(:)g(:)g(:)f(;)h(s)1615 2301 y Fh(n)1638 2294
y Ft(\))16 b(tables,)150 2384 y(respectively)m(.)223 2474 y(At)11
b(run)f(time,)i(a)f(constructor)f(record)g(contains)h(a)g(of)o(fset)g(into)f
(the)h(tables)g(where)g(the)g(code)150 2565 y(\(either)16 b(a)h(parameter)f
(of)h(a)g(map)736 2547 y Fh(E)762 2552 y Fg(i)777 2565 y Ft(\))f(is)i(loaded)
e(by)h(calculating)g(the)g(address)g(of)g(the)f(code.)950 2700
y(26)p eop
%%Page: 27 34
33 bop 652 154 a
 10196173 6907085 11643371 31706808 21839544 38613893 startTexFig
 652 154 a
%%BeginDocument: fig_compile.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Times-Roman
%%Pages: 1
%%BoundingBox: 177 482 332 587
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 51 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Times-Roman reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 8 8 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 1 -0 -0 1 236 262 ] concat
%I
153 375 179 441 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 1 -0 -0 1 176 230 ] concat
%I
153 375 179 441 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
1 SetP
%I t
[ 1 -0 -0 1 174 233 ] concat
%I
50 415 101 501 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 232 723 ] concat
%I
[
(FOLD)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 400 699 ] concat
%I
[
(f1)
(.)
(.)
(.)
(fn)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 336 667 ] concat
%I
[
(s1)
(.)
(.)
(.)
(sn)
] Text
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
0 SetP
%I t
[ 1 -0 -0 1 171 231 ] concat
%I
77 465 4 5 Elli
End

Begin %I Elli
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
0 SetP
%I t
[ 1 -0 -0 1 171 199 ] concat
%I
77 465 4 5 Elli
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
0 SetP
%I t
[ 1 -0 -0 1 176 231 ] concat
%I
80 465 212 465 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
%I p
0 SetP
%I t
[ 1 -0 -0 1 174 231 ] concat
%I
82 433 154 433 Line
%I 1
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 512 693 a Ft(Figure)12 b(5:)17 b(Machine)c(layout)f(of)g(a)h(sample)f
(compile)150 833 y(For)j(example,)i(given)e(the)g(constructor)g(succ)h(\(has)
g(positional)f(value)h(of)f(1\))g(of)g(the)h(natural)150 923
y(numbers)c(datatype)g(and)h(the)f(fold)p Fo(f)p Fq(f)803 930
y Fn(1)822 923 y Fq(;)c(:)g(:)g(:)f(;)h(f)955 930 y Fh(n)979
923 y Fo(g)k Ft(combinator)n(,)g(the)g(machine)g(would:)196
1044 y(1.)24 b(load)13 b(address)f(of)g(map)657 1026 y Fh(E)683
1031 y Fg(i)196 1154 y Ft(2.)24 b(add)13 b(the)f(of)o(fset)g(of)g(the)g
(constructor)g(position)g(\(ie:)17 b(1\))196 1263 y(3.)24 b(jump)12
b(to)g(the)h(code)f(that)g(the)h(entry)f(in)g(the)g(table)g(points)h(to)150
1425 y Fr(An)f(Example)h(of)f(map)g(substitutions)150 1549
y Ft(The)h(de\256nition)e(of)h(a)h(binary)f(tree)g(is)g(de\256ned)g(in)h
(Charity)f(term)f(logic)h(by)h(:)419 1687 y Fk(data)29 b(btree\(A,B\))g(->)60
b(T)30 b(=)568 1777 y(leaf:)g(A)388 b(->)60 b(T)479 1867 y(|)f(node:)30
b(\(T)f(*)h(\(B)g(*)g(T\)\))f(->)60 b(T.)223 2005 y Ft(that)16
b(says)g(the)g(datatype)f(btree)h(has)g(2)g(constructors)f(\(leaf)g(and)h
(node\),)g(where)g(the)f(leaf)150 2095 y(takes)g(a)f(parameter)g
Fk(A)g Ft(and)g(the)g(node)g(has)h(a)g(left)e(and)i(right)e(subtree)h(\()p
Fk(T)p Ft(\))g(with)f(a)i(parameter)150 2186 y Fk(B)p Ft(.)e(This)g(means)g
(that)f(the)g(datatype)g Fl(btr)n(ee)h Ft(contains)g(the)f(objects:)608
2338 y Fq(E)644 2345 y Fh(leaf)713 2338 y Fp(\()p Fq(A;)c(B)s(;)g(T)f
Fp(\))46 b(=)c Fq(A)608 2429 y(E)644 2436 y Fh(node)720 2429
y Fp(\()p Fq(A;)8 b(B)s(;)g(T)f Fp(\))39 b(=)j(\()p Fq(T)17
b Fo(\002)11 b Fp(\()p Fq(B)i Fo(\002)e Fq(T)c Fp(\)\))223
2575 y Ft(The)13 b(corresponding)f(map)697 2557 y Fh(E)723
2562 y Fg(i)737 2575 y Ft(')m(s)h(are)950 2700 y(27)p eop
%%Page: 28 35
34 bop 248 217 a Ft(map)334 199 y Fh(E)360 205 y Fg(leaf)423
217 y Fp(\()p Fq(f)s(;)8 b(g)r(;)g(h)p Fp(\))55 b(=)50 b Ft(map)p
817 217 15 2 v 18 w(id)12 b Fo(f)p Fq(f)5 b Fo(g)248 307 y
Ft(map)334 289 y Fh(E)360 295 y Fg(node)429 307 y Fp(\()p Fq(f)s(;)j(g)r(;)g
(h)p Fp(\))49 b(=)h Ft(map)p 817 307 V 18 w(prod)11 b Fo(f)p
Fq(h;)d Ft(map)p 1099 307 V 18 w(prod)o Fo(f)p Fq(f)s(;)g(h)p
Fo(gg)223 372 y Ft(Given)i(a)h(machine)f(state,)h(one)f(rewrites)g(to)g
(another)g(state)g(with)g(parameters)g(substituted.)198 525
y Fo(h)p Fq(v)241 532 y Fn(1)261 525 y Fq(;)e(v)307 532 y Fn(0)326
525 y Fp(;)g Ft(leaf)o Fo(i)p Fp(;)g Ft(fold)p 547 525 V 18
w(btree)o Fo(f)p Fq(f)s(;)g(g)r Fo(g)41 b(\))h(h)p Fq(p)961
532 y Fn(1)981 525 y Fq(;)8 b Ft(map)1089 507 y Fh(E)1115 513
y Fg(leaf)1178 525 y Fo(f)p Fq(p)1227 532 y Fn(0)1247 525 y
Fq(;)g(p)1293 532 y Fn(0)1313 525 y Fq(;)g Ft(fold)p 1419 525
V 17 w(btree)p Fo(f)p Fq(f)s(;)g(g)r Fo(ggi)p Fp(;)g Fq(f)826
615 y Fo(\))42 b(h)p Fq(p)961 622 y Fn(1)981 615 y Fq(;)8 b
Ft(map)1089 597 y Fh(id)1121 615 y Fo(f)p Fq(p)1170 622 y Fn(0)1190
615 y Fo(gi)p Fp(;)g Fq(f)150 755 y Ft(The)13 b(above)f(rule)g(is)h
(interpreted)f(as)h(having)f(a)g(constructor)g(\(leaf\))f(and)i(a)g(fold)p
1533 755 V 17 w(btree)f(combi-)150 845 y(nator)m(.)18 b(The)13
b(combination)e(of)h(these)h(two)f(items)h(can)f(be)h(rewritten)e(as:)223
935 y Fo(h)p Ft(map)328 917 y Fh(E)354 923 y Fg(leaf)418 935
y Fo(f)p Fq(p)467 942 y Fn(0)487 935 y Fq(;)d(p)533 942 y Fn(0)553
935 y Fq(;)g Ft(fold)p 659 935 V 17 w(btree)o Fo(f)p Fq(f)s(;)g(g)r
Fo(gg)p Fq(;)g(p)967 942 y Fn(1)987 935 y Fo(i)p Fp(;)g Fq(f)223
1026 y Ft(However)j(map)503 1007 y Fh(E)529 1012 y Fg(i)556
1026 y Ft(can)h(also)g(be)g(thought)f(of)g(as)h(a)g(function)f(that)g(takes)h
(three)f(parameters)150 1116 y(\(p)192 1123 y Fn(0)224 1116
y Ft(if)h(the)g(object)g(is)h(non\261recursive)e(and)i(fold)p
983 1116 V 17 w(btree)f(if)g(the)g(object)g(is)h(recursive\).)223
1206 y(The)k(substitutions)e(for)g(map)744 1188 y Fh(E)770
1193 y Fg(i)801 1206 y Ft(are)h(known)f(at)h(compile)g(time,)h(however)n(,)f
(what)g(is)g(not)150 1296 y(know)21 b(is)h(the)g(particular)f(substitution)g
(to)g(select.)47 b(The)22 b(map)1304 1278 y Fh(E)1330 1283
y Fg(i)1367 1296 y Ft(is)g(determined)f(by)g(the)150 1387 y(constructor)15
b(seen)i(on)f(the)g(\256rst)g(projection)f(of)h(a)g(pair)m(.)30
b(T)m(o)16 b(improve)f(the)i(performance)e(of)150 1477 y(the)g(machine,)i
(the)e(correspond)g(map)823 1459 y Fh(E)849 1464 y Fg(i)863
1477 y Ft(')m(s)h(for)f(each)g(constructor)g(are)g(compiled)g(into)g(a)g
(list)150 1567 y(of)e(map)291 1549 y Fh(E)317 1554 y Fg(i)332
1567 y Ft(')m(s)g(which)h(is)f(selected)h(by)f(adding)g(the)g(constructor)g
(of)o(fset)g(to)g(the)g(beginning)g(of)g(a)150 1658 y(table.)30
b(This)16 b(is)h(an)f(improvement)f(over)h(the)g(existing)g(method)f(of)h
(creating)g(the)g(map)1707 1639 y Fh(E)1733 1644 y Fg(i)1764
1658 y Ft(at)150 1748 y(runtime.)950 2700 y(28)p eop
%%Page: 29 36
35 bop 150 203 a Fs(5)72 b(The)17 b(Micr)o(o\261coded)f(Machine)150
345 y Ft(Once)e(categorical)g(combinator)g(expressions)g(are)h(compiled)e
(down)h(to)g(macro\261code,)h(they)150 435 y(are)j(ready)h(for)e(execution.)
37 b(As)19 b(mentioned,)h(each)f(macro\261instruction)e(is)i(composed)g(of)
150 526 y(micro\261instructions)j(that)g(manipulate)g(the)h(machine)g(state.)
50 b(The)23 b(machine)g(described)150 616 y(in)17 b(this)h(section)g
(interprets)f(each)h(macro\261instruction)e(and)i(executes)g(a)g(series)g(of)
f(micro\261)150 706 y(instructions.)h(At)12 b(an)h(even)f(lower)g(level,)h
(micro\261instructions)e(are)h(composed)h(of)208 817 y Fo(\017)24
b Ft(assignment)13 b(statments)208 928 y Fo(\017)24 b Ft(indirections)208
1039 y Fo(\017)g Ft(simple)13 b(arithmetic)e(\(addition)g(and)i
(subtraction\))208 1150 y Fo(\017)24 b Ft(\257ow)12 b(control)223
1261 y(T)m(wo)19 b(important)e(properties)h(of)h(the)g(Charity)f(language)h
(to)f(notice)h(when)f(evaluating)150 1352 y(evaluating)12 b(charity)g
(functions)g(at)g(the)g(machine)h(level)f(are:)196 1475 y(1.)24
b(the)13 b(language)f(has)h(strong)f(type)g(checking)196 1586
y(2.)24 b(programs)12 b(are)g(guaranteed)g(to)g(terminate.)223
1710 y(At)20 b(the)g(machine)g(level,)j(a)d(strong)g(type)g(checking)g
(system)g(means)h(that)f(all)g(micro\261)150 1800 y(instructions)c(will)g
(perform)f(a)i(legal)g(action.)30 b(T)m(ype)17 b(checking)f(guarantees)h
(that)f(a)h(micro\261)150 1890 y(instruction)i(can)g(expect)h(that)f
(required)f(values)i(are)f(available)h(when)f(the)g(instruction)g(is)150
1981 y(executed.)28 b(As)16 b(a)g(result,)h(many)e(of)h(the)f(error)g(checks)
h(can)g(be)g(omitted)f(from)f(the)i(runtime)150 2071 y(system.)27
b(Furthermore,)15 b(all)g(Charity)g(programs)f(will)h(terminate)g(after)f(a)i
(\256xed)f(amount)g(of)150 2161 y(processing)g(including)e(programs)h(that)g
(use)h(in\256nite)f(datatypes.)24 b(Recursion)15 b(in)f(Charity)g(is)150
2251 y(done)g(by)g(the)g(FOLD)h(and)f(MAP)739 2233 y Fh(L)779
2251 y Ft(operators.)23 b(For)14 b(the)g(in\256nite)f(datatypes,)i(programs)f
(ter)o(-)150 2342 y(minate)c(because)i(Charity)e(processes)h(the)g(datatypes)
g(one)g(level)f(at)h(a)g(time)f(by)g(the)h(UNFOLD)150 2432
y(and)16 b(MAP)346 2414 y Fh(R)390 2432 y Ft(operators.)27
b(By)16 b(guaranteeing)f(termination,)g(the)h(machine)f(will)g(never)g(enter)
150 2522 y(into)d(an)g(in\256nite)g(loop)g(and)g(an)h(answer)f(will)g(always)
h(be)g(returned.)950 2700 y(29)p eop
%%Page: 30 37
36 bop 150 203 a Fm(5.1)59 b(Micr)o(o\261coded)14 b(ar)o(chitectur)o(e)150
327 y Ft(The)f(state)g(of)f(the)g(machine)g(is)h(de\256ned)f(by)g(the)h
(tuple:)223 417 y Fo(h)p Fq(P)7 b(C)q(;)h(V)s(;)g(D)q(;)g(H)q(;)g(A;)g(R)p
Fp(0)p Fq(;)g(R)p Fp(1)p Fo(i)223 508 y Ft(where)208 619 y
Fo(\017)24 b Fq(P)7 b(C)16 b Ft(is)d(the)f(program)g(counter)208
730 y Fo(\017)24 b Fq(V)g Ft(is)13 b(the)f(value)g(pointer)208
841 y Fo(\017)24 b Fq(D)15 b Ft(is)d(the)h(dump)f(stack)208
952 y Fo(\017)24 b Fq(A)12 b Ft(is)h(the)f(abstraction)g(stack)208
1063 y Fo(\017)24 b Fq(H)17 b Ft(is)c(the)f(heap)208 1174 y
Fo(\017)24 b Fq(R)p Fp(0)14 b Ft(a)e(general)g(purpose)g(register)208
1285 y Fo(\017)24 b Fq(R)p Fp(1)14 b Ft(a)e(general)g(purpose)g(register)223
1396 y(A)h(transition)e(in)h(the)h(micro\261coded)e(CHARM)i(machine)g(is)f
(de\256ned)g(by:)342 1578 y Fo(h)p Fq(P)7 b(C)q(;)h(V)s(;)g(H)q(;)g(D)q(;)g
(A;)g(R)p Fp(0)p Fq(;)g(R)p Fp(1)p Fo(i)45 b(!)c(h)p Fq(P)7
b(C)1090 1559 y Ff(0)1102 1578 y Fq(;)h(V)1163 1559 y Ff(0)1174
1578 y Fq(;)g(H)1240 1559 y Ff(0)1252 1578 y Fq(;)g(D)1315
1559 y Ff(0)1327 1578 y Fq(;)g(A)1386 1559 y Ff(0)1398 1578
y Fq(;)g(R)p Fp(0)1481 1559 y Ff(0)1493 1578 y Fq(;)g(R)p Fp(1)1576
1559 y Ff(0)1588 1578 y Fo(i)150 1759 y Fe(P)g(C)19 b Fm(\261)c(The)f(pr)o
(ogram)g(counter)150 1882 y Ft(The)19 b(register)f Fq(P)7 b(C)22
b Ft(points)c(to)h(the)f(head)h(of)f(the)g(code)g(stream)h(the)f(machine)g
(is)h(currently)150 1973 y(executing.)k(V)-6 b(alid)14 b(items)g(on)g(the)g
(code)g(stream)g(are)f(either)h(macro\261instruction)e(labels)j(\(eg:)150
2063 y(FOLD\))21 b(or)g(an)g(indirection)f(to)i(some)f(other)g(code)g(store.)
45 b(A)22 b(JUMP)f(or)g(changing)g(the)150 2153 y(control)11
b(\257ow)g(of)g(a)g(program)g(is)g(done)h(by)f(assigning)h(a)f(new)h(value)f
(to)h Fq(P)7 b(C)15 b Ft(\(usually)c(done)g(by)150 2244 y(incrementing)g(the)
i Fq(P)7 b(C)16 b Ft(register)c(for)f(the)h(next)h(instruction\).)950
2700 y(30)p eop
%%Page: 31 38
37 bop 150 203 a Fe(V)28 b Fm(\261)15 b(The)f(value)h(r)o(egister)150
327 y Ft(The)23 b Fq(V)33 b Ft(register)22 b(points)g(to)g(items)g(in)g(a)g
(heap)g(structure)g(that)f(has)i(been)f(created)g(from)150
417 y(transitions)12 b(in)g(the)h(machine.)150 602 y Fe(D)j
Fm(\261)f(The)g(dump)g(stack)150 726 y Ft(The)c(purpose)f(of)g(the)h(dump)f
(stack)h(is)g(to)f(allow)g(partial)g(computations)g(to)g(be)h(stored)f(until)
g(the)150 816 y(machine)h(has)h(\256nished)e(computing)h(a)g(earlier)f
(result.)18 b(The)12 b(register)e Fq(D)j Ft(references)e(items)g(on)150
906 y(the)h(top)g(of)g(the)h(dump)f(stack.)150 1091 y Fe(A)j
Fm(\261)g(The)f(abstraction)g(stack)150 1215 y Ft(Abstractions)f(are)f
(stacked)i(onto)e(the)h(abstraction)f(stack.)20 b(Functions)13
b(that)f(require)g(abstrac-)150 1305 y(tions)18 b(simply)f(of)o(fset)h(into)f
(the)h(abstraction)f(stack)i(to)e(retrieve)g(the)h(address)g(the)g(machine)
150 1395 y(\252jumps\272)g(to.)34 b(Once)18 b(a)g(function)e(has)j(\256nish)e
(processing,)j(the)d(values)h(in)g(the)f(abstraction)150 1486
y(stack)c(are)f(poped)g(of)o(f.)150 1670 y Fe(R)p Fd(0)j Fm(and)h
Fe(R)p Fd(1)f Fm(\261)g(General)d(purpose)j(r)o(egisters)150
1794 y Ft(The)e(general)g(purpose)f(registers)h Fq(R)p Fp(0)h
Ft(and)e Fq(R)p Fp(1)i Ft(are)f(used)g(in)f(intermediate)g(calculations)h
(and)150 1884 y(parameter)f(passing)g(between)h(macro\261instructions.)150
2069 y Fm(5.2)59 b(The)15 b(Heap)150 2193 y Ft(The)h(heap)f(is)h(a)g
(contiguous)f(block)g(of)g(memory)g(that)g(holds)g(the)g(computed)g(values)h
(of)f(the)150 2283 y(machine.)j(Items)12 b(in)h(the)f(Heap)g(consist)h(of:)
196 2406 y(1.)24 b(The)14 b(Heap)g(identi\256er)m(.)20 b(Usually)14
b(a)f(P)-5 b(AIR,)14 b(CONS)f(\(constructor\))f(or)h(a)h(right)e(datatype)257
2497 y(operator)g(\(eg:)17 b(UNFOLD,)c(MAP)866 2479 y Fh(R)895
2497 y Ft(,)g(or)f(RECORD\).)950 2700 y(31)p eop
%%Page: 32 39
38 bop 196 203 a Ft(2.)24 b(Ar)o(guments)16 b(to)h(the)f(above)g(heap)h
(item.)30 b(For)16 b(example,)i(in)e(the)h(heap)f(item)g(P)-5
b(AIR,)17 b(2)257 294 y(words)12 b(of)f(memory)m(,)g(each)h(pointing)f(to)g
(a)h(projection)f(of)g(the)g(pair)h(are)f(allocated)h(in)f(the)257
384 y(heap.)19 b(For)11 b(constructors,)i(3)f(extra)g(words)g(of)g(memory)f
(for)g(the)i(constructor)e(position,)257 474 y(name)i(and)g(an)g(indirection)
f(to)h(next)g(element)g(in)g(heap.)20 b(Figure)12 b(6)h(shows)h(an)f(example)
257 565 y(of)f(how)g(the)h(pair)f(is)g(represented)g(in)h(the)f(heap)g(of)g
(the)h(abstract)f(machine.)544 667 y
 13616824 21839544 8156938 18287329 21773762 40126873 startTexFig
 544 667 a
%%BeginDocument: fig_heap.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica-Bold Times-Roman
%%Pages: 1
%%BoundingBox: 124 278 331 610
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 52 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica-Bold reencodeISO def
/Times-Roman reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 9.52435e-40 5.79667e-40 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 244 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 225 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 187 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 206 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 3 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 -16 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 -54 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 -35 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 124 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 105 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 67 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 173 86 ] concat
%I
71 453 154 472 Rect
End

Begin %I MLine
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I 1
38 229
1 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 284 515 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 284 637 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 287 391 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 285 760 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 273 712 ] concat
%I
[
(PAIR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 270 591 ] concat
%I
[
(CONS)
] Text
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I 5
137 377
9 377
9 175
9 175
92 175
5 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 274 469 ] concat
%I
[
(PAIR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 282 573 ] concat
%I
[
(1)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 271 553 ] concat
%I
[
(SUCC)
] Text
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I
137 236 261 236 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I
139 151 254 151 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 148 294 ] concat
%I
139 134 251 134 Line
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 4
112 458
240 458
240 356
161 356
4 MLine
%I 1
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 623 2152 a Ft(Figure)g(6:)18 b(Or)o(ganization)11 b(of)h(the)h(Heap)223
2300 y(The)f(heap)g(is)g(a)g(\256xed)g(structure)f(that)g(does)h(not)g
(retain)f(its)h(values)g(between)g(evaluations.)150 2390 y(That)17
b(is,)i(each)f(call)f(to)g(the)g(abstract)g(machine)g(to)g(execute)g(a)g
(combinator)f(expression)h(by)150 2481 y(the)12 b(CHIRP)f(user)h(interface)f
(will)g(reset)h(the)f(heap)h(when)f(evaluation)h(begins.)18
b(Here)11 b(garbage)150 2571 y(collection)i(is)g(not)h(needed)f(since)h(at)f
(the)g(beginning)g(of)g(each)h(evaluation,)f(a)h(\252new\272)f(heap)h(is)950
2700 y(32)p eop
%%Page: 33 40
39 bop 150 203 a Ft(used.)150 387 y Fm(5.3)59 b(Sharing)15
b(Heap)f(Items)150 511 y Ft(Frequently)m(,)22 b(structures)e(in)h(the)f(heap)
h(are)g(shared.)43 b(Recall)21 b(that)f(a)h(structure)f(is)h(shared)150
601 y(when)g(there)h(are)f(multiple)g(references)g(to)g(it.)46
b(In)21 b(the)g(eager)h(machine)f(the)g(sharing)h(of)150 691
y(structures)15 b(is)h(common.)28 b(T)m(o)15 b(enable)h(sharing)f(without)g
(creating)g(side)h(ef)o(fects,)h(the)f(parent)150 781 y(of)e(the)g(shared)g
(item)g(must)g(be)g(copied)g(to)g(another)f(area)h(in)g(the)g(heap.)24
b(This)14 b(newly)g(created)150 872 y(structure)19 b(can)i(then)e(be)i
(modi\256ed)e(to)h(re\257ect)f(the)h(necessary)h(changes)f(with)g(no)g(loss)h
(of)150 962 y(sharing.)34 b(The)18 b(implications)f(of)g(sharing)g(means)h
(that)f(in)h(certain)f(situations)g(heap)h(items)150 1052 y(can)d(be)f
(overwritten)f(with)h(new)g(values)h(to)f(save)h(heap)f(storage.)25
b(In)13 b(other)h(cases,)j(the)d(heap)150 1143 y(item)j(must)g(be)h
(duplicated)f(and)g(changes)h(must)f(be)h(made)f(to)g(the)g(newly)g(built)g
(structure.)150 1233 y(For)d(sharing)g(to)g(work)g(properly)f(in)i(the)f
(eager)h(machine,)g(two)f(rules)h(must)f(be)h(followed)e(in)150
1323 y(dealing)f(with)g(sharing:)196 1443 y(1.)24 b(Heap)17
b(objects)g(referenced)f(by)h(the)g(value)f(register)h(are)f(not)h(reusable.)
31 b(That)18 b(is,)g(the)257 1534 y(machine)c(is)g(not)f(permitted)g(to)g
(overwrite)g(heap)h(objects)g(that)f(are)h(referenced)f(by)g(the)257
1624 y(value)g(register)m(.)196 1733 y(2.)24 b(Heap)14 b(objects)g
(referenced)f(in)g(the)h(dump)f(stack)h(can)g(be)g(immediately)f(reused)h(by)
f(the)257 1823 y(machine.)223 1943 y(If)i(the)h(machine)f(needs)i(to)e
(change)h(the)g(structure)f(of)g(a)h(heap)g(item)f(that)h(is)g(referenced)150
2034 y(by)d(the)f Fq(V)25 b Ft(register)n(,)13 b(it)f(must)h(do)g(so)g(by)g
(copying)f(the)h(item)f(and)h(making)f(the)h(changes)g(to)g(the)150
2124 y(new)f(item.)19 b(Items)12 b(referenced)f(by)i(the)f
Fq(V)24 b Ft(register)12 b(are)g(considered)g(to)g(be)h(shared.)19
b(Figure)11 b(7)150 2214 y(shows)k(how)e(a)h(heap)g(item)g(is)g(copied)g
(without)f(loss)i(of)e(sharing)h(on)g(the)g(existing)f(structure.)150
2305 y(The)g(dashed)g(line)f(is)h(the)f(new)g(heap)h(item)f(that)g(the)g
Fq(V)24 b Ft(register)12 b(points)g(to)g(after)g(copying.)223
2395 y(On)c(the)h(other)e(hand,)j(heap)e(items)g(referenced)g(by)g(the)g
(dump)g(stack)g Fq(D)j Ft(can)d(be)g(overwritten)150 2485 y(with)j(new)g
(values.)18 b(An)11 b(example)g(of)g(reusing)g(heap)g(space)h(is)f(shown)g
(by)g(the)g(state)h(transition)150 2575 y(rules)20 b(for)g(building)g(a)g(P)
-5 b(AIR.)21 b(Storage)f(is)h(created)f(in)h(the)f(heap)h(when)f(the)h(P)-5
b(AIR)20 b(must)950 2700 y(33)p eop
%%Page: 34 41
40 bop 150 203 a Ft(evaluate)10 b(its)h(\256rst)f(component)g(and)g(save)h
(the)f(second)h(for)f(future)f(computation.)17 b(When)10 b(both)150
294 y(components)k(of)f(a)h(pair)f(have)h(been)g(computed)g(the)f(heap)h
(space)h(that)f(was)g(used)g(in)g(to)f(save)150 384 y(the)f(partial)g
(computation)g(can)g(be)h(overwritten)e(with)h(the)g(P)-5 b(AIR)12
b(structure.)950 2700 y(34)p eop
%%Page: 35 42
41 bop 190 435 a
 24799724 27562557 5525667 17958420 30325391 45520977 startTexFig
 190 435 a
%%BeginDocument: fig_heapcpy.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica-Bold Times-Roman Helvetica
%%Pages: 1
%%BoundingBox: 84 273 461 692
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 53 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica-Bold reencodeISO def
/Times-Roman reencodeISO def
/Helvetica reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 9.52435e-40 5.79667e-40 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 -2 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 -21 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 -59 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 -40 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 119 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 100 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 62 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 156 81 ] concat
%I
71 453 154 472 Rect
End

Begin %I MLine
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 131 289 ] concat
%I 1
38 229
1 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 267 510 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 267 632 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 270 386 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 535 590 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 1 0 0 1 82 1 ] concat

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 74 238 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 74 219 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 74 181 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 74 200 ] concat
%I
71 453 154 472 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 174 706 ] concat
%I
[
(PAIR)
] Text
End

End %I eop

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 253 586 ] concat
%I
[
(CONS)
] Text
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 131 289 ] concat
%I 5
137 377
9 377
9 175
9 175
92 175
5 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 257 464 ] concat
%I
[
(PAIR)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 265 568 ] concat
%I
[
(1)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 254 548 ] concat
%I
[
(SUCC)
] Text
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 131 289 ] concat
%I
137 236 261 236 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 131 289 ] concat
%I
139 151 254 151 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 131 289 ] concat
%I
139 134 251 134 Line
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 157 225 ] concat
%I 4
112 458
240 458
240 356
161 356
4 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 364 812 ] concat
%I
[
(V)
] Text
End

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 1 0 0 1 338 -46.0001 ] concat

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 82 246 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 82 227 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 82 189 ] concat
%I
71 453 154 472 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 82 208 ] concat
%I
71 453 154 472 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 182 714 ] concat
%I
[
(PAIR)
] Text
End

End %I eop

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 370 757 ] concat
%I
[
(Before)
(copy)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 482 789 ] concat
%I
[
(After copy)
] Text
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -146 78.0001 ] concat
%I
256 732 386 647 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -143 94 ] concat
%I
374 770 398 662 Line
%I 1
End

Begin %I Line
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -146 79 ] concat
%I
314 751 385 665 Line
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-medium-r-*-120-*
Helvetica 12 SetF
%I t
[ 1 0 0 1 109 859 ] concat
%I
[
(Other pointers)
] Text
End

Begin %I MLine
%I b 65535
3 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -158 81 ] concat
%I 3
523 711
517 656
477 624
3 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 276 763 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 533 716 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -158 81 ] concat
%I 5
690 564
579 564
590 488
527 478
480 494
5 BSpl
%I 1
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -158 81 ] concat
%I 4
688 543
612 547
569 394
479 385
4 BSpl
%I 1
End

Begin %I MLine
%I b 65520
3 0 1 [12 4] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 -158 81 ] concat
%I 5
539 725
617 706
652 665
653 665
666 612
5 MLine
%I 1
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 586 2283 a Ft(Figure)12 b(7:)17 b(Copying)c(a)f(Shared)g(Heap)g(Item)950
2700 y(35)p eop
%%Page: 36 43
42 bop 150 203 a Fm(5.4)59 b(The)15 b(Micr)o(o\261coding)e(of)i(Macr)o
(o\261instructions)150 327 y Ft(The)g(micro\261instructions)d(specify)i(the)g
(action)g(associated)h(with)f(each)g(macro\261instruction.)150
417 y(The)f(following)e(notation)h(will)g(be)g(used)h(in)f(de\256ning)g(the)g
(micro\261instructions:)208 540 y Fo(\017)24 b Ft(\()p Fq(R)p
Ft(\))12 b(\261)h(means)g(get)f(the)g(contents)h(of)f Fq(R)p
Ft(.)208 651 y Fo(\017)24 b Fq(R)13 b Ft(\261)g(means)f(an)h(indirection)e
(to)h(the)h(contents)f(of)g Fq(R)223 773 y Ft(In)g(addition,)g(several)h
(support)f(functions)g(are)g(provided:)208 884 y Fo(\017)24
b Ft(alloc\()p Fq(n)p Ft(,)13 b Fq(R)p Ft(\))f(\261)h(allocate)f
Fq(n)h Ft(items)f(of)g(heap)g(space,)i(returning)d(a)i(pointer)e(in)h
Fq(R)208 995 y Fo(\017)24 b Ft(push\()p Fq(R)p Ft(,)13 b Fq(D)q
Ft(\))g(\261)g(Push)f(the)g(contents)h(of)f(register)g Fq(R)h
Ft(to)f(the)g(dump)g Fq(D)208 1105 y Fo(\017)24 b Ft(pop\()p
Fq(D)q Ft(,)13 b Fq(R)p Ft(\))g(\261)f(Pop)g(an)h(item)f(from)f
Fq(D)j Ft(dump)e(to)g(register)g Fq(R)208 1216 y Fo(\017)24
b Ft(pushA\()p Fq(A)p Ft(,)g Fq(n)p Ft(\))d(\261)h(load)f(the)g(abstractions)
h(from)e(table)i Fq(A)f Ft(onto)g(abstraction)g(stack,)257
1306 y(leaving)12 b(the)h(count)f(in)g Fq(n)p Ft(.)223 1417
y(The)j(following)f(is)h(a)g(listing)f(of)g(the)h(micro\261instructions)e
(that)h(make)h(up)g(each)g(macro\261)150 1507 y(instruction.)h(The)8
b(macro\261instruction)g(name)g(is)g(presented)g(in)g(bold)f(with)g(a)h
(short)g(descrip)o(tion)150 1598 y(of)k(the)h(actions.)19 b(Following)11
b(the)i(description)f(is)g(the)h(state)g(transition)f(rule)g(\(where)g
(applica-)150 1688 y(ble\))g(of)g(the)g(macro\261code.)18 b(Finally)m(,)12
b(the)g(micro\261instructions)f(for)h(each)h(macro\261instruction)150
1778 y(is)g(listed.)150 1962 y Fm(TERMINAL)150 2086 y Ft(The)g(terminal)e
(instruction)h(resets)h(the)f Fq(V)24 b Ft(register)m(.)696
2257 y Fp(\(1\))42 b(\()p Fq(v)r(;)8 b Fp(!)p Fq(:c;)g(d)p
Fp(\))39 b Fo(!)j Fp(\(!)p Fq(;)8 b(c;)g(d)p Fp(\))p 150 2364
1650 2 v 149 2574 2 210 v 191 2501 a Fc(V)24 b(=)h(TERMINAL)p
1798 2574 V 150 2575 1650 2 v 950 2700 a Ft(36)p eop
%%Page: 37 44
43 bop 150 203 a Fm(P0)150 327 y Fq(P)181 334 y Fn(0)214 327
y Ft(selects)14 b(the)f(\256rst)f(co\261ordinate)h(of)f(a)h(pair)g(\(The)g
(\256rst)f(projection\).)19 b(Note)13 b(that)g(the)g(values)150
417 y(in)f(a)h(pair)f(are)g(reversed.)601 599 y Fp(\(2\))42
b(\()p Fo(h)p Fq(v)767 606 y Fn(1)787 599 y Fq(;)8 b(v)833
606 y Fn(0)852 599 y Fo(i)p Fq(;)g(P)924 606 y Fn(0)944 599
y Fq(:c;)g(d)p Fp(\))41 b Fo(!)h Fp(\()p Fq(v)1221 606 y Fn(0)1240
599 y Fq(;)8 b(c;)g(d)p Fp(\))p 150 706 1650 2 v 149 955 2
249 v 191 800 a Fc(R0)24 b(=)h(\(V)g(+)g(2\))174 b(;)25 b(Get)f(the)h
(pointer)f(to)h(first)f(projection)191 875 y(V)49 b(=)25 b(R0)299
b(;)25 b(Save)f(the)h(value)f(to)h(the)g(V)f(register)p 1798
955 V 150 957 1650 2 v 150 1076 a Fm(P1)150 1199 y Fq(P)181
1206 y Fn(1)214 1199 y Ft(selects)13 b(the)f(second)h(co\261ordinate)f(of)g
(a)g(pair)g(\(The)h(second)f(projection\).)601 1381 y Fp(\(3\))42
b(\()p Fo(h)p Fq(v)767 1388 y Fn(1)787 1381 y Fq(;)8 b(v)833
1388 y Fn(0)852 1381 y Fo(i)p Fq(;)g(P)924 1388 y Fn(1)944
1381 y Fq(:c;)g(d)p Fp(\))41 b Fo(!)h Fp(\()p Fq(v)1221 1388
y Fn(1)1240 1381 y Fq(;)8 b(c;)g(d)p Fp(\))p 150 1488 V 149
1737 2 249 v 191 1582 a Fc(R0)24 b(=)50 b(V)25 b(+)g(1)199
b(;)25 b(Get)f(the)h(pointer)f(to)h(first)f(projection)191
1657 y(V)49 b(=)25 b(R0)299 b(;)25 b(Save)f(the)h(value)f(to)h(the)g(V)f
(register)p 1798 1737 V 150 1739 1650 2 v 150 1860 a Fm(P)l(AIR)p
Fw(f)p Fe(c)347 1869 y Fb(0)370 1860 y Fe(;)10 b(c)421 1869
y Fb(1)444 1860 y Fw(g)150 1984 y Ft(Construct)i(a)h(pair)f(structure)g(in)g
(the)h(heap.)19 b(First)12 b(evaluate)g(the)h(second)g(project,)f(storing)g
(the)150 2074 y(\256rst)g(on)g(the)h(heap.)494 2256 y Fp(\(6\))42
b(\()p Fq(v)r(;)8 b Fo(h)p Fq(c)705 2263 y Fn(0)724 2256 y
Fq(;)g(c)767 2263 y Fn(1)787 2256 y Fo(i)p Fq(:c;)g(d)p Fp(\))41
b Fo(!)h Fp(\()p Fq(v)r(;)8 b(c)1128 2263 y Fn(1)1146 2256
y Fq(;)g Ft(pr)1210 2268 y Fn(0)1229 2256 y Fp(\()p Fq(v)r(;)g(c)1317
2263 y Fn(0)1336 2256 y Fq(;)g(c)p Fp(\))p Fq(:d)p Fp(\))950
2700 y Ft(37)p eop
%%Page: 38 45
44 bop 150 155 1650 2 v 149 776 2 621 v 191 248 a Fc(alloc\(3,)24
b(R0\))174 b(;)25 b(get)f(3)h(words)g(of)f(heap)h(to)g(store)f(pair)191
322 y(R0)124 b(=)25 b(v)224 b(;)25 b(<v1,)f(v0>)191 397 y(R0+1)74
b(=)25 b(PC)g(+)f(1)100 b(;)25 b(c0)191 472 y(R0+2)74 b(=)25
b(\(PC\))f(+)h(3)50 b(;)25 b(c)g(--)f(save)h(PC)g(for)f(continuation)191
547 y(push\(R0,)g(D\))199 b(;)25 b(store)f(pr0\(<v1,)g(v0>,)h(c0,)f(c\))191
696 y(PC)g(=)h(\(PC\))g(+)g(2)149 b(;)25 b(Jump)f(to)h(c1)p
1798 776 V 150 778 1650 2 v 150 899 a Fm(PR0)p Fw(f)p Fe(v)r(;)10
b(c)371 908 y Fb(0)394 899 y Fe(;)g(c)p Fw(g)150 1023 y Ft(Continue)g
(evaluation)h(of)f(the)h(\256rst)f(projection)g(of)g(a)h(pair)m(.)17
b(Store)10 b(the)h(computed)f(value)h(in)f(the)150 1113 y(heap.)456
1295 y Fp(\(7\))42 b(\()p Fq(v)603 1302 y Fn(1)622 1295 y Fq(;)8
b Fp([)g(])o Fq(;)g Ft(pr)743 1308 y Fn(0)763 1295 y Fp(\()p
Fq(v)r(;)g(c)851 1302 y Fn(0)869 1295 y Fq(;)g(c)p Fp(\))p
Fq(:d)p Fp(\))42 b Fo(!)f Fp(\()p Fq(v)r(;)8 b(c)1210 1302
y Fn(0)1229 1295 y Fq(;)g Ft(pr)1292 1308 y Fn(1)1312 1295
y Fp(\()p Fq(v)1355 1302 y Fn(1)1374 1295 y Fq(;)g(c)p Fp(\))p
Fq(:d)p Fp(\))p 150 1402 V 149 2023 2 621 v 191 1495 a Fc(R0)74
b(=)25 b(PC)g(+)g(1)149 b(;)25 b(pr0\(v,)f(c0,)h(c\))191 1570
y(R1)74 b(=)25 b(v)274 b(;)25 b(swap)f(v1)h(with)g(c0)191 1644
y(V)99 b(=)25 b(R0)249 b(;)25 b(load)f(v)191 1719 y(PC)74 b(=)25
b(R0)g(+)g(1)149 b(;)25 b(load)f(c0)h(into)g(PC)191 1794 y(R0+1)f(=)h(R1)249
b(;)25 b(save)f(v1)191 1869 y(push\(R0,)g(D\))199 b(;)25 b(create)f(pr1\(v1,)
g(c\))h(in)g(heap)191 1943 y(push\(PR1,)f(D\))p 1798 2023 V
150 2025 1650 2 v 150 2147 a Fm(PR1)p Fw(f)p Fe(v)r Fd(1)p
Fe(;)10 b(c)p Fw(g)150 2270 y Ft(Create)h(the)h(fully)e(evaluated)h(pair)g
(structure)g(as)h(item)f(in)g(the)g(heap.)18 b(Reuse)12 b(the)g(heap)f
(storage)150 2361 y(space)i(that)f(was)h(used)g(to)f(hold)g(the)g(partial)g
(computations.)527 2542 y Fp(\(8\))42 b(\()p Fq(v)674 2549
y Fn(0)693 2542 y Fq(;)8 b Fp([)g(])o Fq(;)g Ft(pr)814 2555
y Fn(1)833 2542 y Fp(\()p Fq(v)876 2549 y Fn(1)896 2542 y Fq(;)g(c)p
Fp(\))p Fq(:d)p Fp(\))41 b Fo(!)g Fp(\()p Fo(h)p Fq(v)1210
2549 y Fn(1)1230 2542 y Fq(;)8 b(v)1276 2549 y Fn(0)1295 2542
y Fo(i)p Fq(;)g(c;)g(d)p Fp(\))950 2700 y Ft(38)p eop
%%Page: 39 46
45 bop 150 155 1650 2 v 149 625 2 470 v 191 248 a Fc(R0)74
b(=)25 b(PC)g(+)g(1)149 b(;)25 b(load)f(pr1\(v1,)h(c\))191
322 y(R0)74 b(=)25 b(PAIR)199 b(;)25 b(create)f(<v1,)h(v0>)f(reuse)h(heap)f
(storage)191 397 y(PC)74 b(=)25 b(R0)g(+)g(2)149 b(;)25 b(Set)f(PC)h(to)g
(resume)f(at)h(c)191 472 y(R0+2)f(=)h(V)274 b(;)25 b(<v1,)f(v0>)191
547 y(V)99 b(=)25 b(R0)249 b(;)25 b(set)f(V)h(to)g(hold)f(<v1,)h(v0>)p
1798 625 V 150 626 1650 2 v 150 748 a Fm(CONS)p Fw(f)p Fe(p;)10
b(n)p Fw(g)150 872 y Ft(Instantiate)15 b(a)g(constructor)f(in)h(the)h(heap.)
26 b(A)16 b(construction)e(is)h(composed)h(of)e(an)i(identi\256er)n(,)150
962 y(positional)11 b(value,)h(pointer)e(to)h(the)g(constructor)f(name)h(and)
h(an)f(indirection)f(to)h(the)g(next)g(heap)150 1052 y(item.)662
1224 y Fp(\(9\))42 b(\()p Fq(v)r(;)8 b(u:c;)g(d)p Fp(\))40
b Fo(!)h Fp(\()p Fq(u:v)r(;)8 b(c;)g(d)p Fp(\))p 150 1331 V
149 1873 2 543 v 191 1424 a Fc(alloc\(4,)24 b(R0\))174 b(;)25
b(get)f(heap)h(space)f(for)h(constructor)191 1498 y(R0)74 b(=)25
b(CONS)199 b(;)25 b(assign)f(the)h(tag)f(CONS)191 1573 y(R0+1)g(=)h(PC)g(+)g
(1)149 b(;)25 b(the)f(positional)g(value)191 1648 y(R0+2)g(=)h(PC)g(+)g(2)149
b(;)25 b(the)f(constructor)g(name)191 1722 y(R0+3)g(=)h(V)274
b(;)25 b(the)f(next)h(value)f(is)h(in)g(V)191 1797 y(V)99 b(=)25
b(R0)249 b(;)25 b(set)f(the)h(new)g(V)f(value)p 1798 1873 V
150 1875 1650 2 v 150 1997 a Fm(CONT)p Fw(f)p Fe(c)p Fw(g)150
2120 y Ft(Resume)13 b(evaluation)f(code)g(that)h(has)f(been)h(suspended.)637
2302 y Fp(\(10\))42 b(\()p Fq(v)r(;)8 b Fp([)g(])o Fq(;)g(c)p
Fp(\()p Fq(c)p Fp(\))p Fq(:d)p Fp(\))41 b Fo(!)g Fp(\()p Fq(v)r(;)8
b(c;)g(d)p Fp(\))950 2700 y Ft(39)p eop
%%Page: 40 47
46 bop 150 155 1650 2 v 149 369 2 214 v 191 292 a Fc(PC)24
b(=)h(PC)g(+)g(1)199 b(;)25 b(resume)f(execution)g(at)h(c)p
1798 369 V 150 370 1650 2 v 150 489 a Fm(CASE)p Fw(f)p Fe(f)368
498 y Fb(1)391 489 y Fe(;)10 b(:)g(:)g(:)h(;)f(f)551 498 y
Fa(n)578 489 y Fw(g)150 613 y Ft(Examine)e(the)h(ar)o(gument)e(and)i(build)e
(a)i(new)f(structure)g(with)g(the)g(construction)g(stripped)g(away)m(.)150
703 y(Load)13 b(the)f(address)h(of)f(the)g(function)g Fq(f)830
710 y Fh(i)856 703 y Ft(into)g(the)h(program)e(counter)h(and)g(begin)g
(execution.)302 885 y Fp(\(12\))42 b(\()p Fo(h)p Fq(v)492 892
y Fn(1)512 885 y Fq(;)8 b(v)558 892 y Fn(0)577 885 y Fq(:c)612
892 y Fh(i)625 885 y Fo(i)p Fq(;)g Ft(case)752 867 y Fh(L)778
885 y Fo(f)p Fq(f)827 892 y Fn(1)847 885 y Fq(;)g(:)g(:)g(:)g(;)g(f)981
892 y Fh(n)1004 885 y Fo(g)p Fq(:c;)g(d)p Fp(\))41 b Fo(!)g
Fp(\()p Fo(h)p Fq(v)1324 892 y Fn(1)1344 885 y Fq(;)8 b(v)1390
892 y Fn(0)1409 885 y Fo(i)p Fq(;)g(f)1474 892 y Fh(i)1489
885 y Fq(;)g(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p Fp(\))p 150
992 V 149 1987 2 995 v 191 1085 a Fc(R1)74 b(=)25 b(V)g(+)g(2)174
b(;)25 b(Examine)f(the)h(constructor)191 1160 y(alloc\(3,)f(R0\))174
b(;)25 b(Copy)f(the)h(pair)f(stripping)g(constructor)191 1234
y(R0)74 b(=)25 b(PAIR)199 b(;)25 b(Heap)f(identifier)191 1309
y(R0+1)g(=)h(V)g(+)g(1)174 b(;)25 b(<v1,)f(_>)191 1384 y(R0+2)g(=)h(R1)g(+)g
(4)149 b(;)25 b(strip)f(cons)h(-->)f(<v1,)h(v0>)191 1459 y(V)99
b(=)25 b(R0)249 b(;)25 b(V)g(=)f(<v1,)h(v0>)191 1533 y(push\(PC+2,)f(D\))149
b(;)25 b(save)f(return)h(address)191 1608 y(push\(CONT,)f(D\))149
b(;)50 b(as)24 b(a)h(continuation)191 1757 y(R0)74 b(=)25 b(PC)g(+)g(1)149
b(;)25 b(load)f(the)h(argument)f(list)h({f1,...,fn})191 1832
y(R1)74 b(=)25 b(R1)g(+)g(1)149 b(;)25 b(load)f(the)h(positional)f(value)g
(of)h(constructor)191 1907 y(PC)74 b(=)25 b(R0)g(+)g(R1)124
b(;)25 b(calculate)f(the)g(appropriate)g(offset)p 1798 1987
V 150 1989 1650 2 v 150 2108 a Fm(FOLD)p Fw(f)p Fe(f)376 2117
y Fb(1)398 2108 y Fe(;)10 b(:)g(:)g(:)h(;)f(f)558 2117 y Fa(n)585
2108 y Fe(;)g(s)639 2117 y Fb(1)661 2108 y Fe(;)g(:)g(:)g(:)h(;)f(s)820
2117 y Fa(n)847 2108 y Fw(g)150 2232 y Ft(Load)j(the)f(appropriate)f(map)663
2214 y Fh(E)689 2219 y Fg(i)717 2232 y Ft(into)h(the)g(machine)g(for)g
(execution.)301 2384 y Fp(\(13\))42 b(\()p Fo(h)p Fq(v)491
2391 y Fn(1)511 2384 y Fq(;)8 b(v)557 2391 y Fn(0)576 2384
y Fq(:c)611 2391 y Fh(i)625 2384 y Fo(i)p Fq(;)g Ft(fold)746
2364 y Fh(L)772 2384 y Fo(f)p Fq(g)820 2391 y Fn(1)840 2384
y Fq(;)g(:)g(:)g(:)g(;)g(g)973 2391 y Fh(n)996 2384 y Fo(g)p
Fq(:c;)g(d)p Fp(\))320 2514 y Fo(!)59 b Fp(\()p Fo(h)p Fq(v)491
2521 y Fn(1)511 2514 y Fq(;)8 b(v)557 2521 y Fn(0)576 2514
y Fo(i)p Fq(;)g Ft(map)703 2496 y Fh(E)729 2501 y Fg(i)744
2514 y Fo(f)790 2475 y Fq(P)821 2482 y Fn(0)841 2475 y Fq(;)790
2565 y Ft(fold)870 2544 y Fh(L)896 2565 y Fo(f)p Fq(g)944 2572
y Fn(1)964 2565 y Fq(;)g(:)g(:)g(:)g(;)g(g)1097 2572 y Fh(n)1120
2565 y Fo(g)1166 2514 y(g)p Fq(;)g Ft(pr)1254 2527 y Fn(1)1274
2514 y Fp(\()p Fq(v)1317 2521 y Fn(1)1336 2514 y Fq(;)g(g)1381
2521 y Fh(i)1396 2514 y Fp(\))p Fq(:c)p Fp(\()p Fq(c)p Fp(\))p
Fq(:d)p Fp(\))950 2700 y Ft(40)p eop
%%Page: 41 48
47 bop 150 155 1650 2 v 149 1900 2 1746 v 191 248 a Fc(R1)74
b(=)25 b(V)g(+)g(2)174 b(;)25 b(Examine)f(the)h(constructor)191
322 y(R1)74 b(=)25 b(R1)g(+)g(1)149 b(;)25 b(load)f(constructor)g(position)
191 397 y(R0)74 b(=)25 b(PC)g(+)g(1)149 b(;)25 b(load)f(argument)g(list)h
(\(g1,...,gn\))191 472 y(R0)74 b(=)25 b(R0)g(+)g(R1)124 b(;)25
b(Calculate)f(the)g(address)h(of)f(gi)191 621 y(alloc\(3,)g(R1\))174
b(;)191 696 y(R1)74 b(=)25 b(PAIR)199 b(;)25 b(create)f(pr1\(v1,)g(c\))191
771 y(R1+1)g(=)h(V)g(+)g(1)174 b(;)25 b(store)f(v1)191 846
y(R1+2)g(=)h(R0)249 b(;)25 b(store)f(gi)191 920 y(push\(R1,)g(D\))199
b(;)25 b(push)f(pr1\(v1,)h(c\))f(onto)h(dump)191 995 y(push\(PR1,)f(D\))191
1144 y(R1)74 b(=)25 b(V)g(+)g(2)174 b(;)25 b(Examine)f(constructor)g(again)
191 1219 y(alloc\(3,)g(R0\))174 b(;)191 1294 y(*R0)49 b(=)25
b(PAIR)199 b(;)25 b(Copy)f(the)h(pair)f(structure)g(<v1,)h(v0>)191
1369 y(R0+1)f(=)h(V)g(+)g(1)174 b(;)25 b(v1)191 1443 y(R0+2)f(=)h(R1)g(+)g
(4\))124 b(;)25 b(v0)191 1518 y(V)99 b(=)25 b(R0)249 b(;)25
b(Set)f(v)h(=)g(<v1,)g(v0>)f(\(constructor)g(stripped\))191
1667 y(R1)74 b(=)25 b(R1)g(+)g(1)149 b(;)25 b(load)f(constructor)g(position)
191 1742 y(R0)74 b(=)25 b(PC)g(+)g(2)149 b(;)25 b(load)f(Map_Ei)h(list)f
(\(s1,...sn\))191 1817 y(PC)74 b(=)25 b(R0)g(+)g(R1)124 b(;)25
b(calculate)f(address)g(of)h(Map_Ei)p 1798 1900 V 150 1902
1650 2 v 150 2024 a Fm(MAP)p 290 2024 18 2 v 22 w(L)p Fw(f)p
Fe(f)407 2033 y Fb(1)429 2024 y Fe(;)10 b(:)g(:)g(:)h(;)f(f)589
2033 y Fa(n)616 2024 y Fe(;)g(s)670 2033 y Fb(1)693 2024 y
Fe(;)g(:)g(:)g(:)h(;)f(s)852 2033 y Fa(n)878 2024 y Fw(g)150
2147 y Ft(Load)j(map)351 2129 y Fh(E)377 2134 y Fg(i)404 2147
y Ft(into)f(the)g(program)g(counter)m(.)950 2700 y(41)p eop
%%Page: 42 49
48 bop 377 345 a Fp(\(14\))42 b(\()p Fo(h)p Fq(v)567 352 y
Fn(1)587 345 y Fq(;)8 b(v)633 352 y Fn(0)652 345 y Fq(:c)687
352 y Fh(i)701 345 y Fo(i)p Fq(;)g Ft(map)828 327 y Fh(L)854
345 y Fo(f)p Fq(h)907 352 y Fn(1)926 345 y Fq(;)g(:)g(:)g(:)g(;)g(h)1064
352 y Fh(n)1087 345 y Fo(g)p Fq(:c;)g(d)p Fp(\))395 475 y Fo(!)60
b Fp(\()p Fo(h)p Fq(v)567 482 y Fn(1)587 475 y Fq(;)8 b(v)633
482 y Fn(0)652 475 y Fo(i)p Fq(;)g Ft(map)779 457 y Fh(E)805
462 y Fg(i)820 475 y Fo(f)866 436 y Fq(h)894 443 y Fn(1)914
436 y Fq(;)g(:)g(:)g(:)f(;)h(h)1051 443 y Fh(n)1074 436 y Fq(;)866
526 y Ft(map)952 508 y Fh(L)978 526 y Fo(f)p Fq(h)1031 533
y Fn(1)1050 526 y Fq(;)g(:)g(:)g(:)g(;)g(h)1188 533 y Fh(n)1211
526 y Fo(g)1257 475 y(g)p Fq(:c)1317 482 y Fh(i)1330 475 y
Fq(;)g(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p Fp(\))p 150 724 1650
2 v 149 2021 2 1297 v 191 816 a Fc(R1)74 b(=)25 b(V)g(+)g(2)174
b(;)25 b(Examine)f(the)h(constructor)191 891 y(alloc\(3,)f(R0\))174
b(;)25 b(Copy)f(the)h(pair,)f(stripping)g(constructor)191 966
y(*R0)49 b(=)25 b(PAIR)199 b(;)25 b(Heap)f(identifier)191 1041
y(R0+1)g(=)h(V)g(+)g(1)174 b(;)25 b(<v1,)f(_>)191 1115 y(R0+2)g(=)h(R1)g(+)g
(4)149 b(;)25 b(strip)f(constructor)g(-->)h(<v1,)f(v0>)191
1190 y(V)99 b(=)25 b(R0)249 b(;)25 b(v)g(=)f(<v1,)h(v0>)191
1265 y(alloc\(4,)f(R0\))174 b(;)25 b(Copy)f(the)h(constructor)191
1339 y(R0)74 b(=)25 b(R1+2)199 b(;)25 b(constructor)f(name)191
1414 y(R0+1)g(=)h(R1+1)199 b(;)25 b(positional)f(value)g(of)h(constructor)191
1489 y(R0+2)f(=)h(R1)249 b(;)25 b(CONS)f(identifier)191 1564
y(push\(R0,)g(D\))199 b(;)25 b(push)f(the)h(constructor)f(onto)g(the)h(heap)
191 1638 y(push\(CONT,)f(D\);)191 1788 y(R0)74 b(=)25 b(PC)g(+)g(2)149
b(;)25 b(load)f(the)h(mapE_i)f(list)h(\(s1,...,sn\))191 1863
y(R1)74 b(=)25 b(R1)g(+)g(1)149 b(;)25 b(load)f(the)h(positional)f(value)g
(of)h(constructor)191 1937 y(PC)74 b(=)25 b(R0)g(+)g(R1)124
b(;)25 b(calculate)f(the)g(address)h(of)f(mapE_i)p 1798 2021
V 150 2023 1650 2 v 150 2144 a Fm(UNFOLD)p Fw(f)p Fe(f)462
2153 y Fb(1)484 2144 y Fe(;)10 b(:)g(:)g(:)h(;)f(f)644 2153
y Fa(n)671 2144 y Fe(;)g(s)725 2153 y Fb(1)748 2144 y Fe(;)g(:)g(:)g(:)g(;)g
(s)906 2153 y Fa(n)933 2144 y Fw(g)150 2268 y Ft(Similar)i(to)i(the)g(FOLD)f
(case)i(where)e(the)h Fq(f)915 2275 y Fh(i)943 2268 y Ft(is)g(loaded)f(and)h
(a)g(pair)f(continuation)g(is)h(pushed)150 2358 y(to)e(the)h(dump)e(stack.)
950 2700 y(42)p eop
%%Page: 43 50
49 bop 420 345 a Fp(\(15\))42 b(\()p Fq(v)r(:)p Ft(unfold)736
325 y Fh(R)765 345 y Fo(f)p Fq(f)814 352 y Fn(1)833 345 y Fq(;)8
b(:)g(:)g(:)g(;)g(f)967 352 y Fh(n)990 345 y Fo(g)p Fq(;)g(d)1062
352 y Fh(i)1076 345 y Fq(:c;)g(d)p Fp(\))438 475 y Fo(!)60
b Fp(\()p Fq(v)r(;)8 b(f)639 482 y Fh(i)652 475 y Fq(;)g Ft(pr)715
488 y Fn(1)735 475 y Fp(\()p Fq(v)r(;)822 436 y Ft(map)908
418 y Fh(F)930 423 y Fg(i)946 436 y Fo(f)p Fq(P)1002 443 y
Fn(0)1022 436 y Fq(;)822 526 y Ft(unfold)952 506 y Fh(R)981
526 y Fo(f)p Fq(f)1030 533 y Fn(1)1050 526 y Fq(;)g(:)g(:)g(:)f(;)h(f)1183
533 y Fh(n)1207 526 y Fo(g)1252 475 y(g)p Fp(\))p Fq(:c)p Fp(\()p
Fq(c)p Fp(\))p Fq(:d)p Fp(\))p 150 634 1650 2 v 149 1852 2
1219 v 664 726 a Fc(;)25 b(Destructor)f(passed)g(in)h(R0)191
801 y(R0)74 b(=)25 b(R0)g(+)g(1)149 b(;)25 b(load)f(destructor)g(position)191
876 y(R1)74 b(=)25 b(V)g(+)g(1)174 b(;)25 b(load)f(argument)g(list)h
(\(f1,...,fn\))191 950 y(PC)74 b(=)25 b(R1)g(+)g(R0)124 b(;)25
b(calculate)f(address)g(of)h(fi)191 1025 y(push\(R1,)f(D\))199
b(;)25 b(temporarily)f(save)g(fi)191 1100 y(R1)74 b(=)25 b(V)g(+)g(2)174
b(;)25 b(load)f(Map_Ei)h(list)f(\(s1,...,sn\))191 1174 y(R1)74
b(=)25 b(R1)g(+)g(R0)124 b(;)25 b(calculate)f(address)g(of)h(si)191
1324 y(alloc\(3,)f(R0\))174 b(;)25 b(create)f(pr1\(v,)g(map_Ei\))191
1399 y(R0)74 b(=)25 b(V)274 b(;)25 b(v)191 1473 y(R0+1)f(=)h(R1)249
b(;)25 b(R1)191 1548 y(pop\(D,)f(R1\))224 b(;)25 b(Restore)f(fi)191
1623 y(push\(R0,)g(D\))199 b(;)25 b(push)f(pr1\(v,)h(map_Ei\))f(onto)g(dump)
191 1698 y(push\(PR1,)g(D\))191 1772 y(V)99 b(=)25 b(V)g(+)g(3)174
b(;)25 b(strip)f(UNFOLD)h(label)p 1798 1852 V 150 1854 1650
2 v 150 1976 a Fm(RECORD)p Fw(f)p Fe(f)468 1985 y Fb(1)491
1976 y Fe(;)10 b(:)g(:)g(:)g(;)g(f)650 1985 y Fa(n)678 1976
y Fw(g)150 2099 y Ft(Destruct)i(the)h(in\256nite)e(list)i(at)f(one)g(level)h
(and)f(execute)h(the)f(appropriate)f Fq(f)1459 2106 y Fh(i)1473
2099 y Ft(.)377 2281 y Fp(\(16\))43 b(\()p Fq(v)r(:)p Ft(RECORD)p
Fo(f)p Fq(g)814 2288 y Fn(1)834 2281 y Fq(;)8 b(:)g(:)g(:)f(;)h(g)966
2288 y Fh(n)990 2281 y Fo(g)p Fq(;)g(d)1062 2288 y Fh(i)1076
2281 y Fq(:c;)g(d)p Fp(\))41 b Fo(!)g Fp(\()p Fq(v)r(;)8 b(g)1399
2288 y Fh(i)1413 2281 y Fq(;)g(c)p Fp(\()p Fq(c)p Fp(\))p Fq(:d)p
Fp(\))950 2700 y Ft(43)p eop
%%Page: 44 51
50 bop 150 155 1650 2 v 149 552 2 397 v 689 248 a Fc(;)25 b(Destructor)f
(passed)g(in)h(R0)191 322 y(R1)74 b(=)25 b(PC)g(+)g(1)174 b(;)25
b(load)f(argument)g(table)h(\(g1,...,gn\))191 397 y(R0)74 b(=)25
b(R0)g(+)g(1)174 b(;)25 b(load)f(destructor)g(positional)g(value)191
472 y(PC)74 b(=)25 b(R1)g(+)g(R0)149 b(;)25 b(calculate)f(gi)p
1798 552 V 150 554 1650 2 v 150 675 a Fm(MAP)p 290 675 18 2
v 22 w(R)p Fw(f)p Fe(f)410 684 y Fb(1)432 675 y Fe(;)10 b(:)g(:)g(:)h(;)f(f)
592 684 y Fa(n)619 675 y Fe(;)g(s)673 684 y Fb(1)696 675 y
Fe(;)g(:)g(:)g(:)h(;)f(s)855 684 y Fa(n)882 675 y Fw(g)335
866 y Fp(\(17\))42 b(\()p Fq(v)r(:)p Ft(map)607 848 y Fh(R)636
866 y Fo(f)p Fq(h)689 873 y Fn(1)708 866 y Fq(;)8 b(:)g(:)g(:)g(;)g(h)846
873 y Fh(n)869 866 y Fo(g)p Fq(;)g(d)941 873 y Fh(i)955 866
y Fq(:c;)g(d)p Fp(\))353 956 y Fo(!)60 b Fp(\()p Fq(v)r(;)8
b Ft(map)615 938 y Fh(E)641 943 y Fg(i)656 956 y Fo(f)p Fq(h)709
963 y Fn(1)729 956 y Fq(;)g(:)g(:)g(:)f(;)h(h)866 963 y Fh(m)900
956 y Fq(;)g Ft(map)1007 938 y Fh(R)1036 956 y Fo(f)p Fq(h)1089
963 y Fn(1)1109 956 y Fq(;)g(:)g(:)g(:)f(;)h(h)1246 963 y Fh(n)1270
956 y Fo(gg)p Fq(:d)1359 963 y Fh(i)1372 956 y Fq(;)g(c)p Fp(\()p
Fq(c)p Fp(\))p Fq(:d)p Fp(\))p 150 1064 1650 2 v 149 1987 2
924 v 664 1156 a Fc(;)25 b(destructor)f(passed)g(in)h(R)191
1231 y(alloc\(5,)f(R1\);)149 b(;)191 1306 y(R1)74 b(=)25 b(R0)g(+)g(2)149
b(;)25 b(destructor)f(name)191 1380 y(R1+1)g(=)h(R0)g(+)g(1)149
b(;)25 b(destructor)f(position)191 1455 y(R1+2)g(=)h(R0)g(+)g(2)149
b(;)25 b(destructor)f(tag)191 1530 y(push\(R1,)g(D\))199 b(;)25
b(push)f(the)h(destructor)f(on)h(dump)191 1604 y(push\(CONS,)f(D\);)191
1754 y(R1)74 b(=)25 b(PC)g(+)g(2)149 b(;)25 b(load)f(Map_Ei)h(table)191
1829 y(R0)74 b(=)25 b(R0)g(+)g(1)149 b(;)25 b(load)f(destructor)g(position)
191 1903 y(PC)74 b(=)25 b(R1)g(+)g(R0)124 b(;)25 b(calculate)f(address)g(of)h
(Map_Ei)p 1798 1987 V 150 1989 1650 2 v 150 2107 a Fm(MAP)p
290 2107 18 2 v 22 w(1)150 2231 y Ft(The)13 b(action)f(for)g(MAP)p
556 2231 15 2 v 18 w(1)g(is)h(the)f(same)h(as)g(P0)589 2403
y Fp(\(18\))42 b(\()p Fo(h)p Fq(v)779 2410 y Fn(1)799 2403
y Fq(;)8 b(v)845 2410 y Fn(0)864 2403 y Fo(i)p Fq(;)g(P)936
2410 y Fn(0)956 2403 y Fq(:c;)g(d)p Fp(\))42 b Fo(!)f Fp(\()p
Fq(v)1233 2410 y Fn(0)1252 2403 y Fq(;)8 b(c;)g(d)p Fp(\))950
2700 y Ft(44)p eop
%%Page: 45 52
51 bop 150 155 1650 2 v 149 404 2 249 v 191 249 a Fc(R0)24
b(=)h(V)g(+)g(2)224 b(;)25 b(Get)f(the)h(pointer)f(to)h(first)f(projection)
191 324 y(V)49 b(=)25 b(R0)299 b(;)25 b(Save)f(the)h(value)f(to)h(the)g(V)f
(register)p 1798 404 V 150 406 1650 2 v 150 527 a Fm(MAP)p
290 527 18 2 v 22 w(ID)p Fw(f)p Fe(f)6 b Fw(g)150 651 y Ft(MAP)p
261 651 15 2 v 18 w(ID)12 b(speci\256es)h(executes)g(the)f(function)g
Fq(f)5 b Ft(.)572 833 y Fp(\(19\))42 b(\()p Fq(v)r(;)8 b Ft(MAP)874
812 y Fh(id)906 833 y Fo(f)p Fq(f)d Fo(g)p Fq(:c;)j(d)p Fp(\))42
b Fo(!)f Fp(\()p Fq(v)r(;)8 b(f)s(;)g(d)p Fp(\))p 150 940 1650
2 v 149 1157 2 218 v 191 1077 a Fc(PC)24 b(=)h(\(PC\))g(+)g(1)149
b(;)25 b(Increment)f(the)g(program)h(counter)f(to)h(point)f(to)h(f)p
1798 1157 V 150 1159 1650 2 v 150 1280 a Fm(MAP)p 290 1280
18 2 v 22 w(PROD)p Fw(f)p Fe(f)s(;)10 b(g)r Fw(g)150 1404 y
Ft(Distribute)f(a)i(value)f(over)f(a)i(pair)e(by)h(creating)g(new)g(pair)g
(structures)f(for)h Fq(f)15 b Ft(and)10 b Fq(g)i Ft(and)f(loading)150
1494 y(the)h(address)h(of)f Fq(g)j Ft(into)d(the)g(program)f(counter)m(.)254
1676 y Fp(\(20\))43 b(\()p Fo(h)p Fq(v)445 1683 y Fn(1)464
1676 y Fq(;)8 b(v)510 1683 y Fn(0)529 1676 y Fo(i)p Fq(;)g
Ft(MAP)679 1655 y Ff(\002)708 1676 y Fo(f)p Fq(f)s(;)g(g)r
Fo(g)p Fq(:c;)g(d)p Fp(\))41 b Fo(!)g Fp(\()p Fo(h)p Fq(v)1127
1683 y Fn(2)1147 1676 y Fq(;)8 b(v)1193 1683 y Fn(1)1212 1676
y Fo(i)p Fq(;)g(g)r(;)g Ft(pr)1342 1688 y Fn(0)1361 1676 y
Fp(\()p Fo(h)p Fq(v)1423 1683 y Fn(2)1443 1676 y Fq(;)g(v)1489
1683 y Fn(0)1508 1676 y Fo(i)p Fq(;)g(f)s(;)g(c)p Fp(\))p Fq(:d)p
Fp(\))950 2700 y Ft(45)p eop
%%Page: 46 53
52 bop 150 155 1650 2 v 149 1972 2 1817 v 191 248 a Fc(R0)124
b(=)25 b(V)g(+)f(2)125 b(;)25 b(load)f(<v1,)h(v0>)191 322 y(R1)124
b(=)25 b(R0)g(+)f(2)100 b(;)25 b(load)f(v0)191 397 y(alloc\(3,)g(R0\))174
b(;)25 b(get)f(3)h(words)g(of)f(heap)h(to)g(store)f(pair)191
472 y(R0)124 b(=)25 b(PAIR)149 b(;)25 b(Store)f(a)h(pair)g(initially)f(<_,_>)
191 547 y(R0+1)74 b(=)25 b(v)g(+)f(1)125 b(;)25 b(<v2,)f(_>)191
621 y(R0+2)74 b(=)25 b(R1)199 b(;)25 b(<v2,)f(v0>)191 771 y(alloc\(3,)g(R1\))
174 b(;)25 b(get)f(3)h(words)g(to)f(store)h(a)g(continuation)191
846 y(R1)124 b(=)25 b(R0)199 b(;)25 b(push)f(<v2,)h(v1>)f(onto)h(heap)191
920 y(R1+1)74 b(=)25 b(PC)g(+)f(1)100 b(;)25 b(push)f(f)h(onto)g(heap)191
995 y(R1+2)74 b(=)25 b(PC)g(+)f(3)100 b(;)25 b(save)f(the)h(return)f(address)
191 1070 y(push\(R1,)g(D\))199 b(;)25 b(push)f(pr0\(<v2,)g(v1>,)h(f,)g(c\))f
(onto)h(dump)191 1144 y(push\(PR0,)f(D\))191 1294 y(R0)124
b(=)25 b(V)g(+)f(2)125 b(;)25 b(load)f(<v1,)h(v0>)191 1369
y(R1)124 b(=)25 b(R0)g(+)f(1)100 b(;)25 b(load)f(v1)191 1443
y(alloc\(3,)g(R0\))174 b(;)25 b(get)f(3)h(word)g(of)f(heap)h(to)g(store)f
(pair)191 1518 y(R0)124 b(=)25 b(PAIR)149 b(;)25 b(Store)f(a)h(pair)g
(initially)f(<_,_>)191 1593 y(R0+1)74 b(=)25 b(V)g(+)f(1)125
b(;)25 b(push)f(<v2,)h(_>)191 1667 y(R0+2)74 b(=)25 b(R1)199
b(;)25 b(<v2,)f(v1>)191 1817 y(V)149 b(=)25 b(R0)199 b(;)25
b(Set)f(V)h(to)g(point)f(to)h(<v2,)g(v1>)191 1892 y(PC)124
b(=)25 b(PC)g(+)f(2)100 b(;)25 b(Jump)f(to)h(g)p 1798 1972
V 150 1973 1650 2 v 150 2095 a Fm(DEST)p Fw(f)p Fe(d)p Fw(g)150
2219 y Ft(When)17 b(a)h(destructor)e(is)i(encountered)f(in)g(the)g(code)g
(stream,)i(the)e(positional)g(value)g(of)g(the)150 2309 y(destructor)12
b(is)g(passed)i(to)e(the)g(right)g(datatype)g(operator)f(in)i(the)f(register)
g Fq(R)p Fp(0)p Ft(.)950 2700 y(46)p eop
%%Page: 47 54
53 bop 150 155 1650 2 v 149 627 2 472 v 191 248 a Fc(R0)74
b(=)25 b(PC)g(+)g(1)149 b(;)25 b(Pass)f(the)h(positional)f(value)g(in)h(R0)
191 322 y(push\(PC+2,)f(D\))149 b(;)25 b(Save)f(return)h(address)191
397 y(push\(CONT,D\))191 472 y(PC)74 b(=)25 b(V)g(+)g(1)174
b(;)25 b(load)f(the)h(right)f(data)h(type)f(operator)191 547
y(V)99 b(=)25 b(V)g(+)g(2)174 b(;)25 b(strip)f(off)h(the)f(operator)h(from)f
(V)p 1798 627 V 150 628 1650 2 v 150 750 a Fm(JUMP)p Fw(f)p
Fe(c;)10 b(a)p Fw(g)150 874 y Ft(Functions)j(are)g(executed)g(by)g(JUMPing)g
(to)f(the)h(address)h(where)f(their)f(macro\261instructions)150
964 y(are)17 b(stored.)31 b(The)17 b(abstraction)f(table)h(must)f(be)h
(loaded)g(into)f(the)h(abstraction)f(stack)h(and)g(a)150 1054
y(marker)12 b(placed)g(on)g(the)h(dump)f(stack)g(to)h(\252pop\272)f(the)g
(values)h(of)o(f.)p 150 1125 V 149 1518 2 393 v 191 1217 a
Fc(loadA\(PC+2,)24 b(R0\))99 b(;)25 b(load)f(the)h(abstraction)f(table)g
(into)h(A)g(stack)191 1292 y(push\(R0,)f(D\))199 b(;)25 b(push)f(marker)h(to)
f(pop)h(abstractions.)191 1367 y(push\(POPA,)f(D\))191 1442
y(PC)124 b(=)25 b(PC)g(+)f(1)100 b(;)25 b(load)f(the)h(function)f(into)h(PC)p
1798 1518 V 150 1519 1650 2 v 150 1641 a Fm(P)l(ARM)p Fw(f)p
Fe(n)p Fw(g)150 1765 y Ft(Abstractions)14 b(in)h(functions)f(are)g
(referenced)g(by)h(a)f(P)-5 b(ARM)16 b(identi\256er)d(in)i(the)f(code)h
(stream.)150 1855 y(The)e(address)g(of)f(the)g(abstraction)g(is)h(calculated)
f(by)g(using)h(an)f(of)o(fset)g(on)h(the)f Fq(A)g Ft(register)m(.)p
150 1926 V 149 2393 2 468 v 191 2018 a Fc(push\(\(PC\)+2,)23
b(D\))100 b(;)25 b(push)f(return)h(address)191 2093 y(push\(CONT,)f(D\))191
2168 y(R0)74 b(=)25 b(A)274 b(;)25 b(load)f(address)h(of)f(abstraction)g
(stack)191 2242 y(R1)74 b(=)25 b(PC)g(+)g(1)149 b(;)25 b(load)f(offset)191
2317 y(PC)74 b(=)25 b(R0)g(+)g(R1)124 b(;)25 b(calculate)f(the)g(abstraction)
g(address)p 1798 2393 V 150 2395 1650 2 v 950 2700 a Ft(47)p
eop
%%Page: 48 55
54 bop 150 203 a Fm(POP)l(A)p Fw(f)p Fe(n)p Fw(g)150 327 y
Ft(Pop)12 b(n)g(items)h(of)o(f)e(the)i(abstraction)f(stack)p
150 398 1650 2 v 149 720 2 323 v 191 490 a Fc(R0)74 b(=)25
b(D)274 b(;)25 b(load)f(address)h(of)f(D)191 565 y(R1)74 b(=)25
b(PC)g(+)g(1)149 b(;)25 b(load)f(number)h(of)f(abstractions)191
640 y(D)99 b(=)25 b(R0)g(+)g(R1)124 b(;)25 b(pop)f(the)h(items)p
1798 720 V 150 721 1650 2 v 950 2700 a Ft(48)p eop
%%Page: 49 56
55 bop 150 203 a Fm(5.5)59 b(Abstractions)150 327 y Ft(Abstractions)12
b(to)g(functions)g(pose)g(an)h(interesting)e(problem)h(with)f(scoping)i(in)f
(the)g(machine.)150 417 y(That)17 b(is,)h(if)f(a)f(chain)h(of)f(functions)g
(exist)h(where)f(each)h(requires)g(an)f(abstraction)h(from)e(the)150
508 y(calling)c(function,)f(a)h(method)g(must)g(be)g(developed)g(for)f
(abstractions)h(that)f(pass)i(abstractions)150 598 y(as)18
b(parameters.)33 b(For)17 b(example,)i(consider)e(the)g(chain)h(of)f
(incomplete)g(Charity)g(functions)150 688 y(de\256ned)12 b(below:)p
150 749 1650 2 v 149 1442 2 694 v 191 841 a Fc(def)24 b(foo)h({h,)g(i})f
(\(...\))h(=)390 916 y(i\(...\).)191 1065 y(def)f(foo1)h({f,)f(g})h(\(...\))g
(=)390 1140 y(foo{a)f(=>)h(func3\(\),)f(b)h(=>)g(f\(...\)})f(\(...\).)191
1290 y(def)g(foo2)h(\(...\))f(=)390 1364 y(foo1{a)g(=>)h(func1\(a\),)f(b)h
(=>)g(func2\(b\)})f(\(...\).)p 1798 1442 V 150 1444 1650 2
v 223 1536 a Ft(The)d(machine)f(must)h(keep)f(track)g(of)g(all)h
(abstractions)f(and)h(the)f(functions)g(they)g(are)150 1626
y(associated)8 b(with.)17 b(For)8 b(example)g(function)g Fk(foo1)g
Ft(takes)g(two)g(abstractions)g(\()p Fq(f)k Ft(and)c Fq(g)r
Ft(\).)17 b(When)150 1716 y Fk(foo1)g Ft(is)g(called)g(from)g
Fk(foo2)f Ft(the)h(parameters)g(for)g Fq(f)22 b Ft(and)17 b
Fq(g)j Ft(are)d(the)g(functions)g Fk(func1)150 1807 y Ft(and)j
Fk(func2)p Ft(,)i(respectively)m(.)40 b(Both)20 b(functions)g
Fk(func1)f Ft(and)h Fk(func2)f Ft(are)h(pushed)g(onto)150 1897
y(the)c(abstraction)f(stack)h(for)f(access)h(in)g Fk(foo1)p
Ft(.)28 b(When)15 b Fk(foo1)g Ft(calls)h Fk(foo)p Ft(,)h(the)e(parameters)150
1987 y Fk(func3)i Ft(and)h(the)f(abstraction)g Fq(f)23 b Ft(are)18
b(pushed)g(onto)f(the)g(abstraction)h(stack.)34 b(Eventually)m(,)150
2077 y(function)18 b Fk(foo)h Ft(will)f(access)i(the)f(second)g(abstraction)g
Fq(i)f Ft(only)h(to)g(\256nd)f(that)h(it)f(is)i(another)150
2168 y(abstraction.)g(What)13 b(the)g(machine)g(needs)g(to)g(do)g(is)h(copy)e
(the)h(pointer)g(to)g(the)g(abstraction)f(in)150 2258 y(the)k(previous)h
(level.)30 b(For)16 b(the)h(above)f(case,)j(the)d(pointer)g(to)g(function)g
Fk(func3)g Ft(is)h(pushed)150 2348 y(onto)d(the)h(abstraction)f(stack)h(and)f
(not)h(the)f(abstraction)g Fq(f)5 b Ft(.)26 b(Figure)13 b(8)i(gives)f(an)h
(illustration)150 2439 y(of)c(how)g(the)h(abstraction)f(stack)h(looks)f(like)
h(after)f(the)g(abstractions)h(have)f(been)h(pushed)f(onto)150
2529 y(the)h(stack)h(and)g(a)f(call)g(has)h(been)g(issued)g(to)f
Fk(foo)p Ft(.)950 2700 y(49)p eop
%%Page: 50 57
56 bop 350 154 a
 19734528 19142492 9867264 18484674 29601792 37627166 startTexFig
 350 154 a
%%BeginDocument: fig_abstract.ps
%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica-Bold Times-Italic Times-Roman
%%Pages: 1
%%BoundingBox: 150 281 450 572
%%EndComments

/arrowHeight 10 def
/arrowWidth 5 def

/IdrawDict 53 dict def
IdrawDict begin

/reencodeISO {
dup dup findfont dup length dict begin
{ 1 index /FID ne { def }{ pop pop } ifelse } forall
/Encoding ISOLatin1Encoding def
currentdict end definefont
} def

/ISOLatin1Encoding [
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/space/exclam/quotedbl/numbersign/dollar/percent/ampersand/quoteright
/parenleft/parenright/asterisk/plus/comma/minus/period/slash
/zero/one/two/three/four/five/six/seven/eight/nine/colon/semicolon
/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N
/O/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright
/asciicircum/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m
/n/o/p/q/r/s/t/u/v/w/x/y/z/braceleft/bar/braceright/asciitilde
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/dotlessi/grave/acute/circumflex/tilde/macron/breve
/dotaccent/dieresis/.notdef/ring/cedilla/.notdef/hungarumlaut
/ogonek/caron/space/exclamdown/cent/sterling/currency/yen/brokenbar
/section/dieresis/copyright/ordfeminine/guillemotleft/logicalnot
/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior
/acute/mu/paragraph/periodcentered/cedilla/onesuperior/ordmasculine
/guillemotright/onequarter/onehalf/threequarters/questiondown
/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE/Ccedilla
/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute
/Thorn/germandbls/agrave/aacute/acircumflex/atilde/adieresis
/aring/ae/ccedilla/egrave/eacute/ecircumflex/edieresis/igrave
/iacute/icircumflex/idieresis/eth/ntilde/ograve/oacute/ocircumflex
/otilde/odieresis/divide/oslash/ugrave/uacute/ucircumflex/udieresis
/yacute/thorn/ydieresis
] def
/Helvetica-Bold reencodeISO def
/Times-Italic reencodeISO def
/Times-Roman reencodeISO def

/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
dup -1 eq {
/patternGrayLevel idef
/patternString idef
} {
/patternGrayLevel idef
} ifelse
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 1 printSize sub descender sub def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def
/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/SSten {
fgred fggreen fgblue setrgbcolor
dup true exch 1 0 0 -1 0 6 -1 roll matrix astore
} def

/FSten {
dup 3 -1 roll dup 4 1 roll exch
newpath
0 0 moveto
dup 0 exch lineto
exch dup 3 1 roll exch lineto
0 lineto
closepath
bgred bggreen bgblue setrgbcolor
eofill
SSten
} def

/Rast {
exch dup 3 1 roll 1 0 0 -1 0 6 -1 roll matrix astore
} def

%%EndProlog

%%BeginIdrawPrologue
/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
arrowHeight neg arrowWidth 2 div moveto
0 0 lineto
arrowHeight neg arrowWidth 2 div neg lineto
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

%%EndIdrawPrologue

%I Idraw 10 Grid 8 8 

%%Page: 1 1

Begin
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t
[ 0.799087 0 0 0.799087 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 210 188 ] concat
%I
71 367 142 388 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 210 124 ] concat
%I
71 367 142 388 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 210 145 ] concat
%I
71 367 142 388 Rect
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 210 167 ] concat
%I
71 367 142 388 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 316 490 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 318 628 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 3
46 279
68 292
99 295
3 BSpl
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-i-*-140-*
Times-Italic 14 SetF
%I t
[ 1 0 0 1 373 714 ] concat
%I
[
(A)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 276 425 ] concat
%I
[
(Abstraction Stack)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 523 593 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 421 147 ] concat
%I
71 367 142 388 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 524 674 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 528 431 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 3
41 327
64 336
95 337
3 BSpl
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 3
142 269
216 269
303 223
3 MLine
%I 1
End

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 421 233 ] concat
%I
71 367 142 388 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-helvetica-bold-r-*-140-*
Helvetica-Bold 14 SetF
%I t
[ 1 0 0 1 525 506 ] concat
%I
[
(\267)
(\267)
(\267)
] Text
End

Begin %I Pict
%I b u
%I cfg u
%I cbg u
%I f u
%I p u
%I t u

Begin %I Rect
%I b 65535
0 0 0 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 0 0 1 421 68 ] concat
%I
71 367 142 388 Rect
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 518 449 ] concat
%I
[
(func2)
] Text
End

End %I eop

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 189 562 ] concat
%I
[
(foo)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 194 514 ] concat
%I
[
(foo1)
] Text
End

Begin %I BSpl
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 4
202 465
207 422
204 364
185 351
4 BSpl
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 3
140 291
216 291
310 292
3 MLine
%I 1
End

Begin %I MLine
%I b 65520
0 0 1 [12 4] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 3
141 314
214 314
304 306
3 MLine
%I 1
End

Begin %I MLine
%I b 65535
0 0 1 [] 0 SetB
%I cfg Black
0 0 0 SetCFg
%I cbg White
1 1 1 SetCBg
none SetP %I p n
%I t
[ 1 -0 -0 1 174 230 ] concat
%I 3
138 333
230 334
309 376
3 MLine
%I 1
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 502 365 ] concat
%I
[
(Code store)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 289 506 ] concat
%I
[
(g)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 292 527 ] concat
%I
[
(f)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 514 614 ] concat
%I
[
(func3)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 512 529 ] concat
%I
[
(func1)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 289 568 ] concat
%I
[
(h)
] Text
End

Begin %I Text
%I cfg Black
0 0 0 SetCFg
%I f *-times-medium-r-*-120-*
Times-Roman 12 SetF
%I t
[ 1 0 0 1 292 550 ] concat
%I
[
(i)
] Text
End

End %I eop

showpage

%%Trailer

end
%%EndDocument

 endTexFig
 494 1468 a Ft(Figure)12 b(8:)17 b(Sample)12 b(representation)g(of)g
(Abstractions)223 1611 y(Note)18 b(that)f(the)h(dashed)g(line)g(from)f(\()p
Fq(i)p Ft(\))f(in)i(Figure)f(8)h(means)g(that)f(a)h(pointer)f(from)g(the)150
1702 y(previous)10 b(level)g(has)h(been)g(copied.)17 b(Entering)10
b(a)h(function)e(causes)j(abstractions)e(to)g(be)h(placed)150
1792 y(on)k(the)g(stack)g(with)f(abstractions)h(parameters)g(already)f
(resolved.)26 b(At)15 b(most,)g(the)g(machine)150 1882 y(need)h(only)g(look)f
(one)h(level)g(deep)g(to)g(resolve)g(an)g(abstraction,)h(thus)f(solving)g
(the)g(scoping)150 1973 y(problem)11 b(of)h(abstractions.)223
2063 y(On)f(exit)f(of)g(the)h(function,)f(the)h(items)f(on)h(the)f
(abstraction)g(stack)h(are)g(poped)f(of)o(f.)17 b(When)11 b(a)150
2153 y(function)h(calls)h(another)f(function,)h(a)f(marker)g(to)h(placed)g
(on)f(the)h(dump)f(stack)h(so)h(that)e(when)150 2243 y(the)g(called)h
(function)e(is)i(\256nishes)g(execution,)f(the)g(abstraction)h(stack)f(is)h
(cleaned)g(up.)950 2700 y(50)p eop
%%Page: 51 58
57 bop 150 203 a Fs(6)72 b(Futur)o(e)16 b(work)150 345 y Ft(Though)21
b(this)f(project)g(implements)h(a)f(reasonable)h(eager)g(machine)f(in)h(C,)g
(there)f(is)h(still)150 435 y(room)12 b(for)h(improvement.)20
b(Hermann')m(s)13 b(CHARM)h(machine)f(\(see)g(Appendix)g(A\))g(uses)h(lazy)
150 526 y(reduction)j(in)h(the)g(evaluation)f(of)h(programs.)34
b(In)18 b(a)g(full)f(blown)h(lazy)g(system,)i(updating,)150
616 y(sharing,)h(and)e(suspensions)i(all)e(contribute)f(to)i(making)e(the)i
(system)f(more)g(ef)o(\256cient.)39 b(It)150 706 y(appears)20
b(in)f(Hermann')m(s)g(implementation)f(of)h(a)h(lazy)f(machine)g(that)g
(\252laziness\272)i(is)e(only)150 796 y(useful)11 b(with)h(the)f(in\256nite)g
(datatypes.)19 b(W)n(ith)11 b(the)g(\256nite)h(datatypes,)g(the)g(machine)f
(spends)h(too)150 887 y(much)g(time)h(building)f(suspensions)h(only)g(to)f
(load)h(the)f(suspension)i(back)e(into)h(the)f(machine)150
977 y(for)g(immediate)f(evaluation.)223 1067 y(Perhaps)g(combining)g
(Hermann')m(s)g(CHARM)i(machine)e(with)g(some)h(sort)f(of)g(abstract)h(in-)
150 1158 y(terpretation)c(that)i(eliminates)f(the)g(building)g(of)g
(suspensions)i(at)f(compile)f(time)g(will)g(improve)150 1248
y(the)14 b(performance)e(of)i(the)f(system.)24 b(In)13 b(abstract)h
(interpretation,)f(the)h(compiler)f(attempts)g(to)150 1338
y(proved)20 b(that)g(ar)o(guments)h(are)f(are)h(needed)f(by)h(the)g(function)
e(and)i(should)f(be)h(evaluated)150 1428 y(immediately)m(.)223
1519 y(Other)12 b(areas)h(for)e(work)h(remaining)g(for)f(the)h(CHARM)i
(project)d(are:)208 1642 y Fo(\017)24 b Ft(Port)12 b(the)g(entire)g(system)h
(to)f(another)g(computer)f(platform)208 1753 y Fo(\017)24 b
Ft(Measure)c(performance)d(of)h(the)h(system)g(in)f(comparison)g(to)h(other)f
(functional)g(lan-)257 1844 y(guages)208 1955 y Fo(\017)24
b Ft(Implement)12 b(a)g(lazy)h(system)f(for)g(the)g(in\256nite)g(datatypes)
208 2066 y Fo(\017)24 b Ft(Implement)12 b(garbage)g(collection)g(on)g(the)g
(heap)223 2189 y(Finally)m(,)17 b(the)f(categorical)g(combinator)f(level)i
(should)f(be)g(eliminated)g(so)g(that)h(Charity)150 2279 y(programs)10
b(are)i(compiled)e(directly)h(to)g(\252machine)g(code\272.)18
b(This)12 b(will)f(reduce)g(the)g(ef)o(fort)f(need)150 2370
y(to)i(maintain)g(two)g(sets)h(of)f(symbol)g(tables)h(in)f(the)h(machine.)950
2700 y(51)p eop
%%Page: 52 59
58 bop 150 204 a Fs(A)72 b(Models)17 b(of)g(Abstract)g(Machines)150
368 y Fm(A.1)60 b(CHARM)15 b(abstract)f(machine)150 491 y Ft(The)k(original)f
(CHARM)i(machine)f(is)g(written)f(in)h(SML)g(by)g(M.)g(Hermann)g([Her92)o(])f
(uses)150 582 y(graph)12 b(reduction)f(to)h(reduce)f(unnecessary)i(work)e(by)
h(the)g(evaluator)m(.)18 b(A)12 b Fl(closur)n(e)h Ft(provides)f(a)150
672 y(method)c(of)g(representing)g(values)h(and)g(code)g(in)f(a)h(uniform)e
(manner)m(.)17 b(A)8 b(closure)h(is)g(a)g(structure)150 762
y(that)i(holds)g(a)g(pointer)f(to)h(the)g(code)g(and)g(its)g(ar)o(guments.)17
b(Self)11 b(updating)f(closures)h(contain)g(an)150 852 y(update)g(marker)f
(with)g(the)h(address)g(of)f(the)h(node)g(to)g(overwrite.)16
b(When)11 b(a)g(closure)g(is)g(entered,)150 943 y(the)e(update)g(information)
f(stored)h(in)g(the)g(closure)g(ensure)g(that)g(the)g(result)g(overwrite)f
(the)h(value)150 1033 y(node)j(and)f(subsequent)h(references)g(to)f(the)h
(closure)g(simply)f(returns)g(the)h(computed)f(answer)m(.)223
1123 y(In)j([Her92)o(])f(expressions)i(were)f(found)f(to)h(be)g(shared)g(in)f
(only)h(three)g(ways)g(that)g(can)g(be)150 1214 y(detected)e(at)h
(run\261time.)k(In)12 b(brief)g(they)g(are:)196 1325 y(1.)24
b(Multiple)12 b(references)g(to)h(a)f(term)g(on)g(the)h(right)e(hand)h(side)h
(of)f(a)h(rewrite)e(rule.)196 1436 y(2.)24 b(T)m(erms)12 b(shared)g(by)g
(repeated)g(iterations)f(of)g(the)h(FOLD)g(and)g(UNFOLD)g(combinators.)196
1547 y(3.)24 b(T)m(erms)13 b(inherit)e(sharing.)223 1658 y(Hermann')m(s)e
(abstract)f(machine)h(attempts)g(to)f(detect)h(sharing)f(and)h(updating)f
(are)h(required)150 1748 y(in)j(a)h(closure.)18 b(A)12 b(closure)h(in)f(this)
g(machine)h(is)f(represented)g(by)h(the)f(tuple)g Fp(\()p Fq(v)r(;)c(c;)g(u)p
Fp(\))p Ft(,)k(where)208 1859 y Fo(\017)24 b Fq(v)14 b Ft(is)f(a)f(pointer)g
(to)g(the)g(value)h(in)f(the)g(heap)208 1970 y Fo(\017)24 b
Fq(c)13 b Ft(is)f(a)h(pointer)f(to)g(the)g(code)208 2081 y
Fo(\017)24 b Fq(u)13 b Ft(is)f(the)h(update)f(marker)f(with)h(the)h(address)f
(to)h(update)223 2192 y(When)i(sharing)g(is)g(detected)g(and)g(an)g(update)g
(is)g(required,)g(the)g(update)g(information)e(in)150 2282
y(the)i(closure)g(is)g(annotated)g(the)g(marker)f(and)h(address)g(of)g(the)g
(value)f(to)h(update.)26 b(If)14 b(sharing)150 2373 y(is)j(inherited,)g(each)
g(child)f(closure)g(to)g(the)h(parent)f(closure)g(is)h(annotated)f(with)g
(the)g(update)150 2463 y(information.)g(Recall)9 b(that)g(in)g(the)h(eager)f
(machine)g(ar)o(guments)g(to)g(a)g(functions)g(are)g(evaluated)150
2553 y(to)k(normal)f(form.)20 b(In)12 b(the)h(CHARM)h(machine,)g(lazy)f
(evaluation)g(means)g(that)g(a)g(term)g(is)g(not)950 2700 y(52)p
eop
%%Page: 53 60
59 bop 150 203 a Ft(alway)11 b(in)g(term)f(normal)g(form.)17
b(T)m(erms)11 b(are)g(just)g(as)g(likely)g(to)f(be)h(in)g Fl(weak)h(term)f
(normal)g(form)150 294 y Ft(where)h(more)h(processing)f(is)h(required)f(to)h
(generate)f(a)h(term)f(in)h Fl(term)g(normal)f(form)p Ft(.)20
b(A)13 b(term)150 384 y(is)g(in)f(term)g(normal)f(for)h(if)g(its)g(head)h
(has)g(been)f(reduced)g(to)g(a)h(primitive.)150 569 y Fm(A.2)60
b(G\261Machine)150 692 y Ft(The)16 b(main)f(idea)g(behind)g(the)h
(G\261machine)f(is)g(to)g(compile)g(the)g(source)h(code)f(into)g(machine)150
783 y(code.)38 b(The)19 b(goal)g(is)g(to)f(do)h(as)g(much)g(work)f(as)h
(possible)h(before)e(the)g(evaluation)h(of)f(the)150 873 y(combinators)8
b(by)g(the)g(abstract)g(machine.)17 b(In)8 b(the)g(G\261machine,)h(the)f
(source)h(code)f(is)h(compiled)150 963 y(into)21 b(\252G\261code\272.)45
b(Expressions)22 b(in)f(the)g(source)g(program)f(are)h(compiled)g(into)g(a)g
Fl(linear)150 1053 y Ft(sequence)15 b(of)f(G\261code.)24 b(Naive)14
b(implementations)f(of)h(functional)f(languages)i(required)e(the)150
1144 y(graph)18 b(of)g(the)h(expression)g(to)g(be)f(laboriously)g(build)g
(and)h(traversed)g(at)f(run)g(time.)37 b(This)150 1234 y(operation)19
b(places)h(considerable)f(stress)h(on)f(the)g(machine)h(since)g(vast)f
(amounts)g(of)g(time)150 1324 y(must)12 b(be)h(devoted)f(to)g(repeated)g
(instantiation)g(of)g(the)g(body)g(of)g(the)h(combinator)m(.)223
1415 y(The)g(state)g(of)f(a)g(G\261machine)g(is)h(de\256ned)f(by)g(the)h
(tuple)f Fo(h)p Fq(C)q(;)c(S;)g(H)q(;)g(G)p Fo(i)14 b Ft(where)482
1548 y Fq(C)60 b Ft(is)12 b(the)h(code)f(sequence)482 1639
y Fq(S)65 b Ft(is)12 b(the)h(stack)f(of)g(values)h(\(pointers)f(into)g(the)g
(heap\))482 1729 y Fq(H)55 b Ft(is)12 b(the)h(heap)482 1819
y Fq(G)57 b Ft(holds)12 b(the)g(global)g(addresses)223 1938
y(Lazy)f(evaluation)f(is)g(achieved)h(by)f(overwriting)e(the)j(original)e
(node)h(with)g(an)g(indirection)150 2028 y(to)i(the)h(compiled)e(combinator)h
(body)m(.)223 2119 y(Updates)17 b(are)f(performed)f(by)h(placing)g(an)g
(\252update)h(marker)r(\272)e(on)h(the)g(S)h(stack.)30 b(Every)150
2209 y(time)17 b(a)h(function)f(is)h(evaluated,)i(the)e(node)f(is)h
(overwritten)f(with)g(the)h(result)g(of)f(the)h(com-)150 2299
y(putation.)33 b(Thus)18 b(redundant)e(computations)h(are)g(eliminated)g(and)
g(future)f(re\261evaluations)150 2390 y(of)h(this)g(node)g(simply)g(return)f
(the)i(computed)e(value.)33 b(Further)n(,)18 b(updates)g(are)f(the)g(essence)
150 2480 y(for)f(lazy)g(evaluation)g(in)h(the)f(G-machine.)30
b(Closures)17 b(are)f(built)g(to)h(suspend)g(evaluating)f(a)150
2570 y(code)f(sequence.)27 b(The)15 b(G\261machine)g(views)g(a)g(closure)g
(as)h(a)f(piece)g(of)g(code)g(along)f(with)h(its)950 2700 y(53)p
eop
%%Page: 54 61
60 bop 150 203 a Ft(context.)21 b(Evaluation)13 b(of)g(a)g(suspension)h
(\(ie:)19 b(closure\))13 b(is)h(done)f(by)g(\252entering)g(the)g(closure\272)
150 294 y(where)d(the)g(state)h(of)f(the)g(machine)h(is)f(saved)h(while)f
(the)h(context)f(and)g(code)h(of)f(the)g(closure)g(are)150
384 y(loaded)j(into)g(the)h(machine.)22 b(T)m(o)13 b(achieve)h(lazy)f
(evaluation,)h(the)g(\252update)f(marker)r(\272)g(holding)150
474 y(the)h(address)h(to)e(update)h(is)h(added)f(to)g(the)g(closure.)23
b(After)13 b(the)h(code)g(in)g(a)g(closure)g(has)h(been)150
565 y(evaluated,)e(the)f(abstract)g(machine)h(performs)e(an)h(update)h(to)f
(overwrite)f(the)i(root)e(node.)150 745 y Fm(A.3)60 b(TIM)15
b(machine)150 869 y Ft(The)f(TIM)f(machine)g(is)h(so)f(called)h(because)g(it)
f(contains)g(variations)g(of)f(three)h(basic)h(instruc-)150
959 y(tions.)208 1073 y Fo(\017)24 b Ft(T)l(AKE)14 b Fq(n)208
1176 y Fo(\017)24 b Ft(PUSH)12 b Fq(f)208 1279 y Fo(\017)24
b Ft(ENTER)14 b Fq(n)223 1393 y Ft(The)f(instruction)e(T)l(AKE)i(removes)g
Fq(n)f Ft(elements)g(from)g(a)g(stack)h(and)f(makes)g(a)h(frame)e(out)150
1483 y(of)i(it.)21 b(The)14 b(PUSH)f(instruction)g(pushes)h(a)f(closure)h
(onto)f(the)g(stack)h(and)g(ENTER)h(loads)e(ar)o(g)150 1573
y Fq(n)h Ft(into)g(the)g(machine.)24 b(A)14 b(closure)g(in)g(the)g(TIM)h
(machine)f(is)h(de\256ned)e(by)i(the)f(code/ar)o(g)g(pair)150
1664 y(where)e(ar)o(g)g(is)h(a)g(pointer)e(to)h(a)h(list)f(\()p
Fq(n)i Fo(\025)f Fp(0)p Ft(\))g(of)f(ar)o(guments.)223 1754
y(The)k(advantages)f(of)f(TIM)h(are)g(its)g(simplicity)f(and)h(ease)h(of)e
(implementation.)25 b(TIM)15 b(is)150 1844 y(a)e(spineless)h(machine,)f(that)
f(is,)i(TIM)f(does)g(not)g(contain)f(a)h(spine)g(to)g(unwind)f(instead,)i(ar)
o(gu-)150 1935 y(ments)i(are)f(simply)g(stacked)h(until)f(needed.)28
b(However)n(,)17 b(this)e(model)h(encounter)f(problems)150
2025 y(with)c(lazy)h(evaluation.)18 b(Updating)11 b(becomes)i(considerable)e
(more)h(tricky)f(and)h(complicated)150 2115 y(and)d(are)g(handled)g(by)g
(making)f(each)i(closure)f(self)g(updating.)16 b(The)10 b(state)f(of)g(the)g
(TIM)g(machine)150 2206 y(is)k(de\256ned)f(by)223 2296 y(\(instruction)f
(sequence,)j(frame)d(pointer)n(,)h(stack,)i(heap,)f(code)f(store\).)223
2386 y(The)17 b(instruction)e(sequence)i(contains)g(the)f(code)g(acting)g(on)
h(the)f(frame)f(pointed)h(to)g(by)150 2476 y(the)11 b Fl(frame)g(pointer)p
Ft(.)18 b(The)11 b(stack)h(and)e(heap)h(maintain)g(computed)f(values)h(and)g
(the)g(code)g(store)150 2567 y(associates)j(a)e(label)h(\(code)f(name\))g
(with)g(the)g(stored)g(address.)950 2700 y(54)p eop
%%Page: 55 62
61 bop 150 204 a Fs(Refer)o(ences)150 346 y Ft([CCM85])24 b(G.)15
b(Cousineau,)h(P)-6 b(.)16 b(L.)f(Curien,)h(and)f(M.)g(Mauny)m(.)24
b(\252The)16 b(Categorical)e(Abstract)368 436 y(Machine\272.)28
b(In)15 b(G.)h(goos)g(and)f(J.)i(Hartmanis,)f(editors,)h Fl(Functional)e(Pr)n
(ogram-)368 526 y(ming)20 b(Languages)g(and)h(Computer)f(Ar)n(chitectur)n(e)p
Ft(,)25 b(volume)19 b(201)i(of)f Fl(Lectur)n(e)368 617 y(Notes)d(in)f
(Computer)g(Science)p Ft(,)h(pages)g(50\26164.)f(Springer)o(\261V)-6
b(erlag,)16 b(September)368 707 y(1985.)150 818 y([CF92])73
b(R.)29 b(Cockett)f(and)f(T)l(.)i(Fukushima.)59 b(About)27
b(Charity)m(.)59 b(Research)28 b(Report)368 908 y(92/480/18,)23
b(Department)e(of)g(Computer)g(Science,)j(University)d(of)g(Calgary)m(,)368
998 y(Calgary)m(,)12 b(Alberta,)h(CANADA)f(T2N-1N4,)h(June)g(1992.)150
1110 y([Dil88])70 b(A.)15 b(Diller)m(.)22 b Fl(Compiling)13
b(Functional)h(Languages)p Ft(.)22 b(John)15 b(W)n(iley)e(&)h(Sons)g(L)-5
b(TD,)368 1200 y(1988.)150 1311 y([Fai86])70 b(J.)21 b(Fairbairn.)38
b(A)20 b(Simple)g(Abstract)g(Machine)h(to)f(Execute)h(Supercombina-)368
1401 y(tors.)29 b(In)16 b(J.)h(Fasel)g(and)f(R.)i(Keller)n(,)f(editors,)h
Fl(Graph)e(Reduction)p Ft(,)i(volume)e(279)368 1491 y(of)g
Fl(Lectur)n(e)i(Notes)f(in)f(Computer)i(Science)p Ft(,)g(pages)f(49\26152.)g
(Springer)o(\261V)-6 b(erlag,)368 1582 y(September)o(\261October)11
b(1986.)150 1693 y([Fuk91])56 b(T)l(.)18 b(Fukushima.)28 b(Charity)16
b(User)h(Manual.)29 b(Draft,)17 b(Department)f(of)g(Computer)368
1783 y(Science,)f(University)e(of)g(Calgary)m(,)h(Calgary)m(,)g(Alberta,)g
(CANADA)g(T2N-1N4,)368 1873 y(November)e(24)g(1991.)150 1984
y([FW87])59 b(J.)20 b(Fairbairn)f(and)g(S.)h(W)n(ray)m(.)36
b(\252TIM:)20 b(A)f(simple,)j(lazy)e(abstract)f(machine)g(to)368
2075 y(execute)8 b(supercombinators\272.)h(In)f(G.)g(Kahn,)h(editor)n(,)f
Fl(Functional)g(Pr)n(ogramming)368 2165 y(Languages)k(and)h(Computer)f(Ar)n
(chitectur)n(e)p Ft(,)j(volume)d(274)g(of)g Fl(Lectur)n(e)h(Notes)g(in)368
2255 y(Computer)g(Science)p Ft(,)g(pages)g(34\26145.)f(Springer)o(\261V)-6
b(erlag,)12 b(September)f(1987.)150 2366 y([Gor88])56 b(M.)16
b(J.)f(C.)g(Gordon.)24 b Fl(Pr)n(ogramming)15 b(Language)f(Theory)h(and)f
(its)h(Implementa-)368 2457 y(tion)p Ft(.)j(Prentice)12 b(Hall,)g(1988.)950
2700 y(55)p eop
%%Page: 56 63
62 bop 150 203 a Ft([Han91])51 b(J.)18 b(Hannan.)31 b(\252Making)17
b(Abstract)g(Machine)g(Less)h(Abstract\272.)31 b(In)16 b(J.)i(Hughes,)368
294 y(editor)n(,)10 b Fl(Functional)f(Pr)n(ogramming)i(Languages)e(and)g
(Computer)h(Ar)n(chitectur)n(e)p Ft(,)368 384 y(volume)21 b(523)h(of)g
Fl(Lectur)n(e)g(Notes)g(in)g(Computer)g(Science)p Ft(,)j(pages)d(618\261635.)
368 474 y(Springer)o(\261V)-6 b(erlag,)11 b(August)i(1991.)150
585 y([Her92])59 b(Mike)18 b(Hermann.)30 b(A)18 b(lazy)f(graph)g(reduction)f
(machine)h(for)g(charity:)27 b(Charity)368 676 y(abstract)13
b(reduction)g(machine)g(\(CHARM\).)21 b(Research)14 b(report,)f(Department)g
(of)368 766 y(Computer)h(Science,)i(University)e(of)g(Calgary)m(,)h(Calgary)m
(,)g(Alberta,)g(CANADA)368 856 y(T2N-1N4,)e(July)f(4)h(1992.)150
967 y([Joh86])65 b(T)l(.)13 b(Johnsson.)k(\252tar)o(get)12
b(code)f(generation)g(from)f(G\261machine)h(code\272.)17 b(In)11
b(J.)i(Fasel)368 1057 y(and)e(R.)g(Keller)n(,)g(editors,)g
Fl(Graph)g(Reduction)p Ft(,)g(volume)f(279)h(of)f Fl(Lectur)n(e)h(Notes)g(in)
368 1148 y(Computer)f(Science)p Ft(,)h(pages)g(1)n(19\261159.)f(Springer)o
(\261V)-6 b(erlag,)9 b(September)o(\261August)368 1238 y(1986.)150
1349 y([Jon92])65 b(S.)15 b(L.)i(Peyton)d(Jones.)26 b(\252Implementing)14
b(lazy)h(functional)f(languages)i(on)f(stock)368 1439 y(hardware:)i(the)c
(Spineless)f(T)m(agless)i(G\261machine\272.)k(In)12 b(et)g(al)h(J.)g(Hughes,)
g(P)-6 b(.)14 b(Hu-)368 1530 y(dak,)g(editor)n(,)f Fl(Journal)g(of)g
(Functional)f(Pr)n(ogramming)p Ft(,)j(volume)d(2,)i(pages)f(127\261)368
1620 y(202.)g(Cambridge)f(University)f(Press,)i(April)f(1992.)150
1731 y([Pey])109 b(PeytonJones.)19 b(Implementation)10 b(tutorial.)150
1842 y([W)l(al91])55 b(R.)11 b(F)l(.)f(C.)g(W)l(alters.)15
b Fl(Categories)10 b(and)g(Computer)g(Science)p Ft(.)k(Number)9
b(2)h(in)g(Under)o(-)368 1932 y(graduate)k(Lecture)h(Notes)g(in)f
(Mathematics.)i(Carslaw)e(Publications,)h(Sydney)m(,)368 2023
y(Australia,)e(1991.)950 2700 y(56)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
